{"version":3,"file":"static/js/333.d58aa4c0.chunk.js","mappings":"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","sources":["api/Courses.js","context/AdminProvider.js","components/Admin/Courses/CreateButton.js","components/Admin/Courses/DeleteButton.js","components/Admin/Courses/CreateForm.js","components/Admin/Courses/SubjectList.js","components/Admin/Courses/CourseList.js","components/Admin/Courses/Courses.js","components/Admin/Courses/TopicList.js","components/Admin/Courses/ChapterList.js","components/Admin/Courses/Chapters.js","components/Admin/Editor/appSettings.ts","components/Admin/Editor/context/SettingsContext.tsx","components/Admin/Editor/context/SharedHistoryContext.tsx","components/Admin/Editor/ui/Modal.tsx","components/Admin/Editor/hooks/useModal.tsx","components/Admin/Editor/utils/join-classes.ts","components/Admin/Editor/ui/Button.tsx","components/Admin/Editor/ui/EquationEditor.tsx","components/Admin/Editor/ui/KatexRenderer.tsx","components/Admin/Editor/nodes/EquationNode.tsx","components/Admin/Editor/nodes/shared/getDOMSelection.ts","components/Admin/Editor/plugins/ImagesPlugin/index.ts","components/Admin/Editor/plugins/TableActionMenuPlugin/index.tsx","components/Admin/Editor/plugins/TreeViewPlugin/index.tsx","components/Admin/Editor/ui/ContentEditable.tsx","components/Admin/Editor/ui/ImageResizer.tsx","components/Admin/Editor/ui/Placeholder.tsx","components/Admin/Editor/nodes/ImageNode.tsx","components/Admin/Editor/plugins/MarkdownTransformers/index.ts","components/Admin/Editor/plugins/ActionsPlugin/index.tsx","components/Admin/Editor/plugins/AutoLinkPlugin/index.tsx","components/Admin/Editor/plugins/ClickableLinkPlugin/index.ts","components/Admin/Editor/plugins/CodeActionMenuPlugin/utils.ts","components/Admin/Editor/plugins/CodeActionMenuPlugin/components/CopyButton/index.tsx","components/Admin/Editor/plugins/CodeActionMenuPlugin/index.tsx","components/Admin/Editor/plugins/CodeHighlightPlugin/index.ts","components/Admin/Editor/nodes/shared/environment.ts","components/Admin/Editor/nodes/YouTubeNode.tsx","components/Admin/Editor/ui/DropDown.tsx","components/Admin/Editor/ui/TextInput.tsx","components/Admin/Editor/ui/ColorPicker.tsx","components/Admin/Editor/ui/FileInput.tsx","components/Admin/Editor/ui/KatexEquationAlterer.tsx","components/Admin/Editor/ui/LinkPreview.tsx","components/Admin/Editor/plugins/EquationsPlugin/index.ts","components/Admin/Editor/plugins/YouTubePlugin/index.ts","components/Admin/Editor/plugins/ToolbarPlugin/index.tsx","components/Admin/Editor/plugins/ComponentPickerPlugin/index.tsx","components/Admin/Editor/plugins/HorizontalRulePlugin/index.ts","components/Admin/Editor/plugins/ListMaxIndentLevelPlugin/index.ts","components/Admin/Editor/plugins/MarkdownShortcutPlugin/index.tsx","components/Admin/Editor/plugins/TabFocusPlugin/index.tsx","components/Admin/Editor/plugins/TableCellResizer/index.tsx","components/Admin/Editor/nodes/shared/canUseDOM.ts","components/Admin/Editor/nodes/shared/useLayoutEffect.ts","components/Admin/Editor/themes/PlaygroundEditorTheme.ts","components/Admin/Editor/plugins/CommentPlugin/index.tsx","components/Admin/Editor/themes/CommentEditorTheme.ts","components/Admin/Editor/plugins/TextFormatFloatingToolbarPlugin/index.tsx","components/Admin/Editor/plugins/LoadContentPlugin/index.js","components/Admin/Editor/EditorToHtml.js","components/Admin/Editor/Editor.tsx","components/Admin/Editor/nodes/TypeaheadNode.ts","components/Admin/Editor/nodes/PlaygroundNodes.ts","components/Admin/Editor/TextEditor.tsx","components/Admin/Courses/Topic.js","components/Admin/Index.js","api/Media.js","components/Admin/Media.js","components/Admin/Payment.js","pages/Admin.js","pages/InvalidPage.js"],"sourcesContent":["import axios from 'axios'\n\nexport const getCourses = (url) => axios.get(url, { withCredentials: true }).then(res => res.data)\nexport const getSubjects = (url) => axios.get(url, { withCredentials: true }).then(res => res.data)\nexport const getChapters = (url) => axios.get(url, { withCredentials: true }).then(res => res.data)\nexport const getTopics = (url) => axios.get(url, { withCredentials: true }).then(res => res.data)\nexport const getTopic = (url) => axios.get(url, { withCredentials: true }).then(res => res.data)\n\n\nexport const editCourse = (url, {\n    courseId, courseTitle, published, thumbnail\n}) => axios.post(url, {\n    courseId, courseTitle, published, thumbnail\n}, { withCredentials: true }).then(res => res.data)\n\nexport const editSubject = (url, {\n    courseId,\n    subjectId,\n    subjectTitle,\n    published,\n    thumbnail\n}) =>\n    axios.post(url, {\n        courseId,\n        subjectId,\n        subjectTitle,\n        published,\n        thumbnail\n    }, { withCredentials: true }).then(res => res.data)\n\nexport const editChapter = (url, {\n    chapterId,\n    chapterTitle,\n    published,\n    order\n}) => axios.post(url, {\n    chapterId,\n    chapterTitle,\n    published,\n    sn: order\n}, { withCredentials: true }).then(res => res.data)\n\nexport const editTopic = (url, {\n    courseId,\n    subjectId,\n    chapterId,\n    topicId,\n    topicTitle,\n    topicContent,\n    topicEditor,\n    published\n}) => axios.post(url, {\n    courseId,\n    subjectId,\n    chapterId,\n    topicId,\n    topicTitle,\n    topicContent,\n    topicEditor,\n    published\n}, { withCredentials: true }).then(res => res.data)\n\nexport const deleteSomething = (url, data) => axios.post(url, { ...data }, { withCredentials: true }).then(res => res.data)\n","import React, { useState, useContext } from \"react\";\n\nconst AdminContext = React.createContext();\n\nexport const useAdminData = () => {\n  return useContext(AdminContext);\n};\n\nexport const AdminProvider = ({ children }) => {\n  const [createForm, setCreateForm] = useState({\n    course: false,\n    subject: { status: false, courseId: \"\" },\n    chapter: false,\n    topic: { status: false, chapterId: \"\" },\n  });\n  const [editForm, setEditForm] = useState({\n    course: { status: false, courseId: \"\" },\n    subject: { status: false, subjectId: \"\" },\n    chapter: { status: false, chapterId: \"\" },\n    topic: { status: false, topicId: \"\" },\n  });\n  const [errorMessage, setErrorMessage] = useState(\"\")\n  const [isShowing, setIsShowing] = useState(false)\n\n  return (\n    <AdminContext.Provider\n      value={{\n        createForm,\n        setCreateForm,\n        editForm,\n        setEditForm,\n        errorMessage,\n        setErrorMessage,\n        isShowing,\n        setIsShowing\n      }}>\n      {children}\n    </AdminContext.Provider>\n  );\n};\n","import React from \"react\";\nimport { useAdminData } from \"../../../context/AdminProvider\";\n\nfunction CreateButton({ text, element, data, setExpanded = null, expanded = null, expandIndex = null }) {\n  const { createForm, setCreateForm } = useAdminData();\n  const onClickHandler = (e) => {\n    e.preventDefault();\n\n    setCreateForm((prev) => {\n      return element === \"course\" ? { ...prev, course: !prev.course }\n        :\n        element === \"subject\" ? {\n          ...prev,\n          subject: {\n            status: !prev.subject.status,\n            courseId: data.courseId,\n          },\n        }\n          :\n          element === \"chapter\" ? { ...prev, chapter: !prev.chapter }\n            :\n            element === \"topic\"\n              ? {\n                ...prev,\n                topic: { status: !prev.topic.status, chapterId: data.chapterId },\n              }\n              : null;\n    });\n    if (expanded !== null) {\n      let temp = expanded\n      if (temp[expandIndex]) {\n        temp[expandIndex] = false;\n        setExpanded([...temp])\n      }\n    }\n  };\n  return (\n    <>\n      <div className=\"flex justify-end\">\n        <button\n          onClick={onClickHandler}\n          className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\"\n          type=\"submit\">\n          {text}\n        </button>\n      </div>\n    </>\n  );\n}\n\nexport default CreateButton;\n","import axios from \"axios\";\nimport React from \"react\";\nimport { mutate } from \"swr\";\nimport { deleteSomething } from '../../../api/Courses'\n\nfunction DeleteButton({ text, element, data, setErrorMessage, setIsShowing }) {\n  const apiUrl = process.env.REACT_APP_BACKEND + `/${element}/delete`;\n  const onClickHandler = (e) => {\n    e.preventDefault();\n\n    const deleteCourse = async () => {\n      let promptOutput = prompt(`Are you sure to delete the ${element}? Please type Confirm to delete.`, \"\")\n      if (promptOutput === \"Confirm\") {\n        const deleteData = await deleteSomething(apiUrl, data)\n        if (element === \"course\") mutate(process.env.REACT_APP_BACKEND + `/courses/list`)\n        else if (element === \"subject\") mutate(process.env.REACT_APP_BACKEND + `/subjects/${data.courseId}/list`)\n        else if (element === \"chapter\") mutate(process.env.REACT_APP_BACKEND + `/chapters/${data.courseId}/${data.subjectId}/list`)\n        else if (element === \"topic\") mutate(process.env.REACT_APP_BACKEND + `/topics/${data.chapterId}/list`)\n        setErrorMessage(deleteData?.data?.message)\n        setIsShowing(true)\n        setTimeout(() => {\n          setIsShowing(false)\n          setErrorMessage(\"\")\n        }, 4000);\n      } else {\n        setErrorMessage(\"You weren't sure of deleting.\")\n        setIsShowing(true)\n        setTimeout(() => {\n          setIsShowing(false)\n          setErrorMessage(\"\")\n        }, 4000);\n      }\n    };\n\n    deleteCourse().catch((err) => console.log(err));\n  };\n  return (\n    <>\n      <div className=\"flex justify-end\">\n        <button\n          onClick={onClickHandler}\n          className=\"font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\"\n          type=\"submit\">\n          {text}\n        </button>\n      </div>\n    </>\n  );\n}\n\nexport default DeleteButton;\n","import axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { mutate } from \"swr\";\nimport { useAdminData } from \"../../../context/AdminProvider\";\n\nexport const CreateCourse = ({ setIsShowing, setErrorMessage }) => {\n  const [course, setCourse] = useState({ title: \"\", tag: [], thumbnail: \"\" });\n  const { createForm, setCreateForm } =\n    useAdminData();\n\n  const createCourse = (e) => {\n    e.preventDefault();\n    const postCourse = async () => {\n      const posted = await axios.post(\n        process.env.REACT_APP_BACKEND + \"/course/create\",\n        course,\n        { withCredentials: true }\n      );\n      setErrorMessage(posted?.data?.message)\n      setIsShowing(true)\n      setTimeout(() => {\n        setIsShowing(false)\n        setErrorMessage(\"\")\n      }, 4000);\n      mutate(process.env.REACT_APP_BACKEND + \"/courses/list\")\n    };\n\n    postCourse().catch((err) => console.log(err));\n\n    setCreateForm((prev) => {\n      return { ...prev, course: !prev.course };\n    });\n  };\n  return (\n    <div className={`${!createForm.course ? \"hidden\" : \"flex\"} w-full`}>\n      <form\n        className=\"rounded-md w-full transition-all mt-10 flex flex-col border-2 shadow-md p-5 mb-10 z-20\"\n        onSubmit={createCourse}>\n        <div className=\"mb-2\">\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-gray-200 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Course\"\n            onChange={(e) => setCourse({ ...course, title: e.target.value })}\n            required\n          />\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-gray-200 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Thumbnail\"\n            onChange={(e) => setCourse({ ...course, thumbnail: e.target.value })}\n            required\n          />\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              setCreateForm((prev) => {\n                return { ...prev, course: false };\n              });\n            }}\n            className=\"float-left flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\">\n            Close\n          </button>\n          <button\n            className=\"float-right flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\"\n            type=\"submit\">\n            Submit\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport const CreateSubject = ({ courseId, setIsShowing, setErrorMessage }) => {\n  const [subject, setSubject] = useState({ title: \"\", tag: [], thumbnail: \"\" });\n  const { createForm, setCreateForm } = useAdminData();\n\n  const createSubject = (e) => {\n    e.preventDefault();\n\n    if (subject.title === \"\") return;\n\n    const postSubject = async () => {\n      const posted = await axios.post(\n        process.env.REACT_APP_BACKEND + \"/subject/create\",\n        { ...subject, courseId },\n        { withCredentials: true }\n      );\n      setErrorMessage(posted?.data?.message)\n      setIsShowing(true)\n      setTimeout(() => {\n        setIsShowing(false)\n        setErrorMessage(\"\")\n      }, 4000);\n      mutate(process.env.REACT_APP_BACKEND + `/subjects/${courseId}/list`)\n    };\n\n    postSubject().catch((err) => console.log(err));\n    setCreateForm((prev) => {\n      return { ...prev, subject: !prev.subject };\n    });\n  };\n  return (\n    <div\n      className={`${!createForm.subject ? \"hidden\" : \"flex\"\n        } w-full h-full absolute top-0 right-0 bg-blue-50 rounded-[1em] z-20`}>\n      <form\n        className=\"w-full transition-all mt-10 flex flex-col p-5 mb-10\"\n        onSubmit={createSubject}>\n        <div className=\"mb-6\">\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-red-500 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Subject\"\n            onChange={(e) => setSubject({ ...subject, title: e.target.value })}\n            required\n          />\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-gray-200 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Thumbnail\"\n            onChange={(e) => setSubject({ ...subject, thumbnail: e.target.value })}\n            required\n          />\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              setCreateForm((prev) => {\n                return { ...prev, subject: false };\n              });\n            }}\n            className=\"float-left flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\">\n            Close\n          </button>\n          <button\n            className=\"float-right flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\"\n            type=\"submit\">\n            Submit\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport const CreateChapter = ({ courseId, subjectId, setIsShowing, setErrorMessage }) => {\n  const [chapter, setChapter] = useState({ title: \"\", tag: [], order: 0 });\n  const { createForm, setCreateForm } = useAdminData();\n\n  const createChapter = (e) => {\n    e.preventDefault();\n\n    const postChapter = async () => {\n      const posted = await axios.post(\n        process.env.REACT_APP_BACKEND + \"/chapter/create\",\n        { ...chapter, courseId, subjectId },\n        { withCredentials: true }\n      );\n      setErrorMessage(posted?.data?.message)\n      setIsShowing(true)\n      setTimeout(() => {\n        setIsShowing(false)\n        setErrorMessage(\"\")\n      }, 4000);\n      mutate(process.env.REACT_APP_BACKEND + `/chapters/${courseId}/${subjectId}/list`)\n    };\n\n    postChapter().catch((err) => console.log(err));\n\n    setCreateForm((prev) => {\n      return { ...prev, chapter: !prev.chapter };\n    });\n  };\n  return (\n    <div\n      className={`${!createForm.chapter ? \"hidden\" : \"flex\"\n        } w-full absolute top-4 left-0 z-20`}>\n      <form\n        className=\"w-full transition-all mt-10 flex flex-col border-2 shadow-md bg-pink-50 p-5 mb-10\"\n        onSubmit={createChapter}>\n        <div className=\"mb-6\">\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-red-500 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Chapter Name\"\n            onChange={(e) => setChapter({ ...chapter, title: e.target.value })}\n            required\n          />\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-red-500 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Chapter Order\"\n            onChange={(e) => setChapter({ ...chapter, sn: e.target.value })}\n            required\n          />\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              setCreateForm((prev) => {\n                return { ...prev, chapter: false };\n              });\n            }}\n            className=\"float-left flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\">\n            Close\n          </button>\n          <button\n            className=\"float-right flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\"\n            type=\"submit\">\n            Submit\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport const CreateTopic = ({ chapterId, setIsShowing, setErrorMessage }) => {\n  const [topic, setTopic] = useState({ title: \"\", content: \"\", sn: 0 });\n  const { createForm, setCreateForm } = useAdminData();\n\n  const createTopic = (e) => {\n    e.preventDefault();\n\n    const postTopic = async () => {\n      const posted = await axios.post(\n        process.env.REACT_APP_BACKEND + \"/topic/create\",\n        { ...topic, chapterId },\n        { withCredentials: true }\n      );\n      setErrorMessage(posted?.data?.message)\n      setIsShowing(true)\n      setTimeout(() => {\n        setIsShowing(false)\n        setErrorMessage(\"\")\n      }, 4000);\n      mutate(process.env.REACT_APP_BACKEND + `/topics/${chapterId}/list`)\n    };\n\n    postTopic().catch((err) => console.log(err));\n\n    setCreateForm((prev) => {\n      return { ...prev, topic: !prev.topic };\n    });\n  };\n  return (\n    <div\n      className={`${!createForm.topic ? \"hidden\" : \"flex\"\n        } w-full h-full absolute top-0 right-0 bg-blue-50 rounded-[1em] z-20`}>\n      <form\n        className=\"w-full transition-all mt-10 flex flex-col p-5 mb-10\"\n        onSubmit={createTopic}>\n        <div className=\"mb-6\">\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-red-500 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Topic Name\"\n            onChange={(e) => setTopic({ ...topic, title: e.target.value })}\n            required\n          />\n          <input\n            className=\"font-sans shadow appearance-none border focus:outline-blue-800 focus:shadow-none border-red-500 rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight\"\n            type=\"text\"\n            placeholder=\"Topic Order\"\n            onChange={(e) => setTopic({ ...topic, sn: e.target.value })}\n            required\n          />\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              setCreateForm((prev) => {\n                return { ...prev, topic: false };\n              });\n            }}\n            className=\"float-left flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\">\n            Close\n          </button>\n          <button\n            className=\"float-right flex items-center gap-2 font-sans text-lg hover:translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\"\n            type=\"submit\">\n            Submit\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n","import React, { useState, useRef, useEffect } from \"react\";\nimport useSWR, { mutate } from \"swr\";\nimport { getSubjects } from '../../../api/Courses'\nimport { BiEdit } from \"react-icons/bi\";\nimport DeleteButton from \"./DeleteButton\";\nimport { useNavigate } from \"react-router-dom\";\nimport { IoPlayForwardSharp } from \"react-icons/io5\";\nimport { editSubject } from '../../../api/Courses'\nimport { useAdminData } from \"../../../context/AdminProvider\";\n\nfunction SubjectList({ setCourseErrorMessage, setCourseIsShowing, courseId: _id }) {\n  const navigate = useNavigate()\n  const [subjects, setSubjects] = useState([])\n  const { errorMessage, setErrorMessage, isShowing, setIsShowing } = useAdminData()\n  let subjectRef = useRef([]);\n  let subjectThumbnailRef = useRef([]);\n  const { data: subjectData } = useSWR(process.env.REACT_APP_BACKEND + `/subjects/${_id}/list`, async url => await getSubjects(url))\n\n  const postEditSubject = async (courseId, subjectId, subjectTitle, published, thumbnail) => {\n    const subjectEdit = await editSubject(process.env.REACT_APP_BACKEND + \"/subject/edit\", {\n      courseId,\n      subjectId,\n      subjectTitle,\n      published,\n      thumbnail\n    });\n    setErrorMessage(subjectEdit?.message)\n    setIsShowing(true)\n    setTimeout(() => {\n      setIsShowing(false)\n      setErrorMessage(\"\")\n    }, 4000);\n    mutate(process.env.REACT_APP_BACKEND + `/subjects/${courseId}/list`)\n  };\n\n  useEffect(() => {\n    setSubjects(subjectData?.data?.subjects)\n  }, [subjectData])\n\n  return <div className=\"w-full flex gap-5 flex-col z-10 px-5\">\n    {subjects?.map((subjectObj, i) => {\n      return (\n        <div key={subjectObj._id} className=\"w-full\">\n          <div className=\"shadow-md border-b-2 md:border-2 border-red-200 rounded-[0.5em] text-center py-2 flex flex-col items-center\">\n            <div className=\"flex gap-2 mb-5\">\n              <div\n                ref={(element) =>\n                  subjectRef.current.push(element)\n                }\n                className=\"text-xl font-bold text-red-800 font-mono\"\n                onInput={(e) => {\n                  console.log(\n                    e.currentTarget.textContent\n                  );\n                }}\n                onBlur={(e) => {\n                  postEditSubject(\n                    _id,\n                    subjectObj._id,\n                    e.currentTarget.textContent,\n                    subjectObj.published,\n                    subjectObj.thumbnail\n                  );\n                  subjectRef.current[i].contentEditable = false;\n                }}>\n                {subjectObj.title}\n              </div>\n              <BiEdit\n                size={18}\n                color=\"red\"\n                className=\"hover:translate-y-0.5 cursor-pointer\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  subjectRef.current[i].contentEditable = true;\n                  subjectRef.current[i].focus();\n                }}\n              />\n            </div>\n\n            <div className=\"w-full flex flex-col mb-10\">\n              <span\n                ref={(element) =>\n                  subjectThumbnailRef.current.push(element)\n                }\n                className=\"text-blue-600 break-words font-sans font-light p-1\"\n                onBlur={(e) => {\n                  postEditSubject(_id, subjectObj._id, subjectObj.title, subjectObj.published, e.currentTarget.textContent);\n                  subjectThumbnailRef.current[i].contentEditable = false;\n                }}>\n                {subjectObj.thumbnail}\n              </span>\n              <span className=\"mx-auto\">\n                <BiEdit\n                  size={24}\n                  color=\"red\"\n                  className=\"hover:translate-y-0.5 cursor-pointer\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    subjectThumbnailRef.current[i].contentEditable = true;\n                    subjectThumbnailRef.current[i].focus();\n                  }}\n                />\n              </span>\n            </div>\n\n            <div className=\"flex flex-col md:flex-row items-center md:gap-4\">\n              <div\n                className=\"flex items-center gap-2 cursor-pointer\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  navigate(`/admin/courses/${_id}/${subjectObj._id}`)\n                }}>\n                <span className=\"text-blue-600 border-b border-blue-500\">\n                  See all chapters\n                </span>\n                <IoPlayForwardSharp\n                  color=\"blue\"\n                  className=\"hover:translate-y-0.5 justify-self-end\"\n                />\n              </div>\n              <div className=\"w-full flex justify-center py-3\">\n                {!subjectObj.published ? (\n                  <div className=\"flex justify-end\">\n                    <button onClick={() => {\n                      postEditSubject(_id, subjectObj._id, subjectObj.title, true);\n                    }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Publish</button>\n                  </div>\n                ) :\n                  <div className=\"flex justify-end\">\n                    <button onClick={() => {\n                      postEditSubject(_id, subjectObj._id, subjectObj.title, false);\n                    }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Unpublish</button>\n                  </div>\n                }\n              </div>\n              <div className=\"relative py-2 flex w-full justify-around\">\n                <DeleteButton\n                  text=\"Delete Subject\"\n                  element=\"subject\"\n                  data={{ courseId: _id, subjectId: subjectObj._id }}\n                  setErrorMessage={setCourseErrorMessage}\n                  setIsShowing={setCourseIsShowing}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      )\n    })}\n  </div>\n}\n\nexport default SubjectList;","import React, { useRef, useState } from \"react\";\nimport { useAdminData } from \"../../../context/AdminProvider\";\nimport CreateButton from \"./CreateButton\";\nimport DeleteButton from \"./DeleteButton\";\nimport { CreateCourse, CreateSubject } from \"./CreateForm\";\nimport { BiEdit } from \"react-icons/bi\";\nimport { mutate } from \"swr\";\nimport SubjectList from \"./SubjectList\";\nimport { editCourse } from '../../../api/Courses'\nimport { IoIosArrowDropdown } from 'react-icons/io'\n\nfunction CourseList({ courses }) {\n  const { createForm } = useAdminData();\n  const [expanded, setExpanded] = useState([])\n  const { errorMessage, setErrorMessage, isShowing, setIsShowing } = useAdminData()\n  let courseRef = useRef([]);\n  let courseThumbnailRef = useRef([]);\n\n  const postEditCourse = async (courseId, courseTitle, published, thumbnail) => {\n    const courseEdit = await editCourse(process.env.REACT_APP_BACKEND + \"/course/edit\", {\n      courseId,\n      courseTitle,\n      published,\n      thumbnail\n    });\n    setErrorMessage(courseEdit?.message)\n    setIsShowing(true)\n    setTimeout(() => {\n      setIsShowing(false)\n      setErrorMessage(\"\")\n    }, 4000);\n    mutate(process.env.REACT_APP_BACKEND + \"/courses/list\")\n  };\n\n  return (\n    <div className=\"col-span-4 flex flex-col h-[70vh] md:h-full w-full\">\n      <div className=\"text-3xl text-center font-bold border-b-2 border-green-200 pt-6 pb-2 px-6\">\n        Courses\n      </div>\n      <div\n        className={`h-fit relative p-10 pb-2 flex-1 my-6 mx-6 border-2 border-gray-200 rounded-xl`}>\n        <div className=\"text-center text-3xl\">All Courses</div>\n        {/* Showing all courses */}\n        <div className=\"relative flex flex-col justify-between m-4 \">\n          {/* mapping all courses */}\n          {courses?.map((course, indx) => {\n            return (\n              <div\n                key={indx}\n                className=\"relative shadow-blue-200 hover:shadow-md border-2 rounded-[1em] p-3 my-2\">\n                <div className=\"text-center p-2 mt-2 flex justify-center\">\n                  <span\n                    ref={(element) =>\n                      courseRef.current.push(element)\n                    }\n                    className=\"text-blue-600 break-words font-mono text-[1.6rem] font-bold border-b-2 p-1\"\n                    onBlur={(e) => {\n                      postEditCourse(course._id, e.currentTarget.textContent, course.published, course.thumbnail);\n                      courseRef.current[indx].contentEditable = false;\n                    }}>\n                    {course.title}\n                  </span>\n                  <BiEdit\n                    size={24}\n                    color=\"red\"\n                    className=\"hover:translate-y-0.5 justify-self-end cursor-pointer\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      courseRef.current[indx].contentEditable = true;\n                      courseRef.current[indx].focus();\n                    }}\n                  />\n\n                  <div onClick={() => {\n                    let temp = expanded\n                    if (temp[indx]) {\n                      temp[indx] = false;\n                      setExpanded([...temp])\n                    } else {\n                      temp[indx] = true;\n                      setExpanded([...temp])\n                    }\n                  }} className={`${expanded[indx] ? \"rotate-180\" : \"\"} hover:cursor-pointer ml-2 md:ml-0 md:absolute right-10`}>\n                    <IoIosArrowDropdown color=\"blue\" size={35} />\n                  </div>\n                </div>\n\n                <div className=\"w-full flex flex-col mb-10\">\n                  <span\n                    ref={(element) =>\n                      courseThumbnailRef.current.push(element)\n                    }\n                    className=\"text-blue-600 break-words font-sans font-light p-1\"\n                    onBlur={(e) => {\n                      postEditCourse(course._id, course.title, course.published, e.currentTarget.textContent);\n                      courseThumbnailRef.current[indx].contentEditable = false;\n                    }}>\n                    {course.thumbnail}\n                  </span>\n                  <span className=\"mb-10\">\n                    <BiEdit\n                      size={24}\n                      color=\"red\"\n                      className=\"hover:translate-y-0.5 cursor-pointer\"\n                      onClick={(e) => {\n                        e.preventDefault();\n                        courseThumbnailRef.current[indx].contentEditable = true;\n                        courseThumbnailRef.current[indx].focus();\n                      }}\n                    />\n                  </span>\n                </div>\n\n                {createForm.subject.courseId === course._id ? (\n                  <div className=\"mb-16\">\n                    <CreateSubject courseId={course._id} setIsShowing={setIsShowing} setErrorMessage={setErrorMessage} />\n                  </div>\n                ) : null}\n\n                {/* showing list of subjects */}\n                {expanded[indx] ?\n                  <div className=\"animate-dropdownOpen\">\n                    <SubjectList setCourseErrorMessage={setErrorMessage} setCourseIsShowing={setIsShowing} courseId={course._id} />\n                  </div>\n                  :\n                  <></>\n                }\n\n\n                <div className=\"mt-8 flex gap-3 md:flex-row flex-col md:justify-between\">\n                  <DeleteButton\n                    text=\"Delete Course\"\n                    element=\"course\"\n                    data={{ courseId: course._id }}\n                    setErrorMessage={setErrorMessage}\n                    setIsShowing={setIsShowing}\n                  />\n                  {!course.published ? (\n                    <div className=\"flex justify-end\">\n                      <button onClick={() => {\n                        postEditCourse(course._id, course.title, true, course.thumbnail);\n                      }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Publish</button>\n                    </div>\n                  ) :\n                    <div className=\"flex justify-end\">\n                      <button onClick={() => {\n                        postEditCourse(course._id, course.title, false, course.thumbnail);\n                      }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Unpublish</button>\n                    </div>\n                  }\n                  <CreateButton\n                    text=\"Add Subject\"\n                    element=\"subject\"\n                    setExpanded={setExpanded}\n                    expanded={expanded}\n                    expandIndex={indx}\n                    data={{ courseId: course._id }}\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        <div className=\"relative m-4\">\n          <CreateButton text=\"Create Course\" element=\"course\" />\n          <CreateCourse setIsShowing={setIsShowing} setErrorMessage={setErrorMessage} />\n        </div>\n        <div className={`${isShowing ? \"animate-fade\" : \"\"} fixed bottom-10 right-10 text-warningText border-2 bg-slate-300 rounded-md px-2`}>\n          {errorMessage}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CourseList;\n","import React, { useState, useEffect } from \"react\";\nimport CourseList from \"./CourseList\";\nimport { getCourses } from '../../../api/Courses'\nimport useSWR from \"swr\";\n\nfunction Courses() {\n  const [courses, setCourses] = useState([])\n  const { data: courseData } = useSWR(process.env.REACT_APP_BACKEND + \"/courses/list\", async url => await getCourses(url))\n  useEffect(() => {\n    setCourses(courseData?.data)\n  }, [courseData])\n\n  return <CourseList courses={courses} />\n}\n\nexport default Courses;","import React, { useState, useRef, useEffect } from \"react\";\nimport useSWR, { mutate } from \"swr\";\nimport { editTopic, getTopics } from '../../../api/Courses'\nimport { BiEdit } from \"react-icons/bi\";\nimport { useParams } from \"react-router-dom\"\nimport DeleteButton from \"./DeleteButton\";\nimport { useNavigate } from \"react-router-dom\";\nimport { IoPlayForwardSharp } from \"react-icons/io5\";\nimport { useAdminData } from \"../../../context/AdminProvider\";\n\nfunction TopicList({ chapterId: _id, setSubjectErrorMessage, setSubjectIsShowing }) {\n    const navigate = useNavigate()\n    const params = useParams()\n    const [topics, setTopics] = useState([])\n    const { errorMessage, setErrorMessage, isShowing, setIsShowing } = useAdminData()\n    let topicRef = useRef([]);\n    let topicOrderRef = useRef([]);\n    const { data: topicData } = useSWR(process.env.REACT_APP_BACKEND + `/topics/${_id}/list`, async url => await getTopics(url))\n\n    const postEditTopic = async (\n        chapterId,\n        topicId,\n        topicTitle,\n        topicContent,\n        published,\n        sn\n    ) => {\n        const topicEdit = await editTopic(process.env.REACT_APP_BACKEND + \"/topic/edit\", {\n            topicId,\n            topicTitle,\n            topicContent,\n            published,\n            sn\n        });\n        setErrorMessage(topicEdit?.message)\n        setIsShowing(true)\n        setTimeout(() => {\n            setIsShowing(false)\n            setErrorMessage(\"\")\n        }, 4000);\n        mutate(process.env.REACT_APP_BACKEND + `/topics/${chapterId}/list`)\n    };\n\n\n    useEffect(() => {\n        setTopics(topicData?.data?.topics)\n    }, [topicData])\n\n    return <div className=\"w-full flex justify-between flex-wrap gap-2 mt-4 z-10\">\n        {topics?.map((topicObj, i) => {\n            return (\n                <div key={topicObj._id} className=\"w-full\">\n                    <div className=\"shadow-md border-b-2 md:border-2 border-red-200 rounded-[0.5em] cursor-pointer text-center py-2 flex flex-col items-center\">\n                        <div className=\"flex gap-2 mb-5\">\n                            <BiEdit\n                                size={18}\n                                color=\"red\"\n                                className=\"hover:translate-y-0.5 cursor-pointer\"\n                                onClick={(e) => {\n                                    e.preventDefault();\n                                    topicOrderRef.current[i].contentEditable = true;\n                                    topicOrderRef.current[i].focus();\n                                }}\n                            />\n                            <span\n                                ref={(element) =>\n                                    topicOrderRef.current.push(element)\n                                }\n                                className=\"text-blue-600 font-mono text-[1.6rem] font-bold border-b-2 py-1\"\n                                onBlur={(e) => {\n                                    postEditTopic(\n                                        params.chapterId,\n                                        topicObj._id,\n                                        topicObj.title,\n                                        topicObj.content,\n                                        topicObj.published,\n                                        e.currentTarget.textContent\n                                    );\n                                    topicOrderRef.current[i].contentEditable = false;\n                                }}>\n                                {topicObj?.sn}\n                            </span>\n                            <span className=\"text-blue-600 font-mono text-[1.6rem] font-bold border-b-2 py-1 pr-2\">.</span>\n                            <span\n                                ref={(element) =>\n                                    topicRef.current.push(element)\n                                }\n                                className=\"text-xl font-bold text-red-800 flex font-mono\"\n                                onBlur={(e) => {\n                                    postEditTopic(\n                                        _id,\n                                        topicObj._id,\n                                        e.currentTarget.textContent,\n                                        topicObj.content,\n                                        topicObj.published,\n                                        topicObj.sn,\n                                    );\n                                    topicRef.current[i].contentEditable = false;\n                                }}>\n                                {topicObj.title}\n                            </span>\n                            <BiEdit\n                                size={18}\n                                color=\"red\"\n                                className=\"hover:translate-y-0.5 cursor-pointer\"\n                                onClick={(e) => {\n                                    e.preventDefault();\n                                    console.log(\n                                        topicRef.current[i]\n                                    );\n                                    topicRef.current[i].contentEditable = true;\n                                    topicRef.current[i].focus();\n                                }}\n                            />\n                        </div>\n                        <div className=\"flex flex-col md:flex-row items-center md:gap-4\">\n                            <div\n                                className=\"flex items-center gap-2 cursor-pointer\"\n                                onClick={(e) => {\n                                    e.preventDefault();\n                                    navigate(`/admin/courses/${params.courseId}/${params.subjectId}/${_id}/${topicObj._id}`)\n                                }}>\n                                <span className=\"text-blue-600 border-b border-blue-500\">\n                                    Check Content\n                                </span>\n                                <IoPlayForwardSharp\n                                    color=\"blue\"\n                                    className=\"hover:translate-y-0.5 justify-self-end\"\n                                />\n                            </div>\n                            <div className=\"w-full flex justify-center py-3\">\n                                {!topicObj.published ? (\n                                    <div className=\"flex justify-end\">\n                                        <button onClick={() => {\n                                            postEditTopic(_id, topicObj._id, topicObj.title, topicObj.content, true);\n                                        }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Publish</button>\n                                    </div>\n                                ) :\n                                    <div className=\"flex justify-end\">\n                                        <button onClick={() => {\n                                            postEditTopic(_id, topicObj._id, topicObj.title, topicObj.content, false);\n                                        }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Unpublish</button>\n                                    </div>\n                                }\n                            </div>\n                            <div className=\"relative py-2 flex w-full justify-around\">\n                                <DeleteButton\n                                    text=\"Delete Topic\"\n                                    element=\"topic\"\n                                    data={{ chapterId: _id, topicId: topicObj._id }}\n                                    setErrorMessage={setSubjectErrorMessage}\n                                    setIsShowing={setSubjectIsShowing}\n                                />\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            );\n        })}\n    </div>\n}\n\nexport default TopicList;","import React, { useState, useRef, useEffect } from \"react\";\nimport { useAdminData } from \"../../../context/AdminProvider\";\nimport CreateButton from \"./CreateButton\";\nimport { CreateChapter, CreateTopic } from \"./CreateForm\";\nimport DeleteButton from \"./DeleteButton\";\nimport { BiEdit } from \"react-icons/bi\";\nimport TopicList from './TopicList'\nimport { useParams } from \"react-router-dom\";\nimport { mutate } from 'swr'\nimport { editChapter } from '../../../api/Courses'\nimport { IoIosArrowDropdown } from 'react-icons/io'\n\nfunction ChapterList({ courseId, chapters, subjectTitle }) {\n  const { createForm } = useAdminData();\n  const params = useParams()\n  const [chaptersList, setChaptersList] = useState([])\n  const { errorMessage, setErrorMessage, isShowing, setIsShowing } = useAdminData()\n  const [expanded, setExpanded] = useState([])\n  let chapterRef = useRef([]);\n  let chapterOrderRef = useRef([]);\n  useEffect(() => {\n    setChaptersList(chapters)\n  }, [chapters])\n\n  const postEditChapter = async (\n    subjectId,\n    chapterId,\n    chapterTitle,\n    published,\n    order\n  ) => {\n    const chapterEdit = await editChapter(process.env.REACT_APP_BACKEND + \"/chapter/edit\", {\n      chapterId,\n      chapterTitle,\n      published,\n      order\n    });\n    setErrorMessage(chapterEdit?.message)\n    setIsShowing(true)\n    setTimeout(() => {\n      setIsShowing(false)\n      setErrorMessage(\"\")\n    }, 4000);\n    mutate(process.env.REACT_APP_BACKEND + `/chapters/${courseId}/${subjectId}/list`)\n  };\n\n  return (\n    <div className=\"col-span-4 flex flex-col h-full\">\n      <div className=\"text-3xl text-center font-bold border-b-2 border-green-200 pt-6 pb-2 px-6\">\n        chaptersList\n      </div>\n      <div\n        className={`h-fit relative p-10 pb-2 flex-1 my-6 mx-6 border-2 border-gray-200 rounded-xl`}>\n        <div className=\"text-center text-3xl\">{subjectTitle}</div>\n\n        {/* Showing all chaptersList */}\n        <div className=\"relative flex flex-col justify-between m-4 \">\n          {chaptersList?.map((chapterObj, i) => {\n            return (\n              <div\n                key={chapterObj._id}\n                className=\"hover:cursor-pointer relative shadow-blue-200 hover:shadow-md border-2 rounded-[1em] p-3 my-2\">\n                <div className=\"text-center p-2 mt-2 flex justify-center\">\n                  <BiEdit\n                    size={18}\n                    color=\"red\"\n                    className=\"hover:translate-y-0.5 cursor-pointer\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      chapterOrderRef.current[i].contentEditable = true;\n                      chapterOrderRef.current[i].focus();\n                    }}\n                  />\n                  <span\n                    ref={(element) =>\n                      chapterOrderRef.current.push(element)\n                    }\n                    className=\"text-blue-600 font-mono text-[1.6rem] font-bold border-b-2 py-1\"\n                    onBlur={(e) => {\n                      postEditChapter(\n                        params.subjectId,\n                        chapterObj._id,\n                        chapterObj.title,\n                        chapterObj.published,\n                        e.currentTarget.textContent,\n                      );\n                      chapterOrderRef.current[i].contentEditable = false;\n                    }}>\n                    {chapterObj?.sn}\n                  </span>\n                  <span className=\"text-blue-600 font-mono text-[1.6rem] font-bold border-b-2 py-1 pr-2\">.</span>\n                  <span\n                    ref={(element) =>\n                      chapterRef.current.push(element)\n                    }\n                    className=\"text-blue-600 font-mono text-[1.6rem] font-bold border-b-2 p-1\"\n                    onBlur={(e) => {\n                      postEditChapter(\n                        params.subjectId,\n                        chapterObj._id,\n                        e.currentTarget.textContent,\n                        chapterObj.published,\n                        chapterObj.order\n                      );\n                      chapterRef.current[i].contentEditable = false;\n                    }}>\n                    {chapterObj.title}\n                  </span>\n                  <BiEdit\n                    size={18}\n                    color=\"red\"\n                    className=\"hover:translate-y-0.5 cursor-pointer\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      chapterRef.current[i].contentEditable = true;\n                      chapterRef.current[i].focus();\n                    }}\n                  />\n                  <div onClick={() => {\n                    let temp = expanded\n                    if (temp[i]) {\n                      temp[i] = false;\n                      setExpanded([...temp])\n                    } else {\n                      temp[i] = true;\n                      setExpanded([...temp])\n                    }\n                  }} className={`${expanded[i] ? \"rotate-180\" : \"\"} hover:cursor-pointer absolute right-10`}>\n                    <IoIosArrowDropdown color=\"blue\" size={35} />\n                  </div>\n                </div>\n\n                {createForm.topic.chapterId === chapterObj._id ? (\n                  <div className=\"mb-24\">\n                    <CreateTopic\n                      courseId={params.courseId}\n                      subjectId={params.subjectId}\n                      chapterId={chapterObj._id}\n                      setIsShowing={setIsShowing}\n                      setErrorMessage={setErrorMessage}\n                    />\n                  </div>\n                ) : null}\n\n                {/* showing list of topics */}\n                {expanded[i] ?\n                  <div className=\"animate-dropdownOpen\">\n                    <TopicList setSubjectErrorMessage={setErrorMessage} setSubjectIsShowing={setIsShowing} chapterId={chapterObj._id} />\n                  </div>\n                  :\n                  <></>\n                }\n\n                <div className=\"mt-8 flex gap-3 md:flex-row flex-col md:justify-between\">\n                  <DeleteButton\n                    text=\"Delete Chapter\"\n                    element=\"chapter\"\n                    data={{ courseId: params.courseId, subjectId: params.subjectId, chapterId: chapterObj._id }}\n                    setErrorMessage={setErrorMessage}\n                    setIsShowing={setIsShowing}\n                  />\n                  {!chapterObj.published ? (\n                    <div className=\"flex justify-end\">\n                      <button onClick={() => {\n                        postEditChapter(params.subjectId, chapterObj._id, chapterObj.title, true);\n                      }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Publish</button>\n                    </div>\n                  ) :\n                    <div className=\"flex justify-end\">\n                      <button onClick={() => {\n                        postEditChapter(params.subjectId, chapterObj._id, chapterObj.title, false);\n                      }} className=\"flex items-center gap-2 font-sans text-md md:text-lg hover:translate-y-0.5 transition-all bg-slate-500 hover:bg-red-700 text-white py-2 px-1 md:px-4 rounded-md focus:outline-none focus:shadow-outline\">Unpublish</button>\n                    </div>\n                  }\n                  <CreateButton\n                    text=\"Add Topic\"\n                    element=\"topic\"\n                    setExpanded={setExpanded}\n                    expanded={expanded}\n                    expandIndex={i}\n                    data={{ chapterId: chapterObj._id }}\n                  />\n                </div>\n              </div>\n            );\n          })}\n\n        </div>\n        <div className=\"relative m-3\">\n          <CreateButton text=\"Create Chapter\" element=\"chapter\" />\n          <CreateChapter courseId={courseId} subjectId={params.subjectId} setIsShowing={setIsShowing} setErrorMessage={setErrorMessage} />\n        </div>\n        <div className={`${isShowing ? \"animate-fade\" : \"\"} fixed bottom-10 right-10 text-warningText border-2 bg-slate-300 rounded-md px-2`}>\n          {errorMessage}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ChapterList;\n","import React, { useState, useEffect } from \"react\";\nimport ChapterList from \"./ChapterList\";\nimport { useParams } from \"react-router-dom\";\nimport { getChapters } from '../../../api/Courses'\nimport useSWR from \"swr\";\n\nfunction Chapters() {\n  const [chapters, setChapters] = useState([])\n  const params = useParams()\n  const { data: chapterData } = useSWR(process.env.REACT_APP_BACKEND + `/chapters/${params.courseId}/${params.subjectId}/list`, async url => await getChapters(url))\n\n  useEffect(() => {\n    setChapters(chapterData?.data?.chapters)\n  }, [chapterData])\n\n  return (\n    <ChapterList courseId={params?.courseId} chapters={chapters} subjectTitle={chapterData?.data?.subject?.title} />\n  )\n}\n\nexport default Chapters;\n","export type SettingName =\n  | 'disableBeforeInput'\n  | 'measureTypingPerf'\n  | 'isRichText'\n  | 'isCollab'\n  | 'isCharLimit'\n  | 'isMaxLength'\n  | 'isCharLimitUtf8'\n  | 'isAutocomplete'\n  | 'showTreeView'\n  | 'showNestedEditorTreeView'\n  | 'emptyEditor'\n  | 'showTableOfContents';\n\nexport type Settings = Record<SettingName, boolean>;\n\nconst hostName = window.location.hostname;\nexport const isDevPlayground: boolean =\n  hostName !== 'playground.lexical.dev' &&\n  hostName !== 'lexical-playground.vercel.app';\n\nexport const DEFAULT_SETTINGS: Settings = {\n  disableBeforeInput: false,\n  emptyEditor: isDevPlayground,\n  isAutocomplete: false,\n  isCharLimit: false,\n  isCharLimitUtf8: false,\n  isCollab: false,\n  isMaxLength: false,\n  isRichText: true,\n  measureTypingPerf: false,\n  showNestedEditorTreeView: false,\n  showTableOfContents: false,\n  showTreeView: true,\n};","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {SettingName} from '../appSettings';\n\nimport * as React from 'react';\nimport {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n} from 'react';\n\nimport {DEFAULT_SETTINGS} from '../appSettings';\n\ntype SettingsContextShape = {\n  setOption: (name: SettingName, value: boolean) => void;\n  settings: Record<SettingName, boolean>;\n};\n\nconst Context: React.Context<SettingsContextShape> = createContext({\n  setOption: (name: SettingName, value: boolean) => {\n    return;\n  },\n  settings: DEFAULT_SETTINGS,\n});\n\nexport const SettingsContext = ({\n  children,\n}: {\n  children: ReactNode;\n}): JSX.Element => {\n  const [settings, setSettings] = useState(DEFAULT_SETTINGS);\n\n  const setOption = useCallback((setting: SettingName, value: boolean) => {\n    setSettings((options) => ({\n      ...options,\n      [setting as string]: value,\n    }));\n    if (DEFAULT_SETTINGS[setting] === value) {\n      setURLParam(setting, null);\n    } else {\n      setURLParam(setting, value);\n    }\n  }, []);\n\n  const contextValue = useMemo(() => {\n    return {setOption, settings};\n  }, [setOption, settings]);\n\n  return <Context.Provider value={contextValue}>{children}</Context.Provider>;\n};\n\nexport const useSettings = (): SettingsContextShape => {\n  return useContext(Context);\n};\n\nfunction setURLParam(param: SettingName, value: null | boolean) {\n  const url = new URL(window.location.href);\n  const params = new URLSearchParams(url.search);\n  if (value !== null) {\n    if (params.has(param)) {\n      params.set(param, String(value));\n    } else {\n      params.append(param, String(value));\n    }\n  } else {\n    if (params.has(param)) {\n      params.delete(param);\n    }\n  }\n  url.search = params.toString();\n  window.history.pushState(null, '', url.toString());\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {HistoryState} from '@lexical/react/LexicalHistoryPlugin';\n\nimport {createEmptyHistoryState} from '@lexical/react/LexicalHistoryPlugin';\nimport * as React from 'react';\nimport {createContext, ReactNode, useContext, useMemo} from 'react';\n\ntype ContextShape = {\n  historyState?: HistoryState;\n};\n\nconst Context: React.Context<ContextShape> = createContext({});\n\nexport const SharedHistoryContext = ({\n  children,\n}: {\n  children: ReactNode;\n}): JSX.Element => {\n  const historyContext = useMemo(\n    () => ({historyState: createEmptyHistoryState()}),\n    [],\n  );\n  return <Context.Provider value={historyContext}>{children}</Context.Provider>;\n};\n\nexport const useSharedHistoryContext = (): ContextShape => {\n  return useContext(Context);\n};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './Modal.css';\n\nimport * as React from 'react';\nimport {ReactNode, useEffect, useRef} from 'react';\nimport {createPortal} from 'react-dom';\n\nfunction PortalImpl({\n  onClose,\n  children,\n  title,\n  closeOnClickOutside,\n}: {\n  children: ReactNode;\n  closeOnClickOutside: boolean;\n  onClose: () => void;\n  title: string;\n}) {\n  const modalRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (modalRef.current !== null) {\n      modalRef.current.focus();\n    }\n  }, []);\n\n  useEffect(() => {\n    let modalOverlayElement: HTMLElement | null = null;\n    const handler = (event: KeyboardEvent) => {\n      if (event.keyCode === 27) {\n        onClose();\n      }\n    };\n    const clickOutsideHandler = (event: MouseEvent) => {\n      const target = event.target;\n      if (\n        modalRef.current !== null &&\n        !modalRef.current.contains(target as Node) &&\n        closeOnClickOutside\n      ) {\n        onClose();\n      }\n    };\n    if (modalRef.current !== null) {\n      modalOverlayElement = modalRef.current?.parentElement;\n      if (modalOverlayElement !== null) {\n        modalOverlayElement?.addEventListener('click', clickOutsideHandler);\n      }\n    }\n\n    window.addEventListener('keydown', handler);\n\n    return () => {\n      window.removeEventListener('keydown', handler);\n      if (modalOverlayElement !== null) {\n        modalOverlayElement?.removeEventListener('click', clickOutsideHandler);\n      }\n    };\n  }, [closeOnClickOutside, onClose]);\n\n  return (\n    <div className=\"Modal__overlay\" role=\"dialog\">\n      <div className=\"Modal__modal\" tabIndex={-1} ref={modalRef}>\n        <h2 className=\"Modal__title\">{title}</h2>\n        <button\n          className=\"Modal__closeButton\"\n          aria-label=\"Close modal\"\n          type=\"button\"\n          onClick={onClose}>\n          X\n        </button>\n        <div className=\"Modal__content\">{children}</div>\n      </div>\n    </div>\n  );\n}\n\nexport default function Modal({\n  onClose,\n  children,\n  title,\n  closeOnClickOutside = false,\n}: {\n  children: ReactNode;\n  closeOnClickOutside?: boolean;\n  onClose: () => void;\n  title: string;\n}): JSX.Element {\n  return createPortal(\n    <PortalImpl\n      onClose={onClose}\n      title={title}\n      closeOnClickOutside={closeOnClickOutside}>\n      {children}\n    </PortalImpl>,\n    document.body,\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useCallback, useMemo, useState} from 'react';\nimport * as React from 'react';\n\nimport Modal from '../ui/Modal';\n\nexport default function useModal(): [\n  JSX.Element | null,\n  (title: string, showModal: (onClose: () => void) => JSX.Element) => void,\n] {\n  const [modalContent, setModalContent] = useState<null | {\n    closeOnClickOutside: boolean;\n    content: JSX.Element;\n    title: string;\n  }>(null);\n\n  const onClose = useCallback(() => {\n    setModalContent(null);\n  }, []);\n\n  const modal = useMemo(() => {\n    if (modalContent === null) {\n      return null;\n    }\n    const {title, content, closeOnClickOutside} = modalContent;\n    return (\n      <Modal\n        onClose={onClose}\n        title={title}\n        closeOnClickOutside={closeOnClickOutside}>\n        {content}\n      </Modal>\n    );\n  }, [modalContent, onClose]);\n\n  const showModal = useCallback(\n    (\n      title: string,\n      // eslint-disable-next-line no-shadow\n      getContent: (onClose: () => void) => JSX.Element,\n      closeOnClickOutside = false,\n    ) => {\n      setModalContent({\n        closeOnClickOutside,\n        content: getContent(onClose),\n        title,\n      });\n    },\n    [onClose],\n  );\n\n  return [modal, showModal];\n}\n","export default function joinClasses(\n  ...args: Array<string | boolean | null | undefined>\n) {\n  return args.filter(Boolean).join(' ');\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './Button.css';\n\nimport * as React from 'react';\nimport {ReactNode} from 'react';\n\nimport joinClasses from '../utils/join-classes';\n\nexport default function Button({\n  'data-test-id': dataTestId,\n  children,\n  className,\n  onClick,\n  disabled,\n  small,\n  title,\n}: {\n  'data-test-id'?: string;\n  children: ReactNode;\n  className?: string;\n  disabled?: boolean;\n  onClick: () => void;\n  small?: boolean;\n  title?: string;\n}): JSX.Element {\n  return (\n    <button\n      disabled={disabled}\n      className={joinClasses(\n        'Button__root',\n        disabled && 'Button__disabled',\n        small && 'Button__small',\n        className,\n      )}\n      onClick={onClick}\n      title={title}\n      aria-label={title}\n      {...(dataTestId && {'data-test-id': dataTestId})}>\n      {children}\n    </button>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './EquationEditor.css';\n\nimport * as React from 'react';\nimport {ChangeEvent, RefObject} from 'react';\n\ntype BaseEquationEditorProps = {\n  equation: string;\n  inline: boolean;\n  inputRef: {current: null | HTMLInputElement | HTMLTextAreaElement};\n  setEquation: (equation: string) => void;\n};\n\nexport default function EquationEditor({\n  equation,\n  setEquation,\n  inline,\n  inputRef,\n}: BaseEquationEditorProps): JSX.Element {\n  const onChange = (event: ChangeEvent) => {\n    setEquation((event.target as HTMLInputElement).value);\n  };\n\n  const props = {\n    equation,\n    inputRef,\n    onChange,\n  };\n\n  return inline ? (\n    <InlineEquationEditor\n      {...props}\n      inputRef={inputRef as RefObject<HTMLInputElement>}\n    />\n  ) : (\n    <BlockEquationEditor\n      {...props}\n      inputRef={inputRef as RefObject<HTMLTextAreaElement>}\n    />\n  );\n}\n\ntype EquationEditorImplProps = {\n  equation: string;\n  inputRef: {current: null | HTMLInputElement};\n  onChange: (event: ChangeEvent<HTMLInputElement>) => void;\n};\n\nfunction InlineEquationEditor({\n  equation,\n  onChange,\n  inputRef,\n}: EquationEditorImplProps): JSX.Element {\n  return (\n    <span className=\"EquationEditor_inputBackground\">\n      <span className=\"EquationEditor_dollarSign\">$</span>\n      <input\n        className=\"EquationEditor_inlineEditor\"\n        value={equation}\n        onChange={onChange}\n        autoFocus={true}\n        ref={inputRef}\n      />\n      <span className=\"EquationEditor_dollarSign\">$</span>\n    </span>\n  );\n}\n\ntype BlockEquationEditorImplProps = {\n  equation: string;\n  inputRef: {current: null | HTMLTextAreaElement};\n  onChange: (event: ChangeEvent<HTMLTextAreaElement>) => void;\n};\n\nfunction BlockEquationEditor({\n  equation,\n  onChange,\n  inputRef,\n}: BlockEquationEditorImplProps): JSX.Element {\n  return (\n    <div className=\"EquationEditor_inputBackground\">\n      <span className=\"EquationEditor_dollarSign\">{'$$\\n'}</span>\n      <textarea\n        className=\"EquationEditor_blockEditor\"\n        value={equation}\n        onChange={onChange}\n        ref={inputRef}\n      />\n      <span className=\"EquationEditor_dollarSign\">{'\\n$$'}</span>\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport katex from 'katex';\nimport * as React from 'react';\nimport {useEffect, useRef} from 'react';\n\nexport default function KatexRenderer({\n  equation,\n  inline,\n  onClick,\n}: Readonly<{\n  equation: string;\n  inline: boolean;\n  onClick: () => void;\n}>): JSX.Element {\n  const katexElementRef = useRef(null);\n\n  useEffect(() => {\n    const katexElement = katexElementRef.current;\n\n    if (katexElement !== null) {\n      katex.render(equation, katexElement, {\n        displayMode: !inline, // true === block display //\n        errorColor: '#cc0000',\n        output: 'html',\n        strict: 'warn',\n        throwOnError: false,\n        trust: false,\n      });\n    }\n  }, [equation, inline]);\n\n  return (\n    // We use spacers either side to ensure Android doesn't try and compose from the\n    // inner text from Katex. There didn't seem to be any other way of making this work,\n    // without having a physical space.\n    <>\n      <span className=\"spacer\"> </span>\n      <span\n        role=\"button\"\n        tabIndex={-1}\n        onClick={onClick}\n        ref={katexElementRef}\n      />\n      <span className=\"spacer\"> </span>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorConfig,\n  LexicalNode,\n  NodeKey,\n  SerializedLexicalNode,\n  Spread,\n} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getNodeByKey,\n  COMMAND_PRIORITY_HIGH,\n  DecoratorNode,\n  KEY_ESCAPE_COMMAND,\n  SELECTION_CHANGE_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {useCallback, useEffect, useRef, useState} from 'react';\n\nimport EquationEditor from '../ui/EquationEditor';\nimport KatexRenderer from '../ui/KatexRenderer';\n\ntype EquationComponentProps = {\n  equation: string;\n  inline: boolean;\n  nodeKey: NodeKey;\n};\n\nfunction EquationComponent({\n  equation,\n  inline,\n  nodeKey,\n}: EquationComponentProps): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [equationValue, setEquationValue] = useState(equation);\n  const [showEquationEditor, setShowEquationEditor] = useState<boolean>(false);\n  const inputRef = useRef(null);\n  const onHide = useCallback(\n    (restoreSelection?: boolean) => {\n      setShowEquationEditor(false);\n      editor.update(() => {\n        const node = $getNodeByKey(nodeKey);\n        if ($isEquationNode(node)) {\n          node.setEquation(equationValue);\n          if (restoreSelection) {\n            node.selectNext(0, 0);\n          }\n        }\n      });\n    },\n    [editor, equationValue, nodeKey],\n  );\n\n  useEffect(() => {\n    if (showEquationEditor) {\n      return mergeRegister(\n        editor.registerCommand(\n          SELECTION_CHANGE_COMMAND,\n          (payload) => {\n            const activeElement = document.activeElement;\n            const inputElem = inputRef.current;\n            if (inputElem !== activeElement) {\n              onHide();\n            }\n            return false;\n          },\n          COMMAND_PRIORITY_HIGH,\n        ),\n        editor.registerCommand(\n          KEY_ESCAPE_COMMAND,\n          (payload) => {\n            const activeElement = document.activeElement;\n            const inputElem = inputRef.current;\n            if (inputElem === activeElement) {\n              onHide(true);\n              return true;\n            }\n            return false;\n          },\n          COMMAND_PRIORITY_HIGH,\n        ),\n      );\n    }\n  }, [editor, onHide, showEquationEditor]);\n\n  return (\n    <>\n      {showEquationEditor ? (\n        <EquationEditor\n          equation={equationValue}\n          setEquation={setEquationValue}\n          inline={inline}\n          inputRef={inputRef}\n        />\n      ) : (\n        <KatexRenderer\n          equation={equationValue}\n          inline={inline}\n          onClick={() => {\n            setShowEquationEditor(true);\n          }}\n        />\n      )}\n    </>\n  );\n}\n\nexport type SerializedEquationNode = Spread<\n  {\n    type: 'equation';\n    equation: string;\n    inline: boolean;\n  },\n  SerializedLexicalNode\n>;\n\nexport class EquationNode extends DecoratorNode<JSX.Element> {\n  __equation: string;\n  __inline: boolean;\n\n  static getType(): string {\n    return 'equation';\n  }\n\n  static clone(node: EquationNode): EquationNode {\n    return new EquationNode(node.__equation, node.__inline, node.__key);\n  }\n\n  constructor(equation: string, inline?: boolean, key?: NodeKey) {\n    super(key);\n    this.__equation = equation;\n    this.__inline = inline ?? false;\n  }\n\n  static importJSON(serializedNode: SerializedEquationNode): EquationNode {\n    const node = $createEquationNode(\n      serializedNode.equation,\n      serializedNode.inline,\n    );\n    return node;\n  }\n\n  exportJSON(): SerializedEquationNode {\n    return {\n      equation: this.getEquation(),\n      inline: this.__inline,\n      type: 'equation',\n      version: 1,\n    };\n  }\n\n  createDOM(_config: EditorConfig): HTMLElement {\n    return document.createElement(this.__inline ? 'span' : 'div');\n  }\n\n  updateDOM(prevNode: EquationNode): boolean {\n    // If the inline property changes, replace the element\n    return this.__inline !== prevNode.__inline;\n  }\n\n  getEquation(): string {\n    return this.__equation;\n  }\n\n  setEquation(equation: string): void {\n    const writable = this.getWritable();\n    writable.__equation = equation;\n  }\n\n  decorate(): JSX.Element {\n    return (\n      <EquationComponent\n        equation={this.__equation}\n        inline={this.__inline}\n        nodeKey={this.__key}\n      />\n    );\n  }\n}\n\nexport function $createEquationNode(\n  equation = '',\n  inline = false,\n): EquationNode {\n  const equationNode = new EquationNode(equation, inline);\n  return equationNode;\n}\n\nexport function $isEquationNode(\n  node: LexicalNode | null | undefined,\n): node is EquationNode {\n  return node instanceof EquationNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nconst getSelection = (): Selection | null => window.getSelection();\n\nexport default getSelection;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport type {LexicalCommand, LexicalEditor} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $createRangeSelection,\n  $getSelection,\n  $isNodeSelection,\n  $isRangeSelection,\n  $isRootNode,\n  $setSelection,\n  COMMAND_PRIORITY_EDITOR,\n  COMMAND_PRIORITY_HIGH,\n  COMMAND_PRIORITY_LOW,\n  createCommand,\n  DRAGOVER_COMMAND,\n  DRAGSTART_COMMAND,\n  DROP_COMMAND,\n} from 'lexical';\nimport {useEffect} from 'react';\nimport getSelection from '../../nodes/shared/getDOMSelection';\n\nimport {\n  $createImageNode,\n  $isImageNode,\n  ImageNode,\n  ImagePayload,\n} from '../../nodes/ImageNode';\n\nexport type InsertImagePayload = Readonly<ImagePayload>;\n\nexport const INSERT_IMAGE_COMMAND: LexicalCommand<InsertImagePayload> =\n  createCommand();\nexport default function ImagesPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([ImageNode])) {\n      throw new Error('ImagesPlugin: ImageNode not registered on editor');\n    }\n\n    return mergeRegister(\n      editor.registerCommand<InsertImagePayload>(\n        INSERT_IMAGE_COMMAND,\n        (payload) => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            if ($isRootNode(selection.anchor.getNode())) {\n              selection.insertParagraph();\n            }\n            const imageNode = $createImageNode(payload);\n            selection.insertNodes([imageNode]);\n          }\n          return true;\n        },\n        COMMAND_PRIORITY_EDITOR,\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGSTART_COMMAND,\n        (event) => {\n          return onDragStart(event);\n        },\n        COMMAND_PRIORITY_HIGH,\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGOVER_COMMAND,\n        (event) => {\n          return onDragover(event);\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand<DragEvent>(\n        DROP_COMMAND,\n        (event) => {\n          return onDrop(event, editor);\n        },\n        COMMAND_PRIORITY_HIGH,\n      ),\n    );\n  }, [editor]);\n\n  return null;\n}\n\nconst TRANSPARENT_IMAGE =\n  'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\nconst img = document.createElement('img');\nimg.src = TRANSPARENT_IMAGE;\n\nfunction onDragStart(event: DragEvent): boolean {\n  const node = getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  const dataTransfer = event.dataTransfer;\n  if (!dataTransfer) {\n    return false;\n  }\n  dataTransfer.setData('text/plain', '_');\n  dataTransfer.setDragImage(img, 0, 0);\n  dataTransfer.setData(\n    'application/x-lexical-drag',\n    JSON.stringify({\n      data: {\n        altText: node.__altText,\n        caption: node.__caption,\n        height: node.__height,\n        key: node.getKey(),\n        maxWidth: node.__maxWidth,\n        showCaption: node.__showCaption,\n        src: node.__src,\n        width: node.__width,\n      },\n      type: 'image',\n    }),\n  );\n\n  return true;\n}\n\nfunction onDragover(event: DragEvent): boolean {\n  const node = getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  if (!canDropImage(event)) {\n    event.preventDefault();\n  }\n  return true;\n}\n\nfunction onDrop(event: DragEvent, editor: LexicalEditor): boolean {\n  const node = getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  const data = getDragImageData(event);\n  if (!data) {\n    return false;\n  }\n  event.preventDefault();\n  if (canDropImage(event)) {\n    const range = getDragSelection(event);\n    node.remove();\n    const rangeSelection = $createRangeSelection();\n    if (range !== null && range !== undefined) {\n      rangeSelection.applyDOMRange(range);\n    }\n    $setSelection(rangeSelection);\n    editor.dispatchCommand(INSERT_IMAGE_COMMAND, data);\n  }\n  return true;\n}\n\nfunction getImageNodeInSelection(): ImageNode | null {\n  const selection = $getSelection();\n  if (!$isNodeSelection(selection)) {\n    return null;\n  }\n  const nodes = selection.getNodes();\n  const node = nodes[0];\n  return $isImageNode(node) ? node : null;\n}\n\nfunction getDragImageData(event: DragEvent): null | InsertImagePayload {\n  const dragData = event.dataTransfer?.getData('application/x-lexical-drag');\n  if (!dragData) {\n    return null;\n  }\n  const {type, data} = JSON.parse(dragData);\n  if (type !== 'image') {\n    return null;\n  }\n\n  return data;\n}\n\ndeclare global {\n  interface DragEvent {\n    rangeOffset?: number;\n    rangeParent?: Node;\n  }\n}\n\nfunction canDropImage(event: DragEvent): boolean {\n  const target = event.target;\n  return !!(\n    target &&\n    target instanceof HTMLElement &&\n    !target.closest('code, span.editor-image') &&\n    target.parentElement &&\n    target.parentElement.closest('div.ContentEditable__root')\n  );\n}\n\nfunction getDragSelection(event: DragEvent): Range | null | undefined {\n  let range;\n  const domSelection = getSelection();\n  if (document.caretRangeFromPoint) {\n    range = document.caretRangeFromPoint(event.clientX, event.clientY);\n  } else if (event.rangeParent && domSelection !== null) {\n    domSelection.collapse(event.rangeParent, event.rangeOffset || 0);\n    range = domSelection.getRangeAt(0);\n  } else {\n    throw Error(`Cannot get the selection when dragging`);\n  }\n\n  return range;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $deleteTableColumn,\n  $getElementGridForTableNode,\n  $getTableCellNodeFromLexicalNode,\n  $getTableColumnIndexFromTableCellNode,\n  $getTableNodeFromLexicalNodeOrThrow,\n  $getTableRowIndexFromTableCellNode,\n  $insertTableColumn,\n  $insertTableRow,\n  $isTableCellNode,\n  $isTableRowNode,\n  $removeTableRowAtIndex,\n  getTableSelectionFromTableElement,\n  HTMLTableElementWithWithTableSelectionState,\n  TableCellHeaderStates,\n  TableCellNode,\n} from '@lexical/table';\nimport {\n  $getSelection,\n  $isGridSelection,\n  $isRangeSelection,\n  $setSelection,\n} from 'lexical';\nimport * as React from 'react';\nimport {ReactPortal, useCallback, useEffect, useRef, useState} from 'react';\nimport {createPortal} from 'react-dom';\n\ntype TableCellActionMenuProps = Readonly<{\n  contextRef: {current: null | HTMLElement};\n  onClose: () => void;\n  setIsMenuOpen: (isOpen: boolean) => void;\n  tableCellNode: TableCellNode;\n}>;\n\nfunction TableActionMenu({\n  onClose,\n  tableCellNode: _tableCellNode,\n  setIsMenuOpen,\n  contextRef,\n}: TableCellActionMenuProps) {\n  const [editor] = useLexicalComposerContext();\n  const dropDownRef = useRef<HTMLDivElement | null>(null);\n  const [tableCellNode, updateTableCellNode] = useState(_tableCellNode);\n  const [selectionCounts, updateSelectionCounts] = useState({\n    columns: 1,\n    rows: 1,\n  });\n\n  useEffect(() => {\n    return editor.registerMutationListener(TableCellNode, (nodeMutations) => {\n      const nodeUpdated =\n        nodeMutations.get(tableCellNode.getKey()) === 'updated';\n\n      if (nodeUpdated) {\n        editor.getEditorState().read(() => {\n          updateTableCellNode(tableCellNode.getLatest());\n        });\n      }\n    });\n  }, [editor, tableCellNode]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      const selection = $getSelection();\n\n      if ($isGridSelection(selection)) {\n        const selectionShape = selection.getShape();\n\n        updateSelectionCounts({\n          columns: selectionShape.toX - selectionShape.fromX + 1,\n          rows: selectionShape.toY - selectionShape.fromY + 1,\n        });\n      }\n    });\n  }, [editor]);\n\n  useEffect(() => {\n    const menuButtonElement = contextRef.current;\n    const dropDownElement = dropDownRef.current;\n\n    if (menuButtonElement != null && dropDownElement != null) {\n      const menuButtonRect = menuButtonElement.getBoundingClientRect();\n\n      dropDownElement.style.opacity = '1';\n\n      dropDownElement.style.left = `${\n        menuButtonRect.left + menuButtonRect.width + window.pageXOffset + 5\n      }px`;\n\n      dropDownElement.style.top = `${\n        menuButtonRect.top + window.pageYOffset\n      }px`;\n    }\n  }, [contextRef, dropDownRef]);\n\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (\n        dropDownRef.current != null &&\n        contextRef.current != null &&\n        !dropDownRef.current.contains(event.target as Node) &&\n        !contextRef.current.contains(event.target as Node)\n      ) {\n        setIsMenuOpen(false);\n      }\n    }\n\n    window.addEventListener('click', handleClickOutside);\n\n    return () => window.removeEventListener('click', handleClickOutside);\n  }, [setIsMenuOpen, contextRef]);\n\n  const clearTableSelection = useCallback(() => {\n    editor.update(() => {\n      if (tableCellNode.isAttached()) {\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n        const tableElement = editor.getElementByKey(\n          tableNode.getKey(),\n        ) as HTMLTableElementWithWithTableSelectionState;\n\n        if (!tableElement) {\n          throw new Error('Expected to find tableElement in DOM');\n        }\n\n        const tableSelection = getTableSelectionFromTableElement(tableElement);\n        if (tableSelection !== null) {\n          tableSelection.clearHighlight();\n        }\n\n        tableNode.markDirty();\n        updateTableCellNode(tableCellNode.getLatest());\n      }\n\n      $setSelection(null);\n    });\n  }, [editor, tableCellNode]);\n\n  const insertTableRowAtSelection = useCallback(\n    (shouldInsertAfter: boolean) => {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        let tableRowIndex;\n\n        if ($isGridSelection(selection)) {\n          const selectionShape = selection.getShape();\n          tableRowIndex = shouldInsertAfter\n            ? selectionShape.toY\n            : selectionShape.fromY;\n        } else {\n          tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n        }\n\n        const grid = $getElementGridForTableNode(editor, tableNode);\n\n        $insertTableRow(\n          tableNode,\n          tableRowIndex,\n          shouldInsertAfter,\n          selectionCounts.rows,\n          grid,\n        );\n\n        clearTableSelection();\n\n        onClose();\n      });\n    },\n    [editor, tableCellNode, selectionCounts.rows, clearTableSelection, onClose],\n  );\n\n  const insertTableColumnAtSelection = useCallback(\n    (shouldInsertAfter: boolean) => {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        let tableColumnIndex;\n\n        if ($isGridSelection(selection)) {\n          const selectionShape = selection.getShape();\n          tableColumnIndex = shouldInsertAfter\n            ? selectionShape.toX\n            : selectionShape.fromX;\n        } else {\n          tableColumnIndex =\n            $getTableColumnIndexFromTableCellNode(tableCellNode);\n        }\n\n        $insertTableColumn(\n          tableNode,\n          tableColumnIndex,\n          shouldInsertAfter,\n          selectionCounts.columns,\n        );\n\n        clearTableSelection();\n\n        onClose();\n      });\n    },\n    [\n      editor,\n      tableCellNode,\n      selectionCounts.columns,\n      clearTableSelection,\n      onClose,\n    ],\n  );\n\n  const deleteTableRowAtSelection = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n      const tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n\n      $removeTableRowAtIndex(tableNode, tableRowIndex);\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const deleteTableAtSelection = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n      tableNode.remove();\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const deleteTableColumnAtSelection = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableColumnIndex =\n        $getTableColumnIndexFromTableCellNode(tableCellNode);\n\n      $deleteTableColumn(tableNode, tableColumnIndex);\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleTableRowIsHeader = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n\n      const tableRows = tableNode.getChildren();\n\n      if (tableRowIndex >= tableRows.length || tableRowIndex < 0) {\n        throw new Error('Expected table cell to be inside of table row.');\n      }\n\n      const tableRow = tableRows[tableRowIndex];\n\n      if (!$isTableRowNode(tableRow)) {\n        throw new Error('Expected table row');\n      }\n\n      tableRow.getChildren().forEach((tableCell) => {\n        if (!$isTableCellNode(tableCell)) {\n          throw new Error('Expected table cell');\n        }\n\n        tableCell.toggleHeaderStyle(TableCellHeaderStates.ROW);\n      });\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleTableColumnIsHeader = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableColumnIndex =\n        $getTableColumnIndexFromTableCellNode(tableCellNode);\n\n      const tableRows = tableNode.getChildren();\n\n      for (let r = 0; r < tableRows.length; r++) {\n        const tableRow = tableRows[r];\n\n        if (!$isTableRowNode(tableRow)) {\n          throw new Error('Expected table row');\n        }\n\n        const tableCells = tableRow.getChildren();\n\n        if (tableColumnIndex >= tableCells.length || tableColumnIndex < 0) {\n          throw new Error('Expected table cell to be inside of table row.');\n        }\n\n        const tableCell = tableCells[tableColumnIndex];\n\n        if (!$isTableCellNode(tableCell)) {\n          throw new Error('Expected table cell');\n        }\n\n        tableCell.toggleHeaderStyle(TableCellHeaderStates.COLUMN);\n      }\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  return createPortal(\n    // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n    <div\n      className=\"dropdown\"\n      ref={dropDownRef}\n      onClick={(e) => {\n        e.stopPropagation();\n      }}>\n      <button className=\"item\" onClick={() => insertTableRowAtSelection(false)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.rows === 1 ? 'row' : `${selectionCounts.rows} rows`}{' '}\n          above\n        </span>\n      </button>\n      <button className=\"item\" onClick={() => insertTableRowAtSelection(true)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.rows === 1 ? 'row' : `${selectionCounts.rows} rows`}{' '}\n          below\n        </span>\n      </button>\n      <hr />\n      <button\n        className=\"item\"\n        onClick={() => insertTableColumnAtSelection(false)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.columns === 1\n            ? 'column'\n            : `${selectionCounts.columns} columns`}{' '}\n          left\n        </span>\n      </button>\n      <button\n        className=\"item\"\n        onClick={() => insertTableColumnAtSelection(true)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.columns === 1\n            ? 'column'\n            : `${selectionCounts.columns} columns`}{' '}\n          right\n        </span>\n      </button>\n      <hr />\n      <button className=\"item\" onClick={() => deleteTableColumnAtSelection()}>\n        <span className=\"text\">Delete column</span>\n      </button>\n      <button className=\"item\" onClick={() => deleteTableRowAtSelection()}>\n        <span className=\"text\">Delete row</span>\n      </button>\n      <button className=\"item\" onClick={() => deleteTableAtSelection()}>\n        <span className=\"text\">Delete table</span>\n      </button>\n      <hr />\n      <button className=\"item\" onClick={() => toggleTableRowIsHeader()}>\n        <span className=\"text\">\n          {(tableCellNode.__headerState & TableCellHeaderStates.ROW) ===\n          TableCellHeaderStates.ROW\n            ? 'Remove'\n            : 'Add'}{' '}\n          row header\n        </span>\n      </button>\n      <button className=\"item\" onClick={() => toggleTableColumnIsHeader()}>\n        <span className=\"text\">\n          {(tableCellNode.__headerState & TableCellHeaderStates.COLUMN) ===\n          TableCellHeaderStates.COLUMN\n            ? 'Remove'\n            : 'Add'}{' '}\n          column header\n        </span>\n      </button>\n    </div>,\n    document.body,\n  );\n}\n\nfunction TableCellActionMenuContainer(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n\n  const menuButtonRef = useRef(null);\n  const menuRootRef = useRef(null);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n\n  const [tableCellNode, setTableMenuCellNode] = useState<TableCellNode | null>(\n    null,\n  );\n\n  const moveMenu = useCallback(() => {\n    const menu = menuButtonRef.current;\n    const selection = $getSelection();\n    const nativeSelection = window.getSelection();\n    const activeElement = document.activeElement;\n\n    if (selection == null || menu == null) {\n      setTableMenuCellNode(null);\n      return;\n    }\n\n    const rootElement = editor.getRootElement();\n\n    if (\n      $isRangeSelection(selection) &&\n      rootElement !== null &&\n      nativeSelection !== null &&\n      rootElement.contains(nativeSelection.anchorNode)\n    ) {\n      const tableCellNodeFromSelection = $getTableCellNodeFromLexicalNode(\n        selection.anchor.getNode(),\n      );\n\n      if (tableCellNodeFromSelection == null) {\n        setTableMenuCellNode(null);\n        return;\n      }\n\n      const tableCellParentNodeDOM = editor.getElementByKey(\n        tableCellNodeFromSelection.getKey(),\n      );\n\n      if (tableCellParentNodeDOM == null) {\n        setTableMenuCellNode(null);\n        return;\n      }\n\n      setTableMenuCellNode(tableCellNodeFromSelection);\n    } else if (!activeElement) {\n      setTableMenuCellNode(null);\n    }\n  }, [editor]);\n\n  useEffect(() => {\n    return editor.registerUpdateListener(() => {\n      editor.getEditorState().read(() => {\n        moveMenu();\n      });\n    });\n  });\n\n  useEffect(() => {\n    const menuButtonDOM = menuButtonRef.current as HTMLButtonElement | null;\n\n    if (menuButtonDOM != null && tableCellNode != null) {\n      const tableCellNodeDOM = editor.getElementByKey(tableCellNode.getKey());\n\n      if (tableCellNodeDOM != null) {\n        const tableCellRect = tableCellNodeDOM.getBoundingClientRect();\n        const menuRect = menuButtonDOM.getBoundingClientRect();\n\n        menuButtonDOM.style.opacity = '1';\n\n        menuButtonDOM.style.left = `${\n          tableCellRect.left +\n          window.pageXOffset -\n          menuRect.width +\n          tableCellRect.width -\n          10\n        }px`;\n\n        menuButtonDOM.style.top = `${\n          tableCellRect.top + window.pageYOffset + 5\n        }px`;\n      } else {\n        menuButtonDOM.style.opacity = '0';\n      }\n    }\n  }, [menuButtonRef, tableCellNode, editor]);\n\n  const prevTableCellDOM = useRef(tableCellNode);\n\n  useEffect(() => {\n    if (prevTableCellDOM.current !== tableCellNode) {\n      setIsMenuOpen(false);\n    }\n\n    prevTableCellDOM.current = tableCellNode;\n  }, [prevTableCellDOM, tableCellNode]);\n\n  return (\n    <div className=\"table-cell-action-button-container\" ref={menuButtonRef}>\n      {tableCellNode != null && (\n        <>\n          <button\n            className=\"table-cell-action-button chevron-down\"\n            onClick={(e) => {\n              e.stopPropagation();\n              setIsMenuOpen(!isMenuOpen);\n            }}\n            ref={menuRootRef}>\n            <i className=\"chevron-down\" />\n          </button>\n          {isMenuOpen && (\n            <TableActionMenu\n              contextRef={menuRootRef}\n              setIsMenuOpen={setIsMenuOpen}\n              onClose={() => setIsMenuOpen(false)}\n              tableCellNode={tableCellNode}\n            />\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default function TableActionMenuPlugin(): ReactPortal {\n  return createPortal(<TableCellActionMenuContainer />, document.body);\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {TreeView} from '@lexical/react/LexicalTreeView';\nimport * as React from 'react';\n\nexport default function TreeViewPlugin(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  return (\n    <TreeView\n      viewClassName=\"tree-view-output\"\n      timeTravelPanelClassName=\"debug-timetravel-panel\"\n      timeTravelButtonClassName=\"debug-timetravel-button\"\n      timeTravelPanelSliderClassName=\"debug-timetravel-panel-slider\"\n      timeTravelPanelButtonClassName=\"debug-timetravel-panel-button\"\n      editor={editor}\n    />\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './ContentEditable.css';\n\nimport {ContentEditable} from '@lexical/react/LexicalContentEditable';\nimport * as React from 'react';\n\nexport default function LexicalContentEditable({\n  className,\n}: {\n  className?: string;\n}): JSX.Element {\n  return <ContentEditable className={className || 'ContentEditable__root'} />;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalEditor} from 'lexical';\n\nimport * as React from 'react';\nimport {useRef} from 'react';\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max);\n}\n\nconst Direction = {\n  east: 1 << 0,\n  north: 1 << 3,\n  south: 1 << 1,\n  west: 1 << 2,\n};\n\nexport default function ImageResizer({\n  onResizeStart,\n  onResizeEnd,\n  imageRef,\n  maxWidth,\n  editor,\n  showCaption,\n  setShowCaption,\n}: {\n  editor: LexicalEditor;\n  imageRef: {current: null | HTMLElement};\n  maxWidth?: number;\n  onResizeEnd: (width: 'inherit' | number, height: 'inherit' | number) => void;\n  onResizeStart: () => void;\n  setShowCaption: (show: boolean) => void;\n  showCaption: boolean;\n}): JSX.Element {\n  const buttonRef = useRef(null);\n  const controlWrapperRef = useRef<HTMLDivElement>(null);\n  const userSelect = useRef({\n    priority: '',\n    value: 'default',\n  });\n  const positioningRef = useRef<{\n    currentHeight: 'inherit' | number;\n    currentWidth: 'inherit' | number;\n    direction: number;\n    isResizing: boolean;\n    ratio: number;\n    startHeight: number;\n    startWidth: number;\n    startX: number;\n    startY: number;\n  }>({\n    currentHeight: 0,\n    currentWidth: 0,\n    direction: 0,\n    isResizing: false,\n    ratio: 0,\n    startHeight: 0,\n    startWidth: 0,\n    startX: 0,\n    startY: 0,\n  });\n  const editorRootElement = editor.getRootElement();\n  // Find max width, accounting for editor padding.\n  const maxWidthContainer = maxWidth\n    ? maxWidth\n    : editorRootElement !== null\n    ? editorRootElement.getBoundingClientRect().width - 20\n    : 100;\n  const maxHeightContainer =\n    editorRootElement !== null\n      ? editorRootElement.getBoundingClientRect().height - 20\n      : 100;\n\n  const minWidth = 100;\n  const minHeight = 100;\n\n  const setStartCursor = (direction: number) => {\n    const ew = direction === Direction.east || direction === Direction.west;\n    const ns = direction === Direction.north || direction === Direction.south;\n    const nwse =\n      (direction & Direction.north && direction & Direction.west) ||\n      (direction & Direction.south && direction & Direction.east);\n\n    const cursorDir = ew ? 'ew' : ns ? 'ns' : nwse ? 'nwse' : 'nesw';\n\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important',\n      );\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important',\n      );\n      userSelect.current.value = document.body.style.getPropertyValue(\n        '-webkit-user-select',\n      );\n      userSelect.current.priority = document.body.style.getPropertyPriority(\n        '-webkit-user-select',\n      );\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        `none`,\n        'important',\n      );\n    }\n  };\n\n  const setEndCursor = () => {\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty('cursor', 'default');\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty('cursor', 'default');\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        userSelect.current.value,\n        userSelect.current.priority,\n      );\n    }\n  };\n\n  const handlePointerDown = (\n    event: React.PointerEvent<HTMLDivElement>,\n    direction: number,\n  ) => {\n    const image = imageRef.current;\n    const controlWrapper = controlWrapperRef.current;\n\n    if (image !== null && controlWrapper !== null) {\n      const {width, height} = image.getBoundingClientRect();\n      const positioning = positioningRef.current;\n      positioning.startWidth = width;\n      positioning.startHeight = height;\n      positioning.ratio = width / height;\n      positioning.currentWidth = width;\n      positioning.currentHeight = height;\n      positioning.startX = event.clientX;\n      positioning.startY = event.clientY;\n      positioning.isResizing = true;\n      positioning.direction = direction;\n\n      setStartCursor(direction);\n      onResizeStart();\n\n      controlWrapper.classList.add('image-control-wrapper--resizing');\n      image.style.height = `${height}px`;\n      image.style.width = `${width}px`;\n\n      document.addEventListener('pointermove', handlePointerMove);\n      document.addEventListener('pointerup', handlePointerUp);\n    }\n  };\n  const handlePointerMove = (event: PointerEvent) => {\n    const image = imageRef.current;\n    const positioning = positioningRef.current;\n\n    const isHorizontal =\n      positioning.direction & (Direction.east | Direction.west);\n    const isVertical =\n      positioning.direction & (Direction.south | Direction.north);\n\n    if (image !== null && positioning.isResizing) {\n      // Corner cursor\n      if (isHorizontal && isVertical) {\n        let diff = Math.floor(positioning.startX - event.clientX);\n        diff = positioning.direction & Direction.east ? -diff : diff;\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer,\n        );\n\n        const height = width / positioning.ratio;\n        image.style.width = `${width}px`;\n        image.style.height = `${height}px`;\n        positioning.currentHeight = height;\n        positioning.currentWidth = width;\n      } else if (isVertical) {\n        let diff = Math.floor(positioning.startY - event.clientY);\n        diff = positioning.direction & Direction.south ? -diff : diff;\n\n        const height = clamp(\n          positioning.startHeight + diff,\n          minHeight,\n          maxHeightContainer,\n        );\n\n        image.style.height = `${height}px`;\n        positioning.currentHeight = height;\n      } else {\n        let diff = Math.floor(positioning.startX - event.clientX);\n        diff = positioning.direction & Direction.east ? -diff : diff;\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer,\n        );\n\n        image.style.width = `${width}px`;\n        positioning.currentWidth = width;\n      }\n    }\n  };\n  const handlePointerUp = () => {\n    const image = imageRef.current;\n    const positioning = positioningRef.current;\n    const controlWrapper = controlWrapperRef.current;\n    if (image !== null && controlWrapper !== null && positioning.isResizing) {\n      const width = positioning.currentWidth;\n      const height = positioning.currentHeight;\n      positioning.startWidth = 0;\n      positioning.startHeight = 0;\n      positioning.ratio = 0;\n      positioning.startX = 0;\n      positioning.startY = 0;\n      positioning.currentWidth = 0;\n      positioning.currentHeight = 0;\n      positioning.isResizing = false;\n\n      controlWrapper.classList.remove('image-control-wrapper--resizing');\n\n      setEndCursor();\n      onResizeEnd(width, height);\n\n      document.removeEventListener('pointermove', handlePointerMove);\n      document.removeEventListener('pointerup', handlePointerUp);\n    }\n  };\n  return (\n    <div ref={controlWrapperRef}>\n      {!showCaption && (\n        <button\n          className=\"image-caption-button\"\n          ref={buttonRef}\n          onClick={() => {\n            setShowCaption(!showCaption);\n          }}>\n          Add Caption\n        </button>\n      )}\n      <div\n        className=\"image-resizer image-resizer-n\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-ne\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.east);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-e\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.east);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-se\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.east);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-s\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-sw\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.west);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-w\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.west);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-nw\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.west);\n        }}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './Placeholder.css';\n\nimport * as React from 'react';\nimport {ReactNode} from 'react';\n\nexport default function Placeholder({\n  children,\n  className,\n}: {\n  children: ReactNode;\n  className?: string;\n}): JSX.Element {\n  return <div className={className || 'Placeholder__root'}>{children}</div>;\n}\n","import type {\n  DOMConversionMap,\n  DOMConversionOutput,\n  DOMExportOutput,\n  EditorConfig,\n  GridSelection,\n  LexicalEditor,\n  LexicalNode,\n  NodeKey,\n  NodeSelection,\n  RangeSelection,\n  SerializedEditor,\n  SerializedLexicalNode,\n  Spread,\n} from 'lexical';\n\nimport './ImageNode.css';\n\nimport {\n  useCollaborationContext,\n} from '@lexical/react/LexicalCollaborationPlugin';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {HistoryPlugin} from '@lexical/react/LexicalHistoryPlugin';\nimport {LinkPlugin} from '@lexical/react/LexicalLinkPlugin';\nimport {LexicalNestedComposer} from '@lexical/react/LexicalNestedComposer';\nimport {RichTextPlugin} from '@lexical/react/LexicalRichTextPlugin';\nimport {TablePlugin} from '@lexical/react/LexicalTablePlugin';\nimport {useLexicalNodeSelection} from '@lexical/react/useLexicalNodeSelection';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getNodeByKey,\n  $getSelection,\n  $isNodeSelection,\n  CLICK_COMMAND,\n  COMMAND_PRIORITY_LOW,\n  createEditor,\n  DecoratorNode,\n  KEY_BACKSPACE_COMMAND,\n  KEY_DELETE_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {Suspense, useCallback, useEffect, useRef, useState} from 'react';\nimport {useSettings} from '../context/SettingsContext';\nimport {useSharedHistoryContext} from '../context/SharedHistoryContext';\nimport ImagesPlugin from '../plugins/ImagesPlugin';\nimport TableCellActionMenuPlugin from '../plugins/TableActionMenuPlugin';\nimport TreeViewPlugin from '../plugins/TreeViewPlugin';\nimport ContentEditable from '../ui/ContentEditable';\nimport ImageResizer from '../ui/ImageResizer';\nimport Placeholder from '../ui/Placeholder';\n\nexport interface ImagePayload {\n  altText: string;\n  caption?: LexicalEditor;\n  height?: number;\n  key?: NodeKey;\n  maxWidth?: number;\n  showCaption?: boolean;\n  src: string;\n  width?: number;\n}\n\nconst imageCache = new Set();\n\nfunction useSuspenseImage(src: string) {\n  if (!imageCache.has(src)) {\n    throw new Promise((resolve) => {\n      const img = new Image();\n      img.src = src;\n      img.onload = () => {\n        imageCache.add(src);\n        resolve(null);\n      };\n    });\n  }\n}\n\nfunction convertImageElement(domNode: Node): null | DOMConversionOutput {\n  if (domNode instanceof HTMLImageElement) {\n    const {alt: altText, src} = domNode;\n    const node = $createImageNode({altText, src});\n    return {node};\n  }\n  return null;\n}\n\nfunction LazyImage({\n  altText,\n  className,\n  imageRef,\n  src,\n  width,\n  height,\n  maxWidth,\n}: {\n  altText: string;\n  className: string | null;\n  height: 'inherit' | number;\n  imageRef: {current: null | HTMLImageElement};\n  maxWidth: number;\n  src: string;\n  width: 'inherit' | number;\n}): JSX.Element {\n  useSuspenseImage(src);\n  return (\n    <img\n      className={className || undefined}\n      src={src}\n      alt={altText}\n      ref={imageRef}\n      style={{\n        height,\n        maxWidth,\n        width,\n      }}\n      draggable=\"false\"\n    />\n  );\n}\n\nfunction ImageComponent({\n  src,\n  altText,\n  nodeKey,\n  width,\n  height,\n  maxWidth,\n  resizable,\n  showCaption,\n  caption,\n}: {\n  altText: string;\n  caption: LexicalEditor;\n  height: 'inherit' | number;\n  maxWidth: number;\n  nodeKey: NodeKey;\n  resizable: boolean;\n  showCaption: boolean;\n  src: string;\n  width: 'inherit' | number;\n}): JSX.Element {\n  const ref = useRef(null);\n  const [isSelected, setSelected, clearSelection] =\n    useLexicalNodeSelection(nodeKey);\n  const [isResizing, setIsResizing] = useState<boolean>(false);\n  const {yjsDocMap} = useCollaborationContext();\n  const [editor] = useLexicalComposerContext();\n  const isCollab = yjsDocMap.get('main') !== undefined;\n  const [selection, setSelection] = useState<\n    RangeSelection | NodeSelection | GridSelection | null\n  >(null);\n\n  const onDelete = useCallback(\n    (payload: KeyboardEvent) => {\n      if (isSelected && $isNodeSelection($getSelection())) {\n        const event: KeyboardEvent = payload;\n        event.preventDefault();\n        const node = $getNodeByKey(nodeKey);\n        if ($isImageNode(node)) {\n          node.remove();\n        }\n        setSelected(false);\n      }\n      return false;\n    },\n    [isSelected, nodeKey, setSelected],\n  );\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerUpdateListener(({editorState}) => {\n        setSelection(editorState.read(() => $getSelection()));\n      }),\n      editor.registerCommand<MouseEvent>(\n        CLICK_COMMAND,\n        (payload) => {\n          const event = payload;\n\n          if (isResizing) {\n            return true;\n          }\n          if (event.target === ref.current) {\n            if (!event.shiftKey) {\n              clearSelection();\n            }\n            setSelected(!isSelected);\n            return true;\n          }\n\n          return false;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_DELETE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_BACKSPACE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [\n    clearSelection,\n    editor,\n    isResizing,\n    isSelected,\n    nodeKey,\n    onDelete,\n    setSelected,\n  ]);\n\n  const setShowCaption = () => {\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isImageNode(node)) {\n        node.setShowCaption(true);\n      }\n    });\n  };\n\n  const onResizeEnd = (\n    nextWidth: 'inherit' | number,\n    nextHeight: 'inherit' | number,\n  ) => {\n    // Delay hiding the resize bars for click case\n    setTimeout(() => {\n      setIsResizing(false);\n    }, 200);\n\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isImageNode(node)) {\n        node.setWidthAndHeight(nextWidth, nextHeight);\n      }\n    });\n  };\n\n  const onResizeStart = () => {\n    setIsResizing(true);\n  };\n\n  const {historyState} = useSharedHistoryContext();\n  const {\n    settings: {showNestedEditorTreeView},\n  } = useSettings();\n\n  const draggable = isSelected && $isNodeSelection(selection);\n  const isFocused = $isNodeSelection(selection) && (isSelected || isResizing);\n\n  return (\n    <Suspense fallback={null}>\n      <>\n        <div draggable={draggable}>\n          <LazyImage\n            className={isFocused ? 'focused' : null}\n            src={src}\n            altText={altText}\n            imageRef={ref}\n            width={width}\n            height={height}\n            maxWidth={maxWidth}\n          />\n        </div>\n        {showCaption && (\n          <div className=\"image-caption-container\">\n            <LexicalNestedComposer initialEditor={caption}>\n              <TablePlugin />\n              <TableCellActionMenuPlugin />\n              <ImagesPlugin />\n              <LinkPlugin />\n                <HistoryPlugin externalHistoryState={historyState} />\n              <RichTextPlugin\n                contentEditable={\n                  <ContentEditable className=\"ImageNode__contentEditable\" />\n                }\n                placeholder={\n                  <Placeholder className=\"ImageNode__placeholder\">\n                    Enter a caption...\n                  </Placeholder>\n                }\n\n                initialEditorState={null}\n              />\n              {showNestedEditorTreeView === true ? <TreeViewPlugin /> : null}\n            </LexicalNestedComposer>\n          </div>\n        )}\n        {resizable && isFocused && (\n          <ImageResizer\n            showCaption={showCaption}\n            setShowCaption={setShowCaption}\n            editor={editor}\n            imageRef={ref}\n            maxWidth={maxWidth}\n            onResizeStart={onResizeStart}\n            onResizeEnd={onResizeEnd}\n          />\n        )}\n      </>\n    </Suspense>\n  );\n}\n\nexport type SerializedImageNode = Spread<\n  {\n    altText: string;\n    caption: SerializedEditor;\n    height?: number;\n    maxWidth: number;\n    showCaption: boolean;\n    src: string;\n    width?: number;\n    type: 'image';\n    version: 1;\n  },\n  SerializedLexicalNode\n>;\n\nexport class ImageNode extends DecoratorNode<JSX.Element> {\n  __src: string;\n  __altText: string;\n  __width: 'inherit' | number;\n  __height: 'inherit' | number;\n  __maxWidth: number;\n  __showCaption: boolean;\n  __caption: LexicalEditor;\n\n  static getType(): string {\n    return 'image';\n  }\n\n  static clone(node: ImageNode): ImageNode {\n    return new ImageNode(\n      node.__src,\n      node.__altText,\n      node.__maxWidth,\n      node.__width,\n      node.__height,\n      node.__showCaption,\n      node.__caption,\n      node.__key,\n    );\n  }\n\n  static importJSON(serializedNode: SerializedImageNode): ImageNode {\n    const {altText, height, width, maxWidth, caption, src, showCaption} =\n      serializedNode;\n    const node = $createImageNode({\n      altText,\n      height,\n      maxWidth,\n      showCaption,\n      src,\n      width,\n    });\n    const nestedEditor = node.__caption;\n    const editorState = nestedEditor.parseEditorState(caption.editorState);\n    if (!editorState.isEmpty()) {\n      nestedEditor.setEditorState(editorState);\n    }\n    return node;\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement('img');\n    element.setAttribute('src', this.__src);\n    element.setAttribute('alt', this.__altText);\n    return {element};\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      img: (node: Node) => ({\n        conversion: convertImageElement,\n        priority: 0,\n      }),\n    };\n  }\n\n  constructor(\n    src: string,\n    altText: string,\n    maxWidth: number,\n    width?: 'inherit' | number,\n    height?: 'inherit' | number,\n    showCaption?: boolean,\n    caption?: LexicalEditor,\n    key?: NodeKey,\n  ) {\n    super(key);\n    this.__src = src;\n    this.__altText = altText;\n    this.__maxWidth = maxWidth;\n    this.__width = width || 'inherit';\n    this.__height = height || 'inherit';\n    this.__showCaption = showCaption || false;\n    this.__caption = caption || createEditor();\n  }\n\n  exportJSON(): SerializedImageNode {\n    return {\n      altText: this.getAltText(),\n      caption: this.__caption.toJSON(),\n      height: this.__height === 'inherit' ? 0 : this.__height,\n      maxWidth: this.__maxWidth,\n      showCaption: this.__showCaption,\n      src: this.getSrc(),\n      type: 'image',\n      version: 1,\n      width: this.__width === 'inherit' ? 0 : this.__width,\n    };\n  }\n\n  setWidthAndHeight(\n    width: 'inherit' | number,\n    height: 'inherit' | number,\n  ): void {\n    const writable = this.getWritable();\n    writable.__width = width;\n    writable.__height = height;\n  }\n\n  setShowCaption(showCaption: boolean): void {\n    const writable = this.getWritable();\n    writable.__showCaption = showCaption;\n  }\n\n  // View\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const span = document.createElement('span');\n    const theme = config.theme;\n    const className = theme.image;\n    if (className !== undefined) {\n      span.className = className;\n    }\n    return span;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  getSrc(): string {\n    return this.__src;\n  }\n\n  getAltText(): string {\n    return this.__altText;\n  }\n\n  decorate(): JSX.Element {\n    return (\n      <ImageComponent\n        src={this.__src}\n        altText={this.__altText}\n        width={this.__width}\n        height={this.__height}\n        maxWidth={this.__maxWidth}\n        nodeKey={this.getKey()}\n        showCaption={this.__showCaption}\n        caption={this.__caption}\n        resizable={true}\n      />\n    );\n  }\n}\n\nexport function $createImageNode({\n  altText,\n  height,\n  maxWidth = 500,\n  src,\n  width,\n  showCaption,\n  caption,\n  key,\n}: ImagePayload): ImageNode {\n  return new ImageNode(\n    src,\n    altText,\n    maxWidth,\n    width,\n    height,\n    showCaption,\n    caption,\n    key,\n  );\n}\n\nexport function $isImageNode(\n  node: LexicalNode | null | undefined,\n): node is ImageNode {\n  return node instanceof ImageNode;\n}\n","import type {\n  ElementTransformer,\n  TextMatchTransformer,\n  Transformer,\n} from '@lexical/markdown';\nimport type {ElementNode, LexicalNode} from 'lexical';\n\nimport {\n  CHECK_LIST,\n  ELEMENT_TRANSFORMERS,\n  TEXT_FORMAT_TRANSFORMERS,\n  TEXT_MATCH_TRANSFORMERS,\n} from '@lexical/markdown';\nimport {\n  $createHorizontalRuleNode,\n  $isHorizontalRuleNode,\n} from '@lexical/react/LexicalHorizontalRuleNode';\nimport {\n  $createTableCellNode,\n  $createTableNode,\n  $createTableRowNode,\n  $isTableNode,\n  $isTableRowNode,\n  TableCellHeaderStates,\n  TableCellNode,\n  TableNode,\n} from '@lexical/table';\nimport {\n  $createParagraphNode,\n  $createTextNode,\n  $isElementNode,\n  $isParagraphNode,\n  $isTextNode,\n} from 'lexical';\n\nimport {$createEquationNode, $isEquationNode} from '../../nodes/EquationNode';\nimport {$createImageNode, $isImageNode} from '../../nodes/ImageNode';\n\nexport const HR: ElementTransformer = {\n  export: (node: LexicalNode) => {\n    return $isHorizontalRuleNode(node) ? '***' : null;\n  },\n  regExp: /^(---|\\*\\*\\*|___)\\s?$/,\n  replace: (parentNode, _1, _2, isImport) => {\n    const line = $createHorizontalRuleNode();\n\n    // TODO: Get rid of isImport flag\n    if (isImport || parentNode.getNextSibling() != null) {\n      parentNode.replace(line);\n    } else {\n      parentNode.insertBefore(line);\n    }\n\n    line.selectNext();\n  },\n  type: 'element',\n};\n\nexport const IMAGE: TextMatchTransformer = {\n  export: (node, exportChildren, exportFormat) => {\n    if (!$isImageNode(node)) {\n      return null;\n    }\n\n    return `![${node.getAltText()}](${node.getSrc()})`;\n  },\n  importRegExp: /!(?:\\[([^[]*)\\])(?:\\(([^(]+)\\))/,\n  regExp: /!(?:\\[([^[]*)\\])(?:\\(([^(]+)\\))$/,\n  replace: (textNode, match) => {\n    const [, altText, src] = match;\n    const imageNode = $createImageNode({\n      altText,\n      maxWidth: 800,\n      src,\n    });\n    textNode.replace(imageNode);\n  },\n  trigger: ')',\n  type: 'text-match',\n};\n\nexport const EQUATION: TextMatchTransformer = {\n  export: (node, exportChildren, exportFormat) => {\n    if (!$isEquationNode(node)) {\n      return null;\n    }\n\n    return `$${node.getEquation()}$`;\n  },\n  importRegExp: /\\$([^$].+?)\\$/,\n  regExp: /\\$([^$].+?)\\$$/,\n  replace: (textNode, match) => {\n    const [, equation] = match;\n    const equationNode = $createEquationNode(equation, true);\n    textNode.replace(equationNode);\n  },\n  trigger: '$',\n  type: 'text-match',\n};\n\n// Very primitive table setup\nconst TABLE_ROW_REG_EXP = /^(?:\\|)(.+)(?:\\|)\\s?$/;\n\nexport const TABLE: ElementTransformer = {\n  export: (\n    node: LexicalNode,\n    exportChildren: (elementNode: ElementNode) => string,\n  ) => {\n    if (!$isTableNode(node)) {\n      return null;\n    }\n\n    const output = [];\n\n    for (const row of node.getChildren()) {\n      const rowOutput = [];\n\n      if ($isTableRowNode(row)) {\n        for (const cell of row.getChildren()) {\n          // It's TableCellNode (hence ElementNode) so it's just to make flow happy\n          if ($isElementNode(cell)) {\n            rowOutput.push(exportChildren(cell));\n          }\n        }\n      }\n\n      output.push(`| ${rowOutput.join(' | ')} |`);\n    }\n\n    return output.join('\\n');\n  },\n  regExp: TABLE_ROW_REG_EXP,\n  replace: (parentNode, _1, match) => {\n    const matchCells = mapToTableCells(match[0]);\n\n    if (matchCells == null) {\n      return;\n    }\n\n    const rows = [matchCells];\n    let sibling = parentNode.getPreviousSibling();\n    let maxCells = matchCells.length;\n\n    while (sibling) {\n      if (!$isParagraphNode(sibling)) {\n        break;\n      }\n\n      if (sibling.getChildrenSize() !== 1) {\n        break;\n      }\n\n      const firstChild = sibling.getFirstChild();\n\n      if (!$isTextNode(firstChild)) {\n        break;\n      }\n\n      const cells = mapToTableCells(firstChild.getTextContent());\n\n      if (cells == null) {\n        break;\n      }\n\n      maxCells = Math.max(maxCells, cells.length);\n      rows.unshift(cells);\n      const previousSibling = sibling.getPreviousSibling();\n      sibling.remove();\n      sibling = previousSibling;\n    }\n\n    const table = $createTableNode();\n\n    for (const cells of rows) {\n      const tableRow = $createTableRowNode();\n      table.append(tableRow);\n\n      for (let i = 0; i < maxCells; i++) {\n        tableRow.append(i < cells.length ? cells[i] : createTableCell(null));\n      }\n    }\n\n    const previousSibling = parentNode.getPreviousSibling();\n    if (\n      $isTableNode(previousSibling) &&\n      getTableColumnsSize(previousSibling) === maxCells\n    ) {\n      previousSibling.append(...table.getChildren());\n      parentNode.remove();\n    } else {\n      parentNode.replace(table);\n    }\n\n    table.selectEnd();\n  },\n  type: 'element',\n};\n\nfunction getTableColumnsSize(table: TableNode) {\n  const row = table.getFirstChild();\n  return $isTableRowNode(row) ? row.getChildrenSize() : 0;\n}\n\nconst createTableCell = (\n  textContent: string | null | undefined,\n): TableCellNode => {\n  const cell = $createTableCellNode(TableCellHeaderStates.NO_STATUS);\n  const paragraph = $createParagraphNode();\n\n  if (textContent != null) {\n    paragraph.append($createTextNode(textContent.trim()));\n  }\n\n  cell.append(paragraph);\n  return cell;\n};\n\nconst mapToTableCells = (textContent: string): Array<TableCellNode> | null => {\n  // TODO:\n  // For now plain text, single node. Can be expanded to more complex content\n  // including formatted text\n  const match = textContent.match(TABLE_ROW_REG_EXP);\n\n  if (!match || !match[1]) {\n    return null;\n  }\n\n  return match[1].split('|').map((text) => createTableCell(text));\n};\n\nexport const PLAYGROUND_TRANSFORMERS: Array<Transformer> = [\n  TABLE,\n  HR,\n  IMAGE,\n  EQUATION,\n  CHECK_LIST,\n  ...ELEMENT_TRANSFORMERS,\n  ...TEXT_FORMAT_TRANSFORMERS,\n  ...TEXT_MATCH_TRANSFORMERS,\n];\n","import type { LexicalEditor } from 'lexical';\n\nimport { $createCodeNode, $isCodeNode } from '@lexical/code';\nimport { exportFile, importFile } from '@lexical/file';\nimport {\n  $convertFromMarkdownString,\n  $convertToMarkdownString,\n} from '@lexical/markdown';\nimport { useCollaborationContext } from '@lexical/react/LexicalCollaborationPlugin';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { mergeRegister } from '@lexical/utils';\nimport { CONNECTED_COMMAND, TOGGLE_CONNECT_COMMAND } from '@lexical/yjs';\nimport {\n  $createTextNode,\n  $getRoot,\n  $isParagraphNode,\n  CLEAR_EDITOR_COMMAND,\n  COMMAND_PRIORITY_EDITOR,\n} from 'lexical';\nimport * as React from 'react';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport useModal from '../../hooks/useModal';\nimport Button from '../../ui/Button';\nimport { PLAYGROUND_TRANSFORMERS } from '../MarkdownTransformers';\n\nexport default function ActionsPlugin({\n  isRichText,\n}: {\n  isRichText: boolean;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [isReadOnly, setIsReadOnly] = useState(() => editor.isReadOnly());\n  const [connected, setConnected] = useState(false);\n  const [isEditorEmpty, setIsEditorEmpty] = useState(true);\n  const [modal, showModal] = useModal();\n  const { yjsDocMap } = useCollaborationContext();\n  const isCollab = yjsDocMap.get('main') !== undefined;\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerReadOnlyListener((readOnly) => {\n        setIsReadOnly(readOnly);\n      }),\n      editor.registerCommand<boolean>(\n        CONNECTED_COMMAND,\n        (payload) => {\n          const isConnected = payload;\n          setConnected(isConnected);\n          return false;\n        },\n        COMMAND_PRIORITY_EDITOR,\n      ),\n    );\n  }, [editor]);\n\n  useEffect(() => {\n    return editor.registerUpdateListener(() => {\n      editor.getEditorState().read(() => {\n        const root = $getRoot();\n        const children = root.getChildren();\n\n        if (children.length > 1) {\n          setIsEditorEmpty(false);\n        } else {\n          if ($isParagraphNode(children[0])) {\n            const paragraphChildren = children[0].getChildren();\n            setIsEditorEmpty(paragraphChildren.length === 0);\n          } else {\n            setIsEditorEmpty(false);\n          }\n        }\n      });\n    });\n  }, [editor]);\n\n  const handleMarkdownToggle = useCallback(() => {\n    editor.update(() => {\n      const root = $getRoot();\n      const firstChild = root.getFirstChild();\n      if ($isCodeNode(firstChild) && firstChild.getLanguage() === 'markdown') {\n        $convertFromMarkdownString(\n          firstChild.getTextContent(),\n          PLAYGROUND_TRANSFORMERS,\n        );\n      } else {\n        const markdown = $convertToMarkdownString(PLAYGROUND_TRANSFORMERS);\n        root\n          .clear()\n          .append(\n            $createCodeNode('markdown').append($createTextNode(markdown)),\n          );\n      }\n      root.selectEnd();\n    });\n  }, [editor]);\n\n  return (\n    <div className=\"actions\">\n      <button\n        className=\"action-button import\"\n        onClick={() => importFile(editor)}\n        title=\"Import\"\n        aria-label=\"Import editor state from JSON\">\n        <i className=\"import\" />\n      </button>\n      <button\n        className=\"action-button export\"\n        onClick={() =>\n          exportFile(editor, {\n            fileName: `Playground ${new Date().toISOString()}`,\n            source: 'Playground',\n          })\n        }\n        title=\"Export\"\n        aria-label=\"Export editor state to JSON\">\n        <i className=\"export\" />\n      </button>\n      <button\n        className=\"action-button clear\"\n        disabled={isEditorEmpty}\n        onClick={() => {\n          showModal('Clear editor', (onClose) => (\n            <ShowClearDialog editor={editor} onClose={onClose} />\n          ));\n        }}\n        title=\"Clear\"\n        aria-label=\"Clear editor contents\">\n        <i className=\"clear\" />\n      </button>\n      <button\n        className={`action-button ${isReadOnly ? 'unlock' : 'lock'}`}\n        onClick={() => {\n          editor.setReadOnly(!editor.isReadOnly());\n        }}\n        title=\"Read-Only Mode\"\n        aria-label={`${isReadOnly ? 'Unlock' : 'Lock'} read-only mode`}>\n        <i className={isReadOnly ? 'unlock' : 'lock'} />\n      </button>\n      {modal}\n    </div>\n  );\n}\n\nfunction ShowClearDialog({\n  editor,\n  onClose,\n}: {\n  editor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  return (\n    <>\n      Are you sure you want to clear the editor?\n      <div className=\"Modal__content\">\n        <Button\n          onClick={() => {\n            editor.dispatchCommand(CLEAR_EDITOR_COMMAND, undefined);\n            editor.focus();\n            onClose();\n          }}>\n          Clear\n        </Button>{' '}\n        <Button\n          onClick={() => {\n            editor.focus();\n            onClose();\n          }}>\n          Cancel\n        </Button>\n      </div>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {AutoLinkPlugin} from '@lexical/react/LexicalAutoLinkPlugin';\nimport * as React from 'react';\n\nconst URL_MATCHER =\n  /((https?:\\/\\/(www\\.)?)|(www\\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;\n\nconst EMAIL_MATCHER =\n  /(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/;\n\nconst MATCHERS = [\n  (text: string) => {\n    const match = URL_MATCHER.exec(text);\n    if (match === null) {\n      return null;\n    }\n    const fullMatch = match[0];\n    return {\n      index: match.index,\n      length: fullMatch.length,\n      text: fullMatch,\n      url: fullMatch.startsWith('http') ? fullMatch : `https://${fullMatch}`,\n    };\n  },\n  (text: string) => {\n    const match = EMAIL_MATCHER.exec(text);\n    return (\n      match && {\n        index: match.index,\n        length: match[0].length,\n        text: match[0],\n        url: `mailto:${match[0]}`,\n      }\n    );\n  },\n];\n\nexport default function LexicalAutoLinkPlugin(): JSX.Element {\n  return <AutoLinkPlugin matchers={MATCHERS} />;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LinkNode} from '@lexical/link';\nimport type {LexicalEditor} from 'lexical';\n\nimport {$isLinkNode} from '@lexical/link';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getNearestNodeFromDOMNode,\n  $getSelection,\n  $isRangeSelection,\n} from 'lexical';\nimport {useEffect} from 'react';\n\ntype LinkFilter = (event: MouseEvent, linkNode: LinkNode) => boolean;\n\nexport default function ClickableLinkPlugin({\n  filter,\n  newTab = true,\n}: {\n  filter?: LinkFilter;\n  newTab?: boolean;\n}): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    function onClick(e: Event) {\n      const event = e as MouseEvent;\n      const linkDomNode = getLinkDomNode(event, editor);\n\n      if (linkDomNode === null) {\n        return;\n      }\n\n      const href = linkDomNode.getAttribute('href');\n\n      if (\n        linkDomNode.getAttribute('contenteditable') === 'false' ||\n        href === undefined\n      ) {\n        return;\n      }\n\n      // Allow user to select link text without following url\n      const selection = editor.getEditorState().read($getSelection);\n      if ($isRangeSelection(selection) && !selection.isCollapsed()) {\n        return;\n      }\n\n      let linkNode = null;\n      editor.update(() => {\n        const maybeLinkNode = $getNearestNodeFromDOMNode(linkDomNode);\n\n        if ($isLinkNode(maybeLinkNode)) {\n          linkNode = maybeLinkNode;\n        }\n      });\n\n      if (\n        linkNode === null ||\n        (filter !== undefined && !filter(event, linkNode))\n      ) {\n        return;\n      }\n\n      try {\n        if (href !== null) {\n          window.open(\n            href,\n            newTab || event.metaKey || event.ctrlKey ? '_blank' : '_self',\n          );\n        }\n      } catch {\n        // It didn't work, which is better than throwing an exception!\n      }\n    }\n\n    return editor.registerRootListener(\n      (\n        rootElement: null | HTMLElement,\n        prevRootElement: null | HTMLElement,\n      ) => {\n        if (prevRootElement !== null) {\n          prevRootElement.removeEventListener('click', onClick);\n        }\n\n        if (rootElement !== null) {\n          rootElement.addEventListener('click', onClick);\n        }\n      },\n    );\n  }, [editor, filter, newTab]);\n  return null;\n}\n\nfunction isLinkDomNode(domNode: Node): boolean {\n  return domNode.nodeName.toLowerCase() === 'a';\n}\n\nfunction getLinkDomNode(\n  event: MouseEvent,\n  editor: LexicalEditor,\n): HTMLAnchorElement | null {\n  return editor.getEditorState().read(() => {\n    const domNode = event.target as Node;\n\n    if (isLinkDomNode(domNode)) {\n      return domNode as HTMLAnchorElement;\n    }\n\n    if (domNode.parentNode && isLinkDomNode(domNode.parentNode)) {\n      return domNode.parentNode as HTMLAnchorElement;\n    }\n\n    return null;\n  });\n}\n","import {debounce} from 'lodash-es';\nimport {useMemo, useRef} from 'react';\n\nexport function useDebounce<T extends (...args: never[]) => void>(\n  fn: T,\n  ms: number,\n  maxWait?: number,\n) {\n  const funcRef = useRef<T | null>(null);\n  funcRef.current = fn;\n\n  return useMemo(\n    () =>\n      debounce(\n        (...args: Parameters<T>) => {\n          if (funcRef.current) {\n            funcRef.current(...args);\n          }\n        },\n        ms,\n        {maxWait},\n      ),\n    [ms, maxWait],\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport {$isCodeNode} from '@lexical/code';\nimport {\n  $getNearestNodeFromDOMNode,\n  $getSelection,\n  $setSelection,\n  LexicalEditor,\n} from 'lexical';\nimport * as React from 'react';\nimport {useState} from 'react';\n\nimport {useDebounce} from '../../utils';\n\ninterface Props {\n  editor: LexicalEditor;\n  getCodeDOMNode: () => HTMLElement | null;\n}\n\nexport function CopyButton({editor, getCodeDOMNode}: Props) {\n  const [isCopyCompleted, setCopyCompleted] = useState<boolean>(false);\n\n  const removeSuccessIcon = useDebounce(() => {\n    setCopyCompleted(false);\n  }, 1000);\n\n  async function handleClick(): Promise<void> {\n    const codeDOMNode = getCodeDOMNode();\n\n    if (!codeDOMNode) {\n      return;\n    }\n\n    let content = '';\n\n    editor.update(() => {\n      const codeNode = $getNearestNodeFromDOMNode(codeDOMNode);\n\n      if ($isCodeNode(codeNode)) {\n        content = codeNode.getTextContent();\n      }\n\n      const selection = $getSelection();\n      $setSelection(selection);\n    });\n\n    try {\n      await navigator.clipboard.writeText(content);\n      setCopyCompleted(true);\n      removeSuccessIcon();\n    } catch (err) {\n      console.error('Failed to copy: ', err);\n    }\n  }\n\n  return (\n    <button className=\"menu-item\" onClick={handleClick} aria-label=\"copy\">\n      {isCopyCompleted ? (\n        <i className=\"format success\" />\n      ) : (\n        <i className=\"format copy\" />\n      )}\n    </button>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './index.css';\n\nimport {\n  $isCodeNode,\n  CodeNode,\n  getLanguageFriendlyName,\n  // normalizeCodeLang,\n} from '@lexical/code';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {$getNearestNodeFromDOMNode} from 'lexical';\nimport {useEffect, useRef, useState} from 'react';\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\n\nimport {CopyButton} from './components/CopyButton';\nimport {canBePrettier, PrettierButton} from './components/PrettierButton';\nimport {useDebounce} from './utils';\n\nconst CODE_PADDING = 8;\n\ninterface Position {\n  top: string;\n  right: string;\n}\n\nfunction CodeActionMenuContainer(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n\n  const [lang, setLang] = useState('');\n  const [isShown, setShown] = useState<boolean>(false);\n  const [shouldListenMouseMove, setShouldListenMouseMove] =\n    useState<boolean>(false);\n  const [position, setPosition] = useState<Position>({\n    right: '0',\n    top: '0',\n  });\n  const codeSetRef = useRef<Set<string>>(new Set());\n  const codeDOMNodeRef = useRef<HTMLElement | null>(null);\n\n  function getCodeDOMNode(): HTMLElement | null {\n    return codeDOMNodeRef.current;\n  }\n\n  const debouncedOnMouseMove = useDebounce(\n    (event: MouseEvent) => {\n      const {codeDOMNode, isOutside} = getMouseInfo(event);\n\n      if (isOutside) {\n        setShown(false);\n        return;\n      }\n\n      if (!codeDOMNode) {\n        return;\n      }\n\n      codeDOMNodeRef.current = codeDOMNode;\n\n      let codeNode: CodeNode | null = null;\n      let _lang = '';\n\n      editor.update(() => {\n        const maybeCodeNode = $getNearestNodeFromDOMNode(codeDOMNode);\n\n        if ($isCodeNode(maybeCodeNode)) {\n          codeNode = maybeCodeNode;\n          _lang = codeNode.getLanguage() || '';\n        }\n      });\n\n      if (codeNode) {\n        const {y, right} = codeDOMNode.getBoundingClientRect();\n        setLang(_lang);\n        setShown(true);\n        setPosition({\n          right: `${\n            window.innerWidth - right + CODE_PADDING - window.pageXOffset\n          }px`,\n          top: `${y + window.pageYOffset}px`,\n        });\n      }\n    },\n    50,\n    1000,\n  );\n\n  useEffect(() => {\n    if (!shouldListenMouseMove) {\n      return;\n    }\n\n    document.addEventListener('mousemove', debouncedOnMouseMove);\n\n    return () => {\n      setShown(false);\n      debouncedOnMouseMove.cancel();\n      document.removeEventListener('mousemove', debouncedOnMouseMove);\n    };\n  }, [shouldListenMouseMove, debouncedOnMouseMove]);\n\n  editor.registerMutationListener(CodeNode, (mutations) => {\n    editor.update(() => {\n      for (const [key, type] of mutations) {\n        switch (type) {\n          case 'created':\n            codeSetRef.current.add(key);\n            setShouldListenMouseMove(codeSetRef.current.size > 0);\n            break;\n\n          case 'destroyed':\n            codeSetRef.current.delete(key);\n            setShouldListenMouseMove(codeSetRef.current.size > 0);\n            break;\n\n          default:\n            break;\n        }\n      }\n    });\n  });\n  // const normalizedLang = normalizeCodeLang(lang);\n  const codeFriendlyName = getLanguageFriendlyName(lang);\n\n  return (\n    <>\n      {isShown ? (\n        <div className=\"code-action-menu-container\" style={{...position}}>\n          <div className=\"code-highlight-language\">{codeFriendlyName}</div>\n          <CopyButton editor={editor} getCodeDOMNode={getCodeDOMNode} />\n          {/* {canBePrettier(normalizedLang) ? (\n            <PrettierButton\n              editor={editor}\n              getCodeDOMNode={getCodeDOMNode}\n              lang={normalizedLang}\n            />\n          ) : null} */}\n        </div>\n      ) : null}\n    </>\n  );\n}\n\nfunction getMouseInfo(event: MouseEvent): {\n  codeDOMNode: HTMLElement | null;\n  isOutside: boolean;\n} {\n  const target = event.target;\n\n  if (target && target instanceof HTMLElement) {\n    const codeDOMNode = target.closest<HTMLElement>(\n      'code.PlaygroundEditorTheme__code',\n    );\n    const isOutside = !(\n      codeDOMNode ||\n      target.closest<HTMLElement>('div.code-action-menu-container')\n    );\n\n    return {codeDOMNode, isOutside};\n  } else {\n    return {codeDOMNode: null, isOutside: true};\n  }\n}\n\nexport default function CodeActionMenuPlugin(): React.ReactPortal {\n  return createPortal(<CodeActionMenuContainer />, document.body);\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {registerCodeHighlighting} from '@lexical/code';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {useEffect} from 'react';\n\nexport default function CodeHighlightPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return registerCodeHighlighting(editor);\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport const CAN_USE_DOM: boolean =\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined';\n\nconst documentMode =\n  // @ts-ignore\n  CAN_USE_DOM && 'documentMode' in document ? document.documentMode : null;\n\nexport const IS_APPLE: boolean =\n  CAN_USE_DOM && /Mac|iPod|iPhone|iPad/.test(navigator.platform);\n\nexport const IS_FIREFOX: boolean =\n  CAN_USE_DOM && /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);\n\nexport const CAN_USE_BEFORE_INPUT: boolean =\n  CAN_USE_DOM && 'InputEvent' in window && !documentMode\n    ? 'getTargetRanges' in new window.InputEvent('input')\n    : false;\n\nexport const IS_SAFARI: boolean =\n  CAN_USE_DOM && /Version\\/[\\d.]+.*Safari/.test(navigator.userAgent);\n\nexport const IS_IOS: boolean =\n  CAN_USE_DOM &&\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n  // @ts-ignore\n  !window.MSStream;\n\n// Keep these in case we need to use them in the future.\n// export const IS_WINDOWS: boolean = CAN_USE_DOM && /Win/.test(navigator.platform);\n// export const IS_CHROME: boolean = CAN_USE_DOM && /^(?=.*Chrome).*/i.test(navigator.userAgent);\n// export const canUseTextInputEvent: boolean = CAN_USE_DOM && 'TextEvent' in window && !documentMode;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorConfig,\n  ElementFormatType,\n  LexicalEditor,\n  LexicalNode,\n  NodeKey,\n  Spread,\n} from 'lexical';\n\nimport {BlockWithAlignableContents} from '@lexical/react/LexicalBlockWithAlignableContents';\nimport {\n  DecoratorBlockNode,\n  SerializedDecoratorBlockNode,\n} from '@lexical/react/LexicalDecoratorBlockNode';\nimport * as React from 'react';\n\ntype YouTubeComponentProps = Readonly<{\n  className: Readonly<{\n    base: string;\n    focus: string;\n  }>;\n  format: ElementFormatType | null;\n  nodeKey: NodeKey;\n  videoID: string;\n}>;\n\nfunction YouTubeComponent({\n  className,\n  format,\n  nodeKey,\n  videoID,\n}: YouTubeComponentProps) {\n  return (\n    <BlockWithAlignableContents\n      className={className}\n      format={format}\n      nodeKey={nodeKey}>\n      <iframe\n        width=\"560\"\n        height=\"315\"\n        src={`https://www.youtube.com/embed/${videoID}`}\n        frameBorder=\"0\"\n        allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n        allowFullScreen={true}\n        title=\"YouTube video\"\n      />\n    </BlockWithAlignableContents>\n  );\n}\n\nexport type SerializedYouTubeNode = Spread<\n  {\n    videoID: string;\n    type: 'youtube';\n    version: 1;\n  },\n  SerializedDecoratorBlockNode\n>;\n\nexport class YouTubeNode extends DecoratorBlockNode {\n  __id: string;\n\n  static getType(): string {\n    return 'youtube';\n  }\n\n  static clone(node: YouTubeNode): YouTubeNode {\n    return new YouTubeNode(node.__id, node.__format, node.__key);\n  }\n\n  static importJSON(serializedNode: SerializedYouTubeNode): YouTubeNode {\n    const node = $createYouTubeNode(serializedNode.videoID);\n    node.setFormat(serializedNode.format);\n    return node;\n  }\n\n  exportJSON(): SerializedYouTubeNode {\n    return {\n      ...super.exportJSON(),\n      type: 'youtube',\n      version: 1,\n      videoID: this.__id,\n    };\n  }\n\n  constructor(id: string, format?: ElementFormatType, key?: NodeKey) {\n    super(format, key);\n    this.__id = id;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  getId(): string {\n    return this.__id;\n  }\n\n  decorate(_editor: LexicalEditor, config: EditorConfig): JSX.Element {\n    const embedBlockTheme = config.theme.embedBlock || {};\n    const className = {\n      base: embedBlockTheme.base || '',\n      focus: embedBlockTheme.focus || '',\n    };\n    return (\n      <YouTubeComponent\n        className={className}\n        format={this.__format}\n        nodeKey={this.getKey()}\n        videoID={this.__id}\n      />\n    );\n  }\n\n  isTopLevel(): true {\n    return true;\n  }\n}\n\nexport function $createYouTubeNode(videoID: string): YouTubeNode {\n  return new YouTubeNode(videoID);\n}\n\nexport function $isYouTubeNode(\n  node: YouTubeNode | LexicalNode | null | undefined,\n): node is YouTubeNode {\n  return node instanceof YouTubeNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {\n  ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\n\ntype DropDownContextType = {\n  registerItem: (ref: React.RefObject<HTMLButtonElement>) => void;\n};\n\nconst DropDownContext = React.createContext<DropDownContextType | null>(null);\n\nexport function DropDownItem({\n  children,\n  className,\n  onClick,\n  title,\n}: {\n  children: React.ReactNode;\n  className: string;\n  onClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  title?: string;\n}) {\n  const ref = useRef<HTMLButtonElement>(null);\n\n  const dropDownContext = React.useContext(DropDownContext);\n\n  if (dropDownContext === null) {\n    throw new Error('DropDownItem must be used within a DropDown');\n  }\n\n  const {registerItem} = dropDownContext;\n\n  useEffect(() => {\n    if (ref && ref.current) {\n      registerItem(ref);\n    }\n  }, [ref, registerItem]);\n\n  return (\n    <button className={className} onClick={onClick} ref={ref} title={title}>\n      {children}\n    </button>\n  );\n}\n\nfunction DropDownItems({\n  children,\n  dropDownRef,\n  onClose,\n}: {\n  children: React.ReactNode;\n  dropDownRef: React.Ref<HTMLDivElement>;\n  onClose: () => void;\n}) {\n  const [items, setItems] = useState<React.RefObject<HTMLButtonElement>[]>();\n  const [highlightedItem, setHighlightedItem] =\n    useState<React.RefObject<HTMLButtonElement>>();\n\n  const registerItem = useCallback(\n    (itemRef: React.RefObject<HTMLButtonElement>) => {\n      setItems((prev) => (prev ? [...prev, itemRef] : [itemRef]));\n    },\n    [setItems],\n  );\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\n    if (!items) return;\n\n    const key = event.key;\n\n    if (['Escape', 'ArrowUp', 'ArrowDown', 'Tab'].includes(key)) {\n      event.preventDefault();\n    }\n\n    if (key === 'Escape' || key === 'Tab') {\n      onClose();\n    } else if (key === 'ArrowUp') {\n      setHighlightedItem((prev) => {\n        if (!prev) return items[0];\n        const index = items.indexOf(prev) - 1;\n        return items[index === -1 ? items.length - 1 : index];\n      });\n    } else if (key === 'ArrowDown') {\n      setHighlightedItem((prev) => {\n        if (!prev) return items[0];\n        return items[items.indexOf(prev) + 1];\n      });\n    }\n  };\n\n  const contextValue = useMemo(\n    () => ({\n      registerItem,\n    }),\n    [registerItem],\n  );\n\n  useEffect(() => {\n    if (items && !highlightedItem) {\n      setHighlightedItem(items[0]);\n    }\n\n    if (highlightedItem && highlightedItem.current) {\n      highlightedItem.current.focus();\n    }\n  }, [items, highlightedItem]);\n\n  return (\n    <DropDownContext.Provider value={contextValue}>\n      <div className=\"dropdown\" ref={dropDownRef} onKeyDown={handleKeyDown}>\n        {children}\n      </div>\n    </DropDownContext.Provider>\n  );\n}\n\nexport default function DropDown({\n  buttonLabel,\n  buttonAriaLabel,\n  buttonClassName,\n  buttonIconClassName,\n  children,\n  stopCloseOnClickSelf,\n}: {\n  buttonAriaLabel?: string;\n  buttonClassName: string;\n  buttonIconClassName?: string;\n  buttonLabel?: string;\n  children: ReactNode;\n  stopCloseOnClickSelf?: boolean;\n}): JSX.Element {\n  const dropDownRef = useRef<HTMLDivElement>(null);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n  const [showDropDown, setShowDropDown] = useState(false);\n\n  const handleClose = () => {\n    setShowDropDown(false);\n    if (buttonRef && buttonRef.current) {\n      buttonRef.current.focus();\n    }\n  };\n\n  useEffect(() => {\n    const button = buttonRef.current;\n    const dropDown = dropDownRef.current;\n\n    if (showDropDown && button !== null && dropDown !== null) {\n      const {top, left} = button.getBoundingClientRect();\n      dropDown.style.top = `${top + 40}px`;\n      dropDown.style.left = `${Math.min(\n        left,\n        window.innerWidth - dropDown.offsetWidth - 20,\n      )}px`;\n    }\n  }, [dropDownRef, buttonRef, showDropDown]);\n\n  useEffect(() => {\n    const button = buttonRef.current;\n\n    if (button !== null && showDropDown) {\n      const handle = (event: MouseEvent) => {\n        const target = event.target;\n        if (stopCloseOnClickSelf) {\n          if (\n            dropDownRef.current &&\n            dropDownRef.current.contains(target as Node)\n          )\n            return;\n        }\n        if (!button.contains(target as Node)) {\n          setShowDropDown(false);\n        }\n      };\n      document.addEventListener('click', handle);\n\n      return () => {\n        document.removeEventListener('click', handle);\n      };\n    }\n  }, [dropDownRef, buttonRef, showDropDown, stopCloseOnClickSelf]);\n\n  return (\n    <>\n      <button\n        aria-label={buttonAriaLabel || buttonLabel}\n        className={buttonClassName}\n        onClick={() => setShowDropDown(!showDropDown)}\n        ref={buttonRef}>\n        {buttonIconClassName && <span className={buttonIconClassName} />}\n        {buttonLabel && (\n          <span className=\"text dropdown-button-text\">{buttonLabel}</span>\n        )}\n        <i className=\"chevron-down\" />\n      </button>\n\n      {showDropDown &&\n        createPortal(\n          <DropDownItems dropDownRef={dropDownRef} onClose={handleClose}>\n            {children}\n          </DropDownItems>,\n          document.body,\n        )}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './Input.css';\n\nimport * as React from 'react';\n\ntype Props = Readonly<{\n  'data-test-id'?: string;\n  label: string;\n  onChange: (val: string) => void;\n  placeholder?: string;\n  value: string;\n}>;\n\nexport default function TextInput({\n  label,\n  value,\n  onChange,\n  placeholder = '',\n  'data-test-id': dataTestId,\n}: Props): JSX.Element {\n  return (\n    <div className=\"Input__wrapper\">\n      <label className=\"Input__label\">{label}</label>\n      <input\n        type=\"text\"\n        className=\"Input__input\"\n        placeholder={placeholder}\n        value={value}\n        onChange={(e) => {\n          onChange(e.target.value);\n        }}\n        data-test-id={dataTestId}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './ColorPicker.css';\n\nimport {ReactNode, useEffect, useMemo, useRef, useState} from 'react';\nimport * as React from 'react';\n\nimport DropDown from './DropDown';\nimport TextInput from './TextInput';\n\ninterface ColorPickerProps {\n  buttonAriaLabel?: string;\n  buttonClassName: string;\n  buttonIconClassName?: string;\n  buttonLabel?: string;\n  color: string;\n  children?: ReactNode;\n  onChange?: (color: string) => void;\n  title?: string;\n}\n\nconst basicColors = [\n  '#d0021b',\n  '#f5a623',\n  '#f8e71c',\n  '#8b572a',\n  '#7ed321',\n  '#417505',\n  '#bd10e0',\n  '#9013fe',\n  '#4a90e2',\n  '#50e3c2',\n  '#b8e986',\n  '#000000',\n  '#4a4a4a',\n  '#9b9b9b',\n  '#ffffff',\n];\n\nconst WIDTH = 214;\nconst HEIGHT = 150;\n\nexport default function ColorPicker({\n  color,\n  children,\n  onChange,\n  ...rest\n}: Readonly<ColorPickerProps>): JSX.Element {\n  const [selfColor, setSelfColor] = useState(transformColor('hex', color));\n  const [inputColor, setInputColor] = useState(color);\n  const innerDivRef = useRef(null);\n\n  const saturationPosition = useMemo(\n    () => ({\n      x: (selfColor.hsv.s / 100) * WIDTH,\n      y: ((100 - selfColor.hsv.v) / 100) * HEIGHT,\n    }),\n    [selfColor.hsv.s, selfColor.hsv.v],\n  );\n\n  const huePosition = useMemo(\n    () => ({\n      x: (selfColor.hsv.h / 360) * WIDTH,\n    }),\n    [selfColor.hsv],\n  );\n\n  const onSetHex = (hex: string) => {\n    setInputColor(hex);\n    if (/^#[0-9A-Fa-f]{6}$/i.test(hex)) {\n      const newColor = transformColor('hex', hex);\n      setSelfColor(newColor);\n    }\n  };\n\n  const onMoveSaturation = ({x, y}: Position) => {\n    const newHsv = {\n      ...selfColor.hsv,\n      s: (x / WIDTH) * 100,\n      v: 100 - (y / HEIGHT) * 100,\n    };\n    const newColor = transformColor('hsv', newHsv);\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n  };\n\n  const onMoveHue = ({x}: Position) => {\n    const newHsv = {...selfColor.hsv, h: (x / WIDTH) * 360};\n    const newColor = transformColor('hsv', newHsv);\n\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n  };\n\n  useEffect(() => {\n    // Check if the dropdown is actually active\n    if (innerDivRef.current !== null && onChange) {\n      onChange(selfColor.hex);\n      setInputColor(selfColor.hex);\n    }\n  }, [selfColor, onChange]);\n\n  useEffect(() => {\n    if (color === undefined) return;\n    const newColor = transformColor('hex', color);\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n  }, [color]);\n\n  return (\n    <DropDown {...rest} stopCloseOnClickSelf={true}>\n      <div\n        className=\"color-picker-wrapper\"\n        style={{width: WIDTH}}\n        ref={innerDivRef}>\n        <TextInput label=\"Hex\" onChange={onSetHex} value={inputColor} />\n        <div className=\"color-picker-basic-color\">\n          {basicColors.map((basicColor) => (\n            <button\n              className={basicColor === selfColor.hex ? ' active' : ''}\n              key={basicColor}\n              style={{backgroundColor: basicColor}}\n              onClick={() => {\n                setInputColor(basicColor);\n                setSelfColor(transformColor('hex', basicColor));\n              }}\n            />\n          ))}\n        </div>\n        <MoveWrapper\n          className=\"color-picker-saturation\"\n          style={{backgroundColor: `hsl(${selfColor.hsv.h}, 100%, 50%)`}}\n          onChange={onMoveSaturation}>\n          <div\n            className=\"color-picker-saturation_cursor\"\n            style={{\n              backgroundColor: selfColor.hex,\n              left: saturationPosition.x,\n              top: saturationPosition.y,\n            }}\n          />\n        </MoveWrapper>\n        <MoveWrapper className=\"color-picker-hue\" onChange={onMoveHue}>\n          <div\n            className=\"color-picker-hue_cursor\"\n            style={{\n              backgroundColor: `hsl(${selfColor.hsv.h}, 100%, 50%)`,\n              left: huePosition.x,\n            }}\n          />\n        </MoveWrapper>\n        <div\n          className=\"color-picker-color\"\n          style={{backgroundColor: selfColor.hex}}\n        />\n      </div>\n      {children}\n    </DropDown>\n  );\n}\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\ninterface MoveWrapperProps {\n  className?: string;\n  style?: React.CSSProperties;\n  onChange: (position: Position) => void;\n  children: JSX.Element;\n}\n\nfunction MoveWrapper({className, style, onChange, children}: MoveWrapperProps) {\n  const divRef = useRef<HTMLDivElement>(null);\n\n  const move = (e: React.MouseEvent | MouseEvent): void => {\n    if (divRef.current) {\n      const {current: div} = divRef;\n      const {width, height, left, top} = div.getBoundingClientRect();\n\n      const x = clamp(e.clientX - left, width, 0);\n      const y = clamp(e.clientY - top, height, 0);\n\n      onChange({x, y});\n    }\n  };\n\n  const onMouseDown = (e: React.MouseEvent): void => {\n    if (e.button !== 0) return;\n\n    move(e);\n\n    const onMouseMove = (_e: MouseEvent): void => {\n      move(_e);\n    };\n\n    const onMouseUp = (_e: MouseEvent): void => {\n      document.removeEventListener('mousemove', onMouseMove, false);\n      document.removeEventListener('mouseup', onMouseUp, false);\n\n      move(_e);\n    };\n\n    document.addEventListener('mousemove', onMouseMove, false);\n    document.addEventListener('mouseup', onMouseUp, false);\n  };\n\n  return (\n    <div\n      ref={divRef}\n      className={className}\n      style={style}\n      onMouseDown={onMouseDown}>\n      {children}\n    </div>\n  );\n}\n\nfunction clamp(value: number, max: number, min: number) {\n  return value > max ? max : value < min ? min : value;\n}\n\ninterface RGB {\n  b: number;\n  g: number;\n  r: number;\n}\ninterface HSV {\n  h: number;\n  s: number;\n  v: number;\n}\ninterface Color {\n  hex: string;\n  hsv: HSV;\n  rgb: RGB;\n}\n\nexport function toHex(value: string): string {\n  if (!value.startsWith('#')) {\n    const ctx = document.createElement('canvas').getContext('2d');\n\n    if (!ctx) {\n      throw new Error('2d context not supported or canvas already initialized');\n    }\n\n    ctx.fillStyle = value;\n\n    return ctx.fillStyle;\n  } else if (value.length === 4 || value.length === 5) {\n    value = value\n      .split('')\n      .map((v, i) => (i ? v + v : '#'))\n      .join('');\n\n    return value;\n  } else if (value.length === 7 || value.length === 9) {\n    return value;\n  }\n\n  return '#000000';\n}\n\nfunction hex2rgb(hex: string): RGB {\n  const rbgArr = (\n    hex\n      .replace(\n        /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i,\n        (m, r, g, b) => '#' + r + r + g + g + b + b,\n      )\n      .substring(1)\n      .match(/.{2}/g) || []\n  ).map((x) => parseInt(x, 16));\n\n  return {\n    b: rbgArr[2],\n    g: rbgArr[1],\n    r: rbgArr[0],\n  };\n}\n\nfunction rgb2hsv({r, g, b}: RGB): HSV {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  const max = Math.max(r, g, b);\n  const d = max - Math.min(r, g, b);\n\n  const h = d\n    ? (max === r\n        ? (g - b) / d + (g < b ? 6 : 0)\n        : max === g\n        ? 2 + (b - r) / d\n        : 4 + (r - g) / d) * 60\n    : 0;\n  const s = max ? (d / max) * 100 : 0;\n  const v = max * 100;\n\n  return {h, s, v};\n}\n\nfunction hsv2rgb({h, s, v}: HSV): RGB {\n  s /= 100;\n  v /= 100;\n\n  const i = ~~(h / 60);\n  const f = h / 60 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - s * f);\n  const t = v * (1 - s * (1 - f));\n  const index = i % 6;\n\n  const r = Math.round([v, q, p, p, t, v][index] * 255);\n  const g = Math.round([t, v, v, q, p, p][index] * 255);\n  const b = Math.round([p, p, t, v, v, q][index] * 255);\n\n  return {b, g, r};\n}\n\nfunction rgb2hex({b, g, r}: RGB): string {\n  return '#' + [r, g, b].map((x) => x.toString(16).padStart(2, '0')).join('');\n}\n\nfunction transformColor<M extends keyof Color, C extends Color[M]>(\n  format: M,\n  color: C,\n): Color {\n  let hex: Color['hex'] = toHex('#121212');\n  let rgb: Color['rgb'] = hex2rgb(hex);\n  let hsv: Color['hsv'] = rgb2hsv(rgb);\n\n  if (format === 'hex') {\n    const value = color as Color['hex'];\n\n    hex = toHex(value);\n    rgb = hex2rgb(hex);\n    hsv = rgb2hsv(rgb);\n  } else if (format === 'rgb') {\n    const value = color as Color['rgb'];\n\n    rgb = value;\n    hex = rgb2hex(rgb);\n    hsv = rgb2hsv(rgb);\n  } else if (format === 'hsv') {\n    const value = color as Color['hsv'];\n\n    hsv = value;\n    rgb = hsv2rgb(hsv);\n    hex = rgb2hex(rgb);\n  }\n\n  return {hex, hsv, rgb};\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './Input.css';\n\nimport * as React from 'react';\n\ntype Props = Readonly<{\n  'data-test-id'?: string;\n  accept?: string;\n  label: string;\n  onChange: (files: FileList | null) => void;\n}>;\n\nexport default function FileInput({\n  accept,\n  label,\n  onChange,\n  'data-test-id': dataTestId,\n}: Props): JSX.Element {\n  return (\n    <div className=\"Input__wrapper\">\n      <label className=\"Input__label\">{label}</label>\n      <input\n        type=\"file\"\n        accept={accept}\n        className=\"Input__input\"\n        onChange={(e) => onChange(e.target.files)}\n        data-test-id={dataTestId}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './KatexEquationAlterer.css';\n\nimport * as React from 'react';\nimport {useCallback, useState} from 'react';\n\nimport Button from '../ui/Button';\nimport KatexRenderer from './KatexRenderer';\n\ntype Props = {\n  initialEquation?: string;\n  onConfirm: (equation: string, inline: boolean) => void;\n};\n\nexport default function KatexEquationAlterer({\n  onConfirm,\n  initialEquation = '',\n}: Props): JSX.Element {\n  const [equation, setEquation] = useState<string>(initialEquation);\n  const [inline, setInline] = useState<boolean>(true);\n\n  const onClick = useCallback(() => {\n    onConfirm(equation, inline);\n  }, [onConfirm, equation, inline]);\n\n  const onCheckboxChange = useCallback(() => {\n    setInline(!inline);\n  }, [setInline, inline]);\n\n  return (\n    <>\n      <div className=\"KatexEquationAlterer_defaultRow\">\n        Inline\n        <input type=\"checkbox\" checked={inline} onChange={onCheckboxChange} />\n      </div>\n      <div className=\"KatexEquationAlterer_defaultRow\">Equation </div>\n      <div className=\"KatexEquationAlterer_centerRow\">\n        {inline ? (\n          <input\n            onChange={(event) => {\n              setEquation(event.target.value);\n            }}\n            value={equation}\n            className=\"KatexEquationAlterer_textArea\"\n          />\n        ) : (\n          <textarea\n            onChange={(event) => {\n              setEquation(event.target.value);\n            }}\n            value={equation}\n            className=\"KatexEquationAlterer_textArea\"\n          />\n        )}\n      </div>\n      <div className=\"KatexEquationAlterer_defaultRow\">Visualization </div>\n      <div className=\"KatexEquationAlterer_centerRow\">\n        <KatexRenderer\n          equation={equation}\n          inline={false}\n          onClick={() => null}\n        />\n      </div>\n      <div className=\"KatexEquationAlterer_dialogActions\">\n        <Button onClick={onClick}>Confirm</Button>\n      </div>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './LinkPreview.css';\n\nimport * as React from 'react';\nimport {CSSProperties, Suspense} from 'react';\n\ntype Preview = {\n  title: string;\n  description: string;\n  img: string;\n  domain: string;\n} | null;\n\n// Cached responses or running request promises\nconst PREVIEW_CACHE: Record<string, Promise<Preview> | {preview: Preview}> = {};\n\nconst URL_MATCHER =\n  /((https?:\\/\\/(www\\.)?)|(www\\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;\n\nfunction useSuspenseRequest(url: string) {\n  let cached = PREVIEW_CACHE[url];\n\n  if (!url.match(URL_MATCHER)) {\n    return {preview: null};\n  }\n\n  if (!cached) {\n    cached = PREVIEW_CACHE[url] = fetch(\n      `/api/link-preview?url=${encodeURI(url)}`,\n    )\n      .then((response) => response.json())\n      .then((preview) => {\n        PREVIEW_CACHE[url] = preview;\n        return preview;\n      })\n      .catch(() => {\n        PREVIEW_CACHE[url] = {preview: null};\n      });\n  }\n\n  if (cached instanceof Promise) {\n    throw cached;\n  }\n\n  return cached;\n}\n\nfunction LinkPreviewContent({\n  url,\n}: Readonly<{\n  url: string;\n}>): JSX.Element | null {\n  const {preview} = useSuspenseRequest(url);\n  if (preview === null) {\n    return null;\n  }\n  return (\n    <div className=\"LinkPreview__container\">\n      {preview.img && (\n        <div className=\"LinkPreview__imageWrapper\">\n          <img\n            src={preview.img}\n            alt={preview.title}\n            className=\"LinkPreview__image\"\n          />\n        </div>\n      )}\n      {preview.domain && (\n        <div className=\"LinkPreview__domain\">{preview.domain}</div>\n      )}\n      {preview.title && (\n        <div className=\"LinkPreview__title\">{preview.title}</div>\n      )}\n      {preview.description && (\n        <div className=\"LinkPreview__description\">{preview.description}</div>\n      )}\n    </div>\n  );\n}\n\nfunction Glimmer(props: {style: CSSProperties; index: number}): JSX.Element {\n  return (\n    <div\n      className=\"LinkPreview__glimmer\"\n      {...props}\n      style={{\n        animationDelay: String((props.index || 0) * 300),\n        ...(props.style || {}),\n      }}\n    />\n  );\n}\n\nexport default function LinkPreview({\n  url,\n}: Readonly<{\n  url: string;\n}>): JSX.Element {\n  return (\n    <Suspense\n      fallback={\n        <>\n          <Glimmer style={{height: '80px'}} index={0} />\n          <Glimmer style={{width: '60%'}} index={1} />\n          <Glimmer style={{width: '80%'}} index={2} />\n        </>\n      }>\n      <LinkPreviewContent url={url} />\n    </Suspense>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalCommand} from 'lexical';\n\nimport 'katex/dist/katex.css';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createEquationNode, EquationNode} from '../../nodes/EquationNode';\n\ntype CommandPayload = {\n  equation: string;\n  inline: boolean;\n};\n\nexport const INSERT_EQUATION_COMMAND: LexicalCommand<CommandPayload> =\n  createCommand();\n\nexport default function EquationsPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([EquationNode])) {\n      throw new Error(\n        'EquationsPlugins: EquationsNode not registered on editor',\n      );\n    }\n\n    return editor.registerCommand<CommandPayload>(\n      INSERT_EQUATION_COMMAND,\n      (payload) => {\n        const {equation, inline} = payload;\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          const equationNode = $createEquationNode(equation, inline);\n          selection.insertNodes([equationNode]);\n        }\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {$insertBlockNode} from '@lexical/utils';\nimport {COMMAND_PRIORITY_EDITOR, createCommand, LexicalCommand} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createYouTubeNode, YouTubeNode} from '../../nodes/YouTubeNode';\n\nexport const INSERT_YOUTUBE_COMMAND: LexicalCommand<string> = createCommand();\n\nexport default function YouTubePlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([YouTubeNode])) {\n      throw new Error('YouTubePlugin: YouTubeNode not registered on editor');\n    }\n\n    return editor.registerCommand<string>(\n      INSERT_YOUTUBE_COMMAND,\n      (payload) => {\n        const youTubeNode = $createYouTubeNode(payload);\n        $insertBlockNode(youTubeNode);\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","import type { InsertImagePayload } from '../ImagesPlugin';\nimport type {\n  GridSelection,\n  LexicalEditor,\n  NodeSelection,\n  RangeSelection,\n} from 'lexical';\n\nimport './index.css';\n\nimport {\n  $createCodeNode,\n  $isCodeNode,\n  CODE_LANGUAGE_FRIENDLY_NAME_MAP,\n  CODE_LANGUAGE_MAP,\n  getLanguageFriendlyName,\n} from '@lexical/code';\nimport { $isLinkNode, TOGGLE_LINK_COMMAND } from '@lexical/link';\nimport {\n  $isListNode,\n  INSERT_CHECK_LIST_COMMAND,\n  INSERT_ORDERED_LIST_COMMAND,\n  INSERT_UNORDERED_LIST_COMMAND,\n  ListNode,\n  REMOVE_LIST_COMMAND,\n} from '@lexical/list';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { $isDecoratorBlockNode } from '@lexical/react/LexicalDecoratorBlockNode';\nimport { INSERT_HORIZONTAL_RULE_COMMAND } from '@lexical/react/LexicalHorizontalRuleNode';\nimport {\n  $createHeadingNode,\n  $createQuoteNode,\n  $isHeadingNode,\n  HeadingTagType,\n} from '@lexical/rich-text';\nimport {\n  $getSelectionStyleValueForProperty,\n  $isAtNodeEnd,\n  $isParentElementRTL,\n  $patchStyleText,\n  $selectAll,\n  $wrapLeafNodesInElements,\n} from '@lexical/selection';\nimport { INSERT_TABLE_COMMAND } from '@lexical/table';\nimport {\n  $getNearestBlockElementAncestorOrThrow,\n  $getNearestNodeOfType,\n  mergeRegister,\n} from '@lexical/utils';\nimport {\n  $createParagraphNode,\n  $createTextNode,\n  $getNodeByKey,\n  $getRoot,\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  CAN_REDO_COMMAND,\n  CAN_UNDO_COMMAND,\n  COMMAND_PRIORITY_CRITICAL,\n  COMMAND_PRIORITY_LOW,\n  ElementNode,\n  FORMAT_ELEMENT_COMMAND,\n  FORMAT_TEXT_COMMAND,\n  INDENT_CONTENT_COMMAND,\n  NodeKey,\n  OUTDENT_CONTENT_COMMAND,\n  REDO_COMMAND,\n  SELECTION_CHANGE_COMMAND,\n  TextNode,\n  UNDO_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { IS_APPLE } from '../../nodes/shared/environment';\n\nimport useModal from '../../hooks/useModal';\nimport catTypingGif from '../../images/cat-typing.gif';\nimport yellowFlowerImage from '../../images/yellow-flower.jpg';\nimport { $isYouTubeNode } from '../../nodes/YouTubeNode';\nimport Button from '../../ui/Button';\nimport ColorPicker from '../../ui/ColorPicker';\nimport DropDown, { DropDownItem } from '../../ui/DropDown';\nimport FileInput from '../../ui/FileInput';\nimport KatexEquationAlterer from '../../ui/KatexEquationAlterer';\nimport LinkPreview from '../../ui/LinkPreview';\nimport TextInput from '../../ui/TextInput';\nimport { INSERT_EQUATION_COMMAND } from '../EquationsPlugin';\nimport { INSERT_IMAGE_COMMAND } from '../ImagesPlugin';\nimport { INSERT_YOUTUBE_COMMAND } from '../YouTubePlugin';\n\nconst blockTypeToBlockName = {\n  bullet: 'Bulleted List',\n  check: 'Check List',\n  code: 'Code Block',\n  h1: 'Heading 1',\n  h2: 'Heading 2',\n  h3: 'Heading 3',\n  h4: 'Heading 4',\n  h5: 'Heading 5',\n  h6: 'Heading 6',\n  number: 'Numbered List',\n  paragraph: 'Normal',\n  quote: 'Quote',\n};\n\nfunction getCodeLanguageOptions(): [string, string][] {\n  const options: [string, string][] = [];\n\n  for (const [lang, friendlyName] of Object.entries(\n    CODE_LANGUAGE_FRIENDLY_NAME_MAP,\n  )) {\n    options.push([lang, friendlyName]);\n  }\n\n  return options;\n}\n\nconst CODE_LANGUAGE_OPTIONS = getCodeLanguageOptions();\n\nconst FONT_SIZE_OPTIONS: [string, string][] = [\n  ['10px', '10px'],\n  ['11px', '11px'],\n  ['12px', '12px'],\n  ['13px', '13px'],\n  ['14px', '14px'],\n  ['15px', '15px'],\n  ['16px', '16px'],\n  ['17px', '17px'],\n  ['18px', '18px'],\n  ['19px', '19px'],\n  ['20px', '20px'],\n];\n\nfunction getSelectedNode(selection: RangeSelection): TextNode | ElementNode {\n  const anchor = selection.anchor;\n  const focus = selection.focus;\n  const anchorNode = selection.anchor.getNode();\n  const focusNode = selection.focus.getNode();\n  if (anchorNode === focusNode) {\n    return anchorNode;\n  }\n  const isBackward = selection.isBackward();\n  if (isBackward) {\n    return $isAtNodeEnd(focus) ? anchorNode : focusNode;\n  } else {\n    return $isAtNodeEnd(anchor) ? focusNode : anchorNode;\n  }\n}\n\nfunction positionEditorElement(\n  editor: HTMLElement,\n  rect: ClientRect | null,\n  rootElement: HTMLElement,\n): void {\n  if (rect === null) {\n    editor.style.opacity = '0';\n    editor.style.top = '-1000px';\n    editor.style.left = '-1000px';\n  } else {\n    editor.style.opacity = '1';\n    editor.style.top = `${rect.top + rect.height + window.pageYOffset + 10}px`;\n    const left = rect.left - editor.offsetWidth / 2 + rect.width / 2;\n    const rootElementRect = rootElement.getBoundingClientRect();\n    if (rootElementRect.left > left) {\n      editor.style.left = `${rect.left + window.pageXOffset}px`;\n    } else if (left + editor.offsetWidth > rootElementRect.right) {\n      editor.style.left = `${rect.right + window.pageXOffset - editor.offsetWidth\n        }px`;\n    }\n  }\n}\n\nfunction FloatingLinkEditor({ editor }: { editor: LexicalEditor }): JSX.Element {\n  const editorRef = useRef<HTMLDivElement | null>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const [linkUrl, setLinkUrl] = useState('');\n  const [isEditMode, setEditMode] = useState(false);\n  const [lastSelection, setLastSelection] = useState<\n    RangeSelection | GridSelection | NodeSelection | null\n  >(null);\n\n  const updateLinkEditor = useCallback(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      const node = getSelectedNode(selection);\n      const parent = node.getParent();\n      if ($isLinkNode(parent)) {\n        setLinkUrl(parent.getURL());\n      } else if ($isLinkNode(node)) {\n        setLinkUrl(node.getURL());\n      } else {\n        setLinkUrl('');\n      }\n    }\n    const editorElem = editorRef.current;\n    const nativeSelection = window.getSelection();\n    const activeElement = document.activeElement;\n\n    if (editorElem === null) {\n      return;\n    }\n\n    const rootElement = editor.getRootElement();\n    if (\n      selection !== null &&\n      nativeSelection !== null &&\n      !nativeSelection.isCollapsed &&\n      rootElement !== null &&\n      rootElement.contains(nativeSelection.anchorNode)\n    ) {\n      const domRange = nativeSelection.getRangeAt(0);\n      let rect;\n      if (nativeSelection.anchorNode === rootElement) {\n        let inner = rootElement;\n        while (inner.firstElementChild != null) {\n          inner = inner.firstElementChild as HTMLElement;\n        }\n        rect = inner.getBoundingClientRect();\n      } else {\n        rect = domRange.getBoundingClientRect();\n      }\n\n      positionEditorElement(editorElem, rect, rootElement);\n      setLastSelection(selection);\n    } else if (!activeElement || activeElement.className !== 'link-input') {\n      if (rootElement !== null) {\n        positionEditorElement(editorElem, null, rootElement);\n      }\n      setLastSelection(null);\n      setEditMode(false);\n      setLinkUrl('');\n    }\n\n    return true;\n  }, [editor]);\n\n  useEffect(() => {\n    const onResize = () => {\n      editor.getEditorState().read(() => {\n        updateLinkEditor();\n      });\n    };\n    window.addEventListener('resize', onResize);\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, [editor, updateLinkEditor]);\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerUpdateListener(({ editorState }) => {\n        editorState.read(() => {\n          updateLinkEditor();\n        });\n      }),\n\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        () => {\n          updateLinkEditor();\n          return true;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [editor, updateLinkEditor]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      updateLinkEditor();\n    });\n  }, [editor, updateLinkEditor]);\n\n  useEffect(() => {\n    if (isEditMode && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [isEditMode]);\n\n  return (\n    <div ref={editorRef} className=\"link-editor\">\n      {isEditMode ? (\n        <input\n          ref={inputRef}\n          className=\"link-input\"\n          value={linkUrl}\n          onChange={(event) => {\n            setLinkUrl(event.target.value);\n          }}\n          onKeyDown={(event) => {\n            if (event.key === 'Enter') {\n              event.preventDefault();\n              if (lastSelection !== null) {\n                if (linkUrl !== '') {\n                  editor.dispatchCommand(TOGGLE_LINK_COMMAND, linkUrl);\n                }\n                setEditMode(false);\n              }\n            } else if (event.key === 'Escape') {\n              event.preventDefault();\n              setEditMode(false);\n            }\n          }}\n        />\n      ) : (\n        <>\n          <div className=\"link-input\">\n            <a href={linkUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              {linkUrl}\n            </a>\n            <div\n              className=\"link-edit\"\n              role=\"button\"\n              tabIndex={0}\n              onMouseDown={(event) => event.preventDefault()}\n              onClick={() => {\n                setEditMode(true);\n              }}\n            />\n          </div>\n          <LinkPreview url={linkUrl} />\n        </>\n      )}\n    </div>\n  );\n}\n\nexport function InsertImageUriDialogBody({\n  onClick,\n}: {\n  onClick: (payload: InsertImagePayload) => void;\n}) {\n  const [src, setSrc] = useState('');\n  const [altText, setAltText] = useState('');\n\n  const isDisabled = src === '';\n\n  return (\n    <>\n      <TextInput\n        label=\"Image URL\"\n        placeholder=\"i.e. https://source.unsplash.com/random\"\n        onChange={setSrc}\n        value={src}\n        data-test-id=\"image-modal-url-input\"\n      />\n      <TextInput\n        label=\"Alt Text\"\n        placeholder=\"Random unsplash image\"\n        onChange={setAltText}\n        value={altText}\n        data-test-id=\"image-modal-alt-text-input\"\n      />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button\n          data-test-id=\"image-modal-confirm-btn\"\n          disabled={isDisabled}\n          onClick={() => onClick({ altText, src })}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\nexport function InsertImageUploadedDialogBody({\n  onClick,\n}: {\n  onClick: (payload: InsertImagePayload) => void;\n}) {\n  const [src, setSrc] = useState('');\n  const [altText, setAltText] = useState('');\n\n  const isDisabled = src === '';\n\n  const loadImage = (files: FileList | null) => {\n    const reader = new FileReader();\n    reader.onload = function () {\n      if (typeof reader.result === 'string') {\n        setSrc(reader.result);\n      }\n      return '';\n    };\n    if (files !== null) {\n      reader.readAsDataURL(files[0]);\n    }\n  };\n\n  return (\n    <>\n      <FileInput\n        label=\"Image Upload\"\n        onChange={loadImage}\n        accept=\"image/*\"\n        data-test-id=\"image-modal-file-upload\"\n      />\n      <TextInput\n        label=\"Alt Text\"\n        placeholder=\"Descriptive alternative text\"\n        onChange={setAltText}\n        value={altText}\n        data-test-id=\"image-modal-alt-text-input\"\n      />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button\n          data-test-id=\"image-modal-file-upload-btn\"\n          disabled={isDisabled}\n          onClick={() => onClick({ altText, src })}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\nexport function InsertImageDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [mode, setMode] = useState<null | 'url' | 'file'>(null);\n\n  const onClick = (payload: InsertImagePayload) => {\n    activeEditor.dispatchCommand(INSERT_IMAGE_COMMAND, payload);\n    onClose();\n  };\n\n  return (\n    <>\n      {!mode && (\n        <div className=\"ToolbarPlugin__dialogButtonsList\">\n          <Button\n            data-test-id=\"image-modal-option-sample\"\n            onClick={() =>\n              onClick({\n                altText: 'Yellow flower in tilt shift lens',\n                src: yellowFlowerImage,\n              })\n            }>\n            Sample\n          </Button>\n          <Button\n            data-test-id=\"image-modal-option-url\"\n            onClick={() => setMode('url')}>\n            URL\n          </Button>\n          <Button\n            data-test-id=\"image-modal-option-file\"\n            onClick={() => setMode('file')}>\n            File\n          </Button>\n        </div>\n      )}\n      {mode === 'url' && <InsertImageUriDialogBody onClick={onClick} />}\n      {mode === 'file' && <InsertImageUploadedDialogBody onClick={onClick} />}\n    </>\n  );\n}\n\nexport function InsertTableDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [rows, setRows] = useState('5');\n  const [columns, setColumns] = useState('5');\n\n  const onClick = () => {\n    activeEditor.dispatchCommand(INSERT_TABLE_COMMAND, { columns, rows });\n    onClose();\n  };\n\n  return (\n    <>\n      <TextInput label=\"No of rows\" onChange={setRows} value={rows} />\n      <TextInput label=\"No of columns\" onChange={setColumns} value={columns} />\n      <div\n        className=\"ToolbarPlugin__dialogActions\"\n        data-test-id=\"table-model-confirm-insert\">\n        <Button onClick={onClick}>Confirm</Button>\n      </div>\n    </>\n  );\n}\n\n\nconst YOUTUBE_ID_PARSER =\n  /^.*(youtu\\.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;\n\nconst parseYouTubeVideoID = (url: string) => {\n  const urlMatches = url.match(YOUTUBE_ID_PARSER);\n\n  return urlMatches?.[2].length === 11 ? urlMatches[2] : null;\n};\n\nfunction InsertYouTubeDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [text, setText] = useState('');\n\n  const onClick = () => {\n    const videoID = parseYouTubeVideoID(text);\n    if (videoID) {\n      activeEditor.dispatchCommand(INSERT_YOUTUBE_COMMAND, videoID);\n    }\n    onClose();\n  };\n\n  const isDisabled = text === '' || !parseYouTubeVideoID(text);\n\n  return (\n    <>\n      <TextInput\n        data-test-id=\"youtube-embed-modal-url\"\n        label=\"YouTube URL\"\n        placeholder=\"i.e. https://www.youtube.com/watch?v=jNQXAC9IVRw\"\n        onChange={setText}\n        value={text}\n      />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button\n          data-test-id=\"youtube-embed-modal-submit-btn\"\n          disabled={isDisabled}\n          onClick={onClick}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\nexport function InsertEquationDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const onEquationConfirm = useCallback(\n    (equation: string, inline: boolean) => {\n      activeEditor.dispatchCommand(INSERT_EQUATION_COMMAND, { equation, inline });\n      onClose();\n    },\n    [activeEditor, onClose],\n  );\n\n  return <KatexEquationAlterer onConfirm={onEquationConfirm} />;\n}\n\nfunction dropDownActiveClass(active: boolean) {\n  if (active) return 'active dropdown-item-active';\n  else return '';\n}\n\nfunction BlockFormatDropDown({\n  editor,\n  blockType,\n}: {\n  blockType: keyof typeof blockTypeToBlockName;\n  editor: LexicalEditor;\n}): JSX.Element {\n  const formatParagraph = () => {\n    if (blockType !== 'paragraph') {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          $wrapLeafNodesInElements(selection, () => $createParagraphNode());\n        }\n      });\n    }\n  };\n\n  const formatHeading = (headingSize: HeadingTagType) => {\n    if (blockType !== headingSize) {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          $wrapLeafNodesInElements(selection, () =>\n            $createHeadingNode(headingSize),\n          );\n        }\n      });\n    }\n  };\n\n  const formatBulletList = () => {\n    if (blockType !== 'bullet') {\n      editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND, undefined);\n    } else {\n      editor.dispatchCommand(REMOVE_LIST_COMMAND, undefined);\n    }\n  };\n\n  const formatCheckList = () => {\n    if (blockType !== 'check') {\n      editor.dispatchCommand(INSERT_CHECK_LIST_COMMAND, undefined);\n    } else {\n      editor.dispatchCommand(REMOVE_LIST_COMMAND, undefined);\n    }\n  };\n\n  const formatNumberedList = () => {\n    if (blockType !== 'number') {\n      editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND, undefined);\n    } else {\n      editor.dispatchCommand(REMOVE_LIST_COMMAND, undefined);\n    }\n  };\n\n  const formatQuote = () => {\n    if (blockType !== 'quote') {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          $wrapLeafNodesInElements(selection, () => $createQuoteNode());\n        }\n      });\n    }\n  };\n\n  const formatCode = () => {\n    if (blockType !== 'code') {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          if (selection.isCollapsed()) {\n            $wrapLeafNodesInElements(selection, () => $createCodeNode());\n          } else {\n            selection.getNodes().forEach((node) => {\n              // Explicity set fallback text content for some decorators nodes.\n              if ($isYouTubeNode(node)) {\n                node.replace(\n                  $createTextNode(\n                    `https://www.youtube.com/watch?v=${node.getId()}`,\n                  ),\n                );\n              }\n            });\n\n            const textContent = selection.getTextContent();\n            const codeNode = $createCodeNode();\n            selection.insertNodes([codeNode]);\n            selection.insertRawText(textContent);\n          }\n        }\n      });\n    }\n  };\n\n  return (\n    <DropDown\n      buttonClassName=\"toolbar-item block-controls\"\n      buttonIconClassName={'icon block-type ' + blockType}\n      buttonLabel={blockTypeToBlockName[blockType]}\n      buttonAriaLabel=\"Formatting options for text style\">\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'paragraph')}\n        onClick={formatParagraph}>\n        <i className=\"icon paragraph\" />\n        <span className=\"text\">Normal</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'h1')}\n        onClick={() => formatHeading('h1')}>\n        <i className=\"icon h1\" />\n        <span className=\"text\">Heading 1</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'h2')}\n        onClick={() => formatHeading('h2')}>\n        <i className=\"icon h2\" />\n        <span className=\"text\">Heading 2</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'h3')}\n        onClick={() => formatHeading('h3')}>\n        <i className=\"icon h3\" />\n        <span className=\"text\">Heading 3</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'bullet')}\n        onClick={formatBulletList}>\n        <i className=\"icon bullet-list\" />\n        <span className=\"text\">Bullet List</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'number')}\n        onClick={formatNumberedList}>\n        <i className=\"icon numbered-list\" />\n        <span className=\"text\">Numbered List</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'check')}\n        onClick={formatCheckList}>\n        <i className=\"icon check-list\" />\n        <span className=\"text\">Check List</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'quote')}\n        onClick={formatQuote}>\n        <i className=\"icon quote\" />\n        <span className=\"text\">Quote</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'code')}\n        onClick={formatCode}>\n        <i className=\"icon code\" />\n        <span className=\"text\">Code Block</span>\n      </DropDownItem>\n    </DropDown>\n  );\n}\n\nfunction Divider(): JSX.Element {\n  return <div className=\"divider\" />;\n}\n\nfunction FontDropDown({\n  editor,\n  value,\n  style,\n}: {\n  editor: LexicalEditor;\n  value: string;\n  style: string;\n}): JSX.Element {\n  const handleClick = useCallback(\n    (option: string) => {\n      editor.update(() => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection)) {\n          $patchStyleText(selection, {\n            [style]: option,\n          });\n        }\n      });\n    },\n    [editor, style],\n  );\n\n  const buttonAriaLabel =\n    style === 'font-family'\n      ? 'Formatting options for font family'\n      : 'Formatting options for font size';\n\n  return (\n    <DropDown\n      buttonClassName={'toolbar-item ' + style}\n      buttonLabel={value}\n      buttonIconClassName={\n        style === 'font-family' ? 'icon block-type font-family' : ''\n      }\n      buttonAriaLabel={buttonAriaLabel}>\n      {(style === 'font-family' ? FONT_FAMILY_OPTIONS : FONT_SIZE_OPTIONS).map(\n        ([option, text]) => (\n          <DropDownItem\n            className={`item ${dropDownActiveClass(value === option)} ${style === 'font-size' ? 'fontsize-item' : ''\n              }`}\n            onClick={() => handleClick(option)}\n            key={option}>\n            <span className=\"text\">{text}</span>\n          </DropDownItem>\n        ),\n      )}\n    </DropDown>\n  );\n}\n\nexport default function ToolbarPlugin(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [activeEditor, setActiveEditor] = useState(editor);\n  const [blockType, setBlockType] =\n    useState<keyof typeof blockTypeToBlockName>('paragraph');\n  const [selectedElementKey, setSelectedElementKey] = useState<NodeKey | null>(\n    null,\n  );\n  const [fontSize, setFontSize] = useState<string>('15px');\n  const [fontColor, setFontColor] = useState<string>('#000');\n  const [bgColor, setBgColor] = useState<string>('#fff');\n  const [fontFamily, setFontFamily] = useState<string>('Arial');\n  const [isLink, setIsLink] = useState(false);\n  const [isBold, setIsBold] = useState(false);\n  const [isItalic, setIsItalic] = useState(false);\n  const [isUnderline, setIsUnderline] = useState(false);\n  const [isStrikethrough, setIsStrikethrough] = useState(false);\n  const [isSubscript, setIsSubscript] = useState(false);\n  const [isSuperscript, setIsSuperscript] = useState(false);\n  const [isCode, setIsCode] = useState(false);\n  const [canUndo, setCanUndo] = useState(false);\n  const [canRedo, setCanRedo] = useState(false);\n  const [modal, showModal] = useModal();\n  const [isRTL, setIsRTL] = useState(false);\n  const [codeLanguage, setCodeLanguage] = useState<string>('');\n\n  const updateToolbar = useCallback(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      const anchorNode = selection.anchor.getNode();\n      const element =\n        anchorNode.getKey() === 'root'\n          ? anchorNode\n          : anchorNode.getTopLevelElementOrThrow();\n      const elementKey = element.getKey();\n      const elementDOM = activeEditor.getElementByKey(elementKey);\n\n      // Update text format\n      setIsBold(selection.hasFormat('bold'));\n      setIsItalic(selection.hasFormat('italic'));\n      setIsUnderline(selection.hasFormat('underline'));\n      setIsStrikethrough(selection.hasFormat('strikethrough'));\n      setIsSubscript(selection.hasFormat('subscript'));\n      setIsSuperscript(selection.hasFormat('superscript'));\n      setIsCode(selection.hasFormat('code'));\n      setIsRTL($isParentElementRTL(selection));\n\n      // Update links\n      const node = getSelectedNode(selection);\n      const parent = node.getParent();\n      if ($isLinkNode(parent) || $isLinkNode(node)) {\n        setIsLink(true);\n      } else {\n        setIsLink(false);\n      }\n\n      if (elementDOM !== null) {\n        setSelectedElementKey(elementKey);\n        if ($isListNode(element)) {\n          const parentList = $getNearestNodeOfType<ListNode>(\n            anchorNode,\n            ListNode,\n          );\n          const type = parentList\n            ? parentList.getListType()\n            : element.getListType();\n          setBlockType(type);\n        } else {\n          const type = $isHeadingNode(element)\n            ? element.getTag()\n            : element.getType();\n          if (type in blockTypeToBlockName) {\n            setBlockType(type as keyof typeof blockTypeToBlockName);\n          }\n          if ($isCodeNode(element)) {\n            const language =\n              element.getLanguage() as keyof typeof CODE_LANGUAGE_MAP;\n            setCodeLanguage(\n              language ? CODE_LANGUAGE_MAP[language] || language : '',\n            );\n            return;\n          }\n        }\n      }\n      // Handle buttons\n      setFontSize(\n        $getSelectionStyleValueForProperty(selection, 'font-size', '15px'),\n      );\n      setFontColor(\n        $getSelectionStyleValueForProperty(selection, 'color', '#000'),\n      );\n      setBgColor(\n        $getSelectionStyleValueForProperty(\n          selection,\n          'background-color',\n          '#fff',\n        ),\n      );\n      setFontFamily(\n        $getSelectionStyleValueForProperty(selection, 'font-family', 'Arial'),\n      );\n    }\n  }, [activeEditor]);\n\n  useEffect(() => {\n    return editor.registerCommand(\n      SELECTION_CHANGE_COMMAND,\n      (_payload, newEditor) => {\n        updateToolbar();\n        setActiveEditor(newEditor);\n        return false;\n      },\n      COMMAND_PRIORITY_CRITICAL,\n    );\n  }, [editor, updateToolbar]);\n\n  useEffect(() => {\n    return mergeRegister(\n      activeEditor.registerUpdateListener(({ editorState }) => {\n        editorState.read(() => {\n          updateToolbar();\n        });\n      }),\n      activeEditor.registerCommand<boolean>(\n        CAN_UNDO_COMMAND,\n        (payload) => {\n          setCanUndo(payload);\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL,\n      ),\n      activeEditor.registerCommand<boolean>(\n        CAN_REDO_COMMAND,\n        (payload) => {\n          setCanRedo(payload);\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL,\n      ),\n    );\n  }, [activeEditor, updateToolbar]);\n\n  const applyStyleText = useCallback(\n    (styles: Record<string, string>) => {\n      activeEditor.update(() => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection)) {\n          $patchStyleText(selection, styles);\n        }\n      });\n    },\n    [activeEditor],\n  );\n\n  const clearFormatting = useCallback(() => {\n    activeEditor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        $selectAll(selection);\n        selection.getNodes().forEach((node) => {\n          if ($isTextNode(node)) {\n            node.setFormat(0);\n            node.setStyle('');\n            $getNearestBlockElementAncestorOrThrow(node).setFormat('');\n          }\n          if ($isDecoratorBlockNode(node)) {\n            node.setFormat('');\n          }\n        });\n      }\n    });\n  }, [activeEditor]);\n\n  const onFontColorSelect = useCallback(\n    (value: string) => {\n      applyStyleText({ color: value });\n    },\n    [applyStyleText],\n  );\n\n  const onBgColorSelect = useCallback(\n    (value: string) => {\n      applyStyleText({ 'background-color': value });\n    },\n    [applyStyleText],\n  );\n\n  const insertLink = useCallback(() => {\n    if (!isLink) {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, 'https://');\n    } else {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, null);\n    }\n  }, [editor, isLink]);\n\n  const onCodeLanguageSelect = useCallback(\n    (value: string) => {\n      activeEditor.update(() => {\n        if (selectedElementKey !== null) {\n          const node = $getNodeByKey(selectedElementKey);\n          if ($isCodeNode(node)) {\n            node.setLanguage(value);\n          }\n        }\n      });\n    },\n    [activeEditor, selectedElementKey],\n  );\n  const insertGifOnClick = (payload: InsertImagePayload) => {\n    activeEditor.dispatchCommand(INSERT_IMAGE_COMMAND, payload);\n  };\n  return (\n    <div className=\"toolbar\">\n      <button\n        disabled={!canUndo}\n        onClick={() => {\n          activeEditor.dispatchCommand(UNDO_COMMAND, undefined);\n        }}\n        title={IS_APPLE ? 'Undo (⌘Z)' : 'Undo (Ctrl+Z)'}\n        className=\"toolbar-item spaced\"\n        aria-label=\"Undo\">\n        <i className=\"format undo\" />\n      </button>\n      <button\n        disabled={!canRedo}\n        onClick={() => {\n          activeEditor.dispatchCommand(REDO_COMMAND, undefined);\n        }}\n        title={IS_APPLE ? 'Redo (⌘Y)' : 'Undo (Ctrl+Y)'}\n        className=\"toolbar-item\"\n        aria-label=\"Redo\">\n        <i className=\"format redo\" />\n      </button>\n      <Divider />\n      {blockType in blockTypeToBlockName && activeEditor === editor && (\n        <>\n          <BlockFormatDropDown blockType={blockType} editor={editor} />\n          <Divider />\n        </>\n      )}\n      {blockType === 'code' ? (\n        <>\n          <DropDown\n            buttonClassName=\"toolbar-item code-language\"\n            buttonLabel={getLanguageFriendlyName(codeLanguage)}\n            buttonAriaLabel=\"Select language\">\n            {CODE_LANGUAGE_OPTIONS.map(([value, name]) => {\n              return (\n                <DropDownItem\n                  className={`item ${dropDownActiveClass(\n                    value === codeLanguage,\n                  )}`}\n                  onClick={() => onCodeLanguageSelect(value)}\n                  key={value}>\n                  <span className=\"text\">{name}</span>\n                </DropDownItem>\n              );\n            })}\n          </DropDown>\n        </>\n      ) : (\n        <>\n          <FontDropDown style={'font-size'} value={fontSize} editor={editor} />\n          <Divider />\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'bold');\n            }}\n            className={'toolbar-item spaced ' + (isBold ? 'active' : '')}\n            title={IS_APPLE ? 'Bold (⌘B)' : 'Bold (Ctrl+B)'}\n            aria-label={`Format text as bold. Shortcut: ${IS_APPLE ? '⌘B' : 'Ctrl+B'\n              }`}>\n            <i className=\"format bold\" />\n          </button>\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'italic');\n            }}\n            className={'toolbar-item spaced ' + (isItalic ? 'active' : '')}\n            title={IS_APPLE ? 'Italic (⌘I)' : 'Italic (Ctrl+I)'}\n            aria-label={`Format text as italics. Shortcut: ${IS_APPLE ? '⌘I' : 'Ctrl+I'\n              }`}>\n            <i className=\"format italic\" />\n          </button>\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'underline');\n            }}\n            className={'toolbar-item spaced ' + (isUnderline ? 'active' : '')}\n            title={IS_APPLE ? 'Underline (⌘U)' : 'Underline (Ctrl+U)'}\n            aria-label={`Format text to underlined. Shortcut: ${IS_APPLE ? '⌘U' : 'Ctrl+U'\n              }`}>\n            <i className=\"format underline\" />\n          </button>\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'code');\n            }}\n            className={'toolbar-item spaced ' + (isCode ? 'active' : '')}\n            title=\"Insert code block\"\n            aria-label=\"Insert code block\">\n            <i className=\"format code\" />\n          </button>\n          <button\n            onClick={insertLink}\n            className={'toolbar-item spaced ' + (isLink ? 'active' : '')}\n            aria-label=\"Insert link\"\n            title=\"Insert link\">\n            <i className=\"format link\" />\n          </button>\n          {isLink &&\n            createPortal(\n              <FloatingLinkEditor editor={activeEditor} />,\n              document.body,\n            )}\n          <ColorPicker\n            buttonClassName=\"toolbar-item color-picker\"\n            buttonAriaLabel=\"Formatting text color\"\n            buttonIconClassName=\"icon font-color\"\n            color={fontColor}\n            onChange={onFontColorSelect}\n            title=\"text color\"\n          />\n          <ColorPicker\n            buttonClassName=\"toolbar-item color-picker\"\n            buttonAriaLabel=\"Formatting background color\"\n            buttonIconClassName=\"icon bg-color\"\n            color={bgColor}\n            onChange={onBgColorSelect}\n            title=\"bg color\"\n          />\n          <DropDown\n            buttonClassName=\"toolbar-item spaced\"\n            buttonLabel=\"\"\n            buttonAriaLabel=\"Formatting options for additional text styles\"\n            buttonIconClassName=\"icon dropdown-more\">\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(\n                  FORMAT_TEXT_COMMAND,\n                  'strikethrough',\n                );\n              }}\n              className={'item ' + dropDownActiveClass(isStrikethrough)}\n              title=\"Strikethrough\"\n              aria-label=\"Format text with a strikethrough\">\n              <i className=\"icon strikethrough\" />\n              <span className=\"text\">Strikethrough</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'subscript');\n              }}\n              className={'item ' + dropDownActiveClass(isSubscript)}\n              title=\"Subscript\"\n              aria-label=\"Format text with a subscript\">\n              <i className=\"icon subscript\" />\n              <span className=\"text\">Subscript</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(\n                  FORMAT_TEXT_COMMAND,\n                  'superscript',\n                );\n              }}\n              className={'item ' + dropDownActiveClass(isSuperscript)}\n              title=\"Superscript\"\n              aria-label=\"Format text with a superscript\">\n              <i className=\"icon superscript\" />\n              <span className=\"text\">Superscript</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={clearFormatting}\n              className=\"item\"\n              title=\"Clear text formatting\"\n              aria-label=\"Clear all text formatting\">\n              <i className=\"icon clear\" />\n              <span className=\"text\">Clear Formatting</span>\n            </DropDownItem>\n          </DropDown>\n          <Divider />\n          <DropDown\n            buttonClassName=\"toolbar-item spaced\"\n            buttonLabel=\"Insert\"\n            buttonAriaLabel=\"Insert specialized editor node\"\n            buttonIconClassName=\"icon plus\">\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(\n                  INSERT_HORIZONTAL_RULE_COMMAND,\n                  undefined,\n                );\n              }}\n              className=\"item\">\n              <i className=\"icon horizontal-rule\" />\n              <span className=\"text\">Horizontal Rule</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Image', (onClose) => (\n                  <InsertImageDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon image\" />\n              <span className=\"text\">Image</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() =>\n                insertGifOnClick({\n                  altText: 'Cat typing on a laptop',\n                  src: catTypingGif,\n                })\n              }\n              className=\"item\">\n              <i className=\"icon gif\" />\n              <span className=\"text\">GIF</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Table', (onClose) => (\n                  <InsertTableDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon table\" />\n              <span className=\"text\">Table</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert YouTube Video', (onClose) => (\n                  <InsertYouTubeDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon youtube\" />\n              <span className=\"text\">YouTube Video</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Equation', (onClose) => (\n                  <InsertEquationDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon equation\" />\n              <span className=\"text\">Equation</span>\n            </DropDownItem>\n          </DropDown>\n        </>\n      )}\n      <Divider />\n      <DropDown\n        buttonLabel=\"Align\"\n        buttonIconClassName=\"icon left-align\"\n        buttonClassName=\"toolbar-item spaced alignment\"\n        buttonAriaLabel=\"Formatting options for text alignment\">\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'left');\n          }}\n          className=\"item\">\n          <i className=\"icon left-align\" />\n          <span className=\"text\">Left Align</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'center');\n          }}\n          className=\"item\">\n          <i className=\"icon center-align\" />\n          <span className=\"text\">Center Align</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'right');\n          }}\n          className=\"item\">\n          <i className=\"icon right-align\" />\n          <span className=\"text\">Right Align</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'justify');\n          }}\n          className=\"item\">\n          <i className=\"icon justify-align\" />\n          <span className=\"text\">Justify Align</span>\n        </DropDownItem>\n        <Divider />\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(OUTDENT_CONTENT_COMMAND, undefined);\n          }}\n          className=\"item\">\n          <i className={'icon ' + (isRTL ? 'indent' : 'outdent')} />\n          <span className=\"text\">Outdent</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(INDENT_CONTENT_COMMAND, undefined);\n          }}\n          className=\"item\">\n          <i className={'icon ' + (isRTL ? 'outdent' : 'indent')} />\n          <span className=\"text\">Indent</span>\n        </DropDownItem>\n      </DropDown>\n\n      {modal}\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {$createCodeNode} from '@lexical/code';\nimport {\n  INSERT_CHECK_LIST_COMMAND,\n  INSERT_ORDERED_LIST_COMMAND,\n  INSERT_UNORDERED_LIST_COMMAND,\n} from '@lexical/list';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {INSERT_HORIZONTAL_RULE_COMMAND} from '@lexical/react/LexicalHorizontalRuleNode';\nimport {\n  LexicalTypeaheadMenuPlugin,\n  TypeaheadOption,\n  useBasicTypeaheadTriggerMatch,\n} from '@lexical/react/LexicalTypeaheadMenuPlugin';\nimport {$createHeadingNode, $createQuoteNode} from '@lexical/rich-text';\nimport {$wrapLeafNodesInElements} from '@lexical/selection';\nimport {INSERT_TABLE_COMMAND} from '@lexical/table';\nimport {\n  $createParagraphNode,\n  $getSelection,\n  $isRangeSelection,\n  FORMAT_ELEMENT_COMMAND,\n  TextNode,\n} from 'lexical';\nimport {useCallback, useMemo, useState} from 'react';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport useModal from '../../hooks/useModal';\nimport catTypingGif from '../../images/cat-typing.gif';\nimport {INSERT_EXCALIDRAW_COMMAND} from '../ExcalidrawPlugin';\nimport {INSERT_IMAGE_COMMAND} from '../ImagesPlugin';\nimport {\n  InsertEquationDialog,\n  InsertImageDialog,\n  InsertTableDialog,\n} from '../ToolbarPlugin';\n\nclass ComponentPickerOption extends TypeaheadOption {\n  // What shows up in the editor\n  title: string;\n  // Icon for display\n  icon?: JSX.Element;\n  // For extra searching.\n  keywords: Array<string>;\n  // TBD\n  keyboardShortcut?: string;\n  // What happens when you select this option?\n  onSelect: (queryString: string) => void;\n\n  constructor(\n    title: string,\n    options: {\n      icon?: JSX.Element;\n      keywords?: Array<string>;\n      keyboardShortcut?: string;\n      onSelect: (queryString: string) => void;\n    },\n  ) {\n    super(title);\n    this.title = title;\n    this.keywords = options.keywords || [];\n    this.icon = options.icon;\n    this.keyboardShortcut = options.keyboardShortcut;\n    this.onSelect = options.onSelect.bind(this);\n  }\n}\n\nfunction ComponentPickerMenuItem({\n  index,\n  isSelected,\n  onClick,\n  onMouseEnter,\n  option,\n}: {\n  index: number;\n  isSelected: boolean;\n  onClick: () => void;\n  onMouseEnter: () => void;\n  option: ComponentPickerOption;\n}) {\n  let className = 'item';\n  if (isSelected) {\n    className += ' selected';\n  }\n  return (\n    <li\n      key={option.key}\n      tabIndex={-1}\n      className={className}\n      ref={option.setRefElement}\n      role=\"option\"\n      aria-selected={isSelected}\n      id={'typeahead-item-' + index}\n      onMouseEnter={onMouseEnter}\n      onClick={onClick}>\n      {option.icon}\n      <span className=\"text\">{option.title}</span>\n    </li>\n  );\n}\n\nexport default function ComponentPickerMenuPlugin(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [modal, showModal] = useModal();\n  const [queryString, setQueryString] = useState<string | null>(null);\n\n  const checkForTriggerMatch = useBasicTypeaheadTriggerMatch('/', {\n    minLength: 0,\n  });\n\n  const getDynamicOptions = useCallback(() => {\n    const options: Array<ComponentPickerOption> = [];\n\n    if (queryString == null) {\n      return options;\n    }\n\n    const fullTableRegex = new RegExp(/([1-9]|10)x([1-9]|10)$/);\n    const partialTableRegex = new RegExp(/([1-9]|10)x?$/);\n\n    const fullTableMatch = fullTableRegex.exec(queryString);\n    const partialTableMatch = partialTableRegex.exec(queryString);\n\n    if (fullTableMatch) {\n      const [rows, columns] = fullTableMatch[0]\n        .split('x')\n        .map((n: string) => parseInt(n, 10));\n\n      options.push(\n        new ComponentPickerOption(`${rows}x${columns} Table`, {\n          icon: <i className=\"icon table\" />,\n          keywords: ['table'],\n          onSelect: () =>\n            // @ts-ignore Correct types, but since they're dynamic TS doesn't like it.\n            editor.dispatchCommand(INSERT_TABLE_COMMAND, {columns, rows}),\n        }),\n      );\n    } else if (partialTableMatch) {\n      const rows = parseInt(partialTableMatch[0], 10);\n\n      options.push(\n        ...Array.from({length: 5}, (_, i) => i + 1).map(\n          (columns) =>\n            new ComponentPickerOption(`${rows}x${columns} Table`, {\n              icon: <i className=\"icon table\" />,\n              keywords: ['table'],\n              onSelect: () =>\n                // @ts-ignore Correct types, but since they're dynamic TS doesn't like it.\n                editor.dispatchCommand(INSERT_TABLE_COMMAND, {columns, rows}),\n            }),\n        ),\n      );\n    }\n\n    return options;\n  }, [editor, queryString]);\n\n  const options = useMemo(() => {\n    const baseOptions = [\n      new ComponentPickerOption('Paragraph', {\n        icon: <i className=\"icon paragraph\" />,\n        keywords: ['normal', 'paragraph', 'p', 'text'],\n        onSelect: () =>\n          editor.update(() => {\n            const selection = $getSelection();\n            if ($isRangeSelection(selection)) {\n              $wrapLeafNodesInElements(selection, () => $createParagraphNode());\n            }\n          }),\n      }),\n      ...Array.from({length: 3}, (_, i) => i + 1).map(\n        (n) =>\n          new ComponentPickerOption(`Heading ${n}`, {\n            icon: <i className={`icon h${n}`} />,\n            keywords: ['heading', 'header', `h${n}`],\n            onSelect: () =>\n              editor.update(() => {\n                const selection = $getSelection();\n                if ($isRangeSelection(selection)) {\n                  $wrapLeafNodesInElements(selection, () =>\n                    // @ts-ignore Correct types, but since they're dynamic TS doesn't like it.\n                    $createHeadingNode(`h${n}`),\n                  );\n                }\n              }),\n          }),\n      ),\n      new ComponentPickerOption('Table', {\n        icon: <i className=\"icon table\" />,\n        keywords: ['table', 'grid', 'spreadsheet', 'rows', 'columns'],\n        onSelect: () =>\n          showModal('Insert Table', (onClose) => (\n            <InsertTableDialog activeEditor={editor} onClose={onClose} />\n          )),\n      }),\n      new ComponentPickerOption('Numbered List', {\n        icon: <i className=\"icon number\" />,\n        keywords: ['numbered list', 'ordered list', 'ol'],\n        onSelect: () =>\n          editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND, undefined),\n      }),\n      new ComponentPickerOption('Bulleted List', {\n        icon: <i className=\"icon bullet\" />,\n        keywords: ['bulleted list', 'unordered list', 'ul'],\n        onSelect: () =>\n          editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND, undefined),\n      }),\n      new ComponentPickerOption('Check List', {\n        icon: <i className=\"icon check\" />,\n        keywords: ['check list', 'todo list'],\n        onSelect: () =>\n          editor.dispatchCommand(INSERT_CHECK_LIST_COMMAND, undefined),\n      }),\n      new ComponentPickerOption('Quote', {\n        icon: <i className=\"icon quote\" />,\n        keywords: ['block quote'],\n        onSelect: () =>\n          editor.update(() => {\n            const selection = $getSelection();\n            if ($isRangeSelection(selection)) {\n              $wrapLeafNodesInElements(selection, () => $createQuoteNode());\n            }\n          }),\n      }),\n      new ComponentPickerOption('Code', {\n        icon: <i className=\"icon code\" />,\n        keywords: ['javascript', 'python', 'js', 'codeblock'],\n        onSelect: () =>\n          editor.update(() => {\n            const selection = $getSelection();\n\n            if ($isRangeSelection(selection)) {\n              if (selection.isCollapsed()) {\n                $wrapLeafNodesInElements(selection, () => $createCodeNode());\n              } else {\n                const textContent = selection.getTextContent();\n                const codeNode = $createCodeNode();\n                selection.insertNodes([codeNode]);\n                selection.insertRawText(textContent);\n              }\n            }\n          }),\n      }),\n      new ComponentPickerOption('Divider', {\n        icon: <i className=\"icon horizontal-rule\" />,\n        keywords: ['horizontal rule', 'divider', 'hr'],\n        onSelect: () =>\n          editor.dispatchCommand(INSERT_HORIZONTAL_RULE_COMMAND, undefined),\n      }),\n    \n      new ComponentPickerOption('Equation', {\n        icon: <i className=\"icon equation\" />,\n        keywords: ['equation', 'latex', 'math'],\n        onSelect: () =>\n          showModal('Insert Equation', (onClose) => (\n            <InsertEquationDialog activeEditor={editor} onClose={onClose} />\n          )),\n      }),\n      new ComponentPickerOption('GIF', {\n        icon: <i className=\"icon gif\" />,\n        keywords: ['gif', 'animate', 'image', 'file'],\n        onSelect: () =>\n          editor.dispatchCommand(INSERT_IMAGE_COMMAND, {\n            altText: 'Cat typing on a laptop',\n            src: catTypingGif,\n          }),\n      }),\n      new ComponentPickerOption('Image', {\n        icon: <i className=\"icon image\" />,\n        keywords: ['image', 'photo', 'picture', 'file'],\n        onSelect: () =>\n          showModal('Insert Image', (onClose) => (\n            <InsertImageDialog activeEditor={editor} onClose={onClose} />\n          )),\n      }),\n      ...['left', 'center', 'right', 'justify'].map(\n        (alignment) =>\n          new ComponentPickerOption(`Align ${alignment}`, {\n            icon: <i className={`icon ${alignment}-align`} />,\n            keywords: ['align', 'justify', alignment],\n            onSelect: () =>\n              // @ts-ignore Correct types, but since they're dynamic TS doesn't like it.\n              editor.dispatchCommand(FORMAT_ELEMENT_COMMAND, alignment),\n          }),\n      ),\n    ];\n\n    const dynamicOptions = getDynamicOptions();\n\n    return queryString\n      ? [\n          ...dynamicOptions,\n          ...baseOptions.filter((option) => {\n            const queryRegex = new RegExp(queryString, 'gi');\n            return queryRegex.exec(option.title) || option.keywords != null\n              ? option.keywords.some((keyword) => {\n                  queryRegex.lastIndex = 0;\n                  return queryRegex.exec(keyword);\n                })\n              : false;\n          }),\n        ]\n      : baseOptions;\n  }, [editor, getDynamicOptions, queryString, showModal]);\n\n  const onSelectOption = useCallback(\n    (\n      selectedOption: ComponentPickerOption,\n      nodeToRemove: TextNode | null,\n      closeMenu: () => void,\n      matchingString: string,\n    ) => {\n      editor.update(() => {\n        if (nodeToRemove) {\n          nodeToRemove.remove();\n        }\n        selectedOption.onSelect(matchingString);\n        closeMenu();\n      });\n    },\n    [editor],\n  );\n\n  return (\n    <>\n      {modal}\n      <LexicalTypeaheadMenuPlugin<ComponentPickerOption>\n        onQueryChange={setQueryString}\n        onSelectOption={onSelectOption}\n        triggerFn={checkForTriggerMatch}\n        options={options}\n        menuRenderFn={(\n          anchorElement,\n          {selectedIndex, selectOptionAndCleanUp, setHighlightedIndex},\n        ) =>\n          anchorElement && options.length\n            ? ReactDOM.createPortal(\n                <ul>\n                  {options.map((option, i: number) => (\n                    <ComponentPickerMenuItem\n                      index={i}\n                      isSelected={selectedIndex === i}\n                      onClick={() => {\n                        setHighlightedIndex(i);\n                        selectOptionAndCleanUp(option);\n                      }}\n                      onMouseEnter={() => {\n                        setHighlightedIndex(i);\n                      }}\n                      key={option.key}\n                      option={option}\n                    />\n                  ))}\n                </ul>,\n                anchorElement,\n              )\n            : null\n        }\n      />\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $createHorizontalRuleNode,\n  INSERT_HORIZONTAL_RULE_COMMAND,\n} from '@lexical/react/LexicalHorizontalRuleNode';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nexport default function HorizontalRulePlugin(): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return editor.registerCommand(\n      INSERT_HORIZONTAL_RULE_COMMAND,\n      (type) => {\n        const selection = $getSelection();\n\n        if (!$isRangeSelection(selection)) {\n          return false;\n        }\n\n        const focusNode = selection.focus.getNode();\n\n        if (focusNode !== null) {\n          const horizontalRuleNode = $createHorizontalRuleNode();\n          selection.insertParagraph();\n          selection.focus\n            .getNode()\n            .getTopLevelElementOrThrow()\n            .insertBefore(horizontalRuleNode);\n        }\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {RangeSelection} from 'lexical';\n\nimport {$getListDepth, $isListItemNode, $isListNode} from '@lexical/list';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isElementNode,\n  $isRangeSelection,\n  COMMAND_PRIORITY_CRITICAL,\n  ElementNode,\n  INDENT_CONTENT_COMMAND,\n} from 'lexical';\nimport {useEffect} from 'react';\n\ntype Props = Readonly<{\n  maxDepth: number | null | undefined;\n}>;\n\nfunction getElementNodesInSelection(\n  selection: RangeSelection,\n): Set<ElementNode> {\n  const nodesInSelection = selection.getNodes();\n\n  if (nodesInSelection.length === 0) {\n    return new Set([\n      selection.anchor.getNode().getParentOrThrow(),\n      selection.focus.getNode().getParentOrThrow(),\n    ]);\n  }\n\n  return new Set(\n    nodesInSelection.map((n) => ($isElementNode(n) ? n : n.getParentOrThrow())),\n  );\n}\n\nfunction isIndentPermitted(maxDepth: number): boolean {\n  const selection = $getSelection();\n\n  if (!$isRangeSelection(selection)) {\n    return false;\n  }\n\n  const elementNodesInSelection: Set<ElementNode> =\n    getElementNodesInSelection(selection);\n\n  let totalDepth = 0;\n\n  for (const elementNode of elementNodesInSelection) {\n    if ($isListNode(elementNode)) {\n      totalDepth = Math.max($getListDepth(elementNode) + 1, totalDepth);\n    } else if ($isListItemNode(elementNode)) {\n      const parent = elementNode.getParent();\n\n      if (!$isListNode(parent)) {\n        throw new Error(\n          'ListMaxIndentLevelPlugin: A ListItemNode must have a ListNode for a parent.',\n        );\n      }\n\n      totalDepth = Math.max($getListDepth(parent) + 1, totalDepth);\n    }\n  }\n\n  return totalDepth <= maxDepth;\n}\n\nexport default function ListMaxIndentLevelPlugin({maxDepth}: Props): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return editor.registerCommand(\n      INDENT_CONTENT_COMMAND,\n      () => !isIndentPermitted(maxDepth ?? 7),\n      COMMAND_PRIORITY_CRITICAL,\n    );\n  }, [editor, maxDepth]);\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {MarkdownShortcutPlugin} from '@lexical/react/LexicalMarkdownShortcutPlugin';\nimport * as React from 'react';\n\nimport {PLAYGROUND_TRANSFORMERS} from '../MarkdownTransformers';\n\nexport default function MarkdownPlugin(): JSX.Element {\n  return <MarkdownShortcutPlugin transformers={PLAYGROUND_TRANSFORMERS} />;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $setSelection,\n  FOCUS_COMMAND,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nconst COMMAND_PRIORITY_LOW = 1;\nconst TAB_TO_FOCUS_INTERVAL = 100;\n\nlet lastTabKeyDownTimestamp = 0;\nlet hasRegisteredKeyDownListener = false;\n\nfunction registerKeyTimeStampTracker() {\n  window.addEventListener(\n    'keydown',\n    (event: KeyboardEvent) => {\n      // Tab\n      if (event.keyCode === 9) {\n        lastTabKeyDownTimestamp = event.timeStamp;\n      }\n    },\n    true,\n  );\n}\n\nexport default function TabFocusPlugin(): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!hasRegisteredKeyDownListener) {\n      registerKeyTimeStampTracker();\n      hasRegisteredKeyDownListener = true;\n    }\n\n    return editor.registerCommand(\n      FOCUS_COMMAND,\n      (event: FocusEvent) => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection)) {\n          if (\n            lastTabKeyDownTimestamp + TAB_TO_FOCUS_INTERVAL >\n            event.timeStamp\n          ) {\n            $setSelection(selection.clone());\n          }\n        }\n        return false;\n      },\n      COMMAND_PRIORITY_LOW,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport type {Cell} from '@lexical/table';\nimport type {LexicalEditor} from 'lexical';\n\nimport './index.css';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getTableColumnIndexFromTableCellNode,\n  $getTableNodeFromLexicalNodeOrThrow,\n  $getTableRowIndexFromTableCellNode,\n  $isTableCellNode,\n  $isTableRowNode,\n  getCellFromTarget,\n} from '@lexical/table';\nimport {\n  $getNearestNodeFromDOMNode,\n  $getSelection,\n  $isGridSelection,\n  COMMAND_PRIORITY_HIGH,\n  SELECTION_CHANGE_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {\n  MouseEventHandler,\n  ReactPortal,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport {createPortal} from 'react-dom';\n\ntype MousePosition = {\n  x: number;\n  y: number;\n};\n\ntype MouseDraggingDirection = 'right' | 'bottom';\n\nconst MIN_ROW_HEIGHT = 33;\nconst MIN_COLUMN_WIDTH = 50;\n\nfunction TableCellResizer({editor}: {editor: LexicalEditor}): JSX.Element {\n  const targetRef = useRef<HTMLElement | null>(null);\n  const resizerRef = useRef<HTMLDivElement | null>(null);\n  const tableRectRef = useRef<ClientRect | null>(null);\n\n  const mouseStartPosRef = useRef<MousePosition | null>(null);\n  const [mouseCurrentPos, updateMouseCurrentPos] =\n    useState<MousePosition | null>(null);\n\n  const [activeCell, updateActiveCell] = useState<Cell | null>(null);\n  const [isSelectingGrid, updateIsSelectingGrid] = useState<boolean>(false);\n  const [draggingDirection, updateDraggingDirection] =\n    useState<MouseDraggingDirection | null>(null);\n\n  useEffect(() => {\n    return editor.registerCommand(\n      SELECTION_CHANGE_COMMAND,\n      (payload) => {\n        const selection = $getSelection();\n        const isGridSelection = $isGridSelection(selection);\n\n        if (isSelectingGrid !== isGridSelection) {\n          updateIsSelectingGrid(isGridSelection);\n        }\n\n        return false;\n      },\n      COMMAND_PRIORITY_HIGH,\n    );\n  });\n\n  const resetState = useCallback(() => {\n    updateActiveCell(null);\n    targetRef.current = null;\n    updateDraggingDirection(null);\n    mouseStartPosRef.current = null;\n    tableRectRef.current = null;\n  }, []);\n\n  useEffect(() => {\n    const onMouseMove = (event: MouseEvent) => {\n      setTimeout(() => {\n        const target = event.target;\n\n        if (draggingDirection) {\n          updateMouseCurrentPos({\n            x: event.clientX,\n            y: event.clientY,\n          });\n          return;\n        }\n\n        if (resizerRef.current && resizerRef.current.contains(target as Node)) {\n          return;\n        }\n\n        if (targetRef.current !== target) {\n          targetRef.current = target as HTMLElement;\n          const cell = getCellFromTarget(target as HTMLElement);\n\n          if (cell && activeCell !== cell) {\n            editor.update(() => {\n              const tableCellNode = $getNearestNodeFromDOMNode(cell.elem);\n              if (!tableCellNode) {\n                throw new Error('TableCellResizer: Table cell node not found.');\n              }\n\n              const tableNode =\n                $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n              const tableElement = editor.getElementByKey(tableNode.getKey());\n\n              if (!tableElement) {\n                throw new Error('TableCellResizer: Table element not found.');\n              }\n\n              targetRef.current = target as HTMLElement;\n              tableRectRef.current = tableElement.getBoundingClientRect();\n              updateActiveCell(cell);\n            });\n          } else if (cell == null) {\n            resetState();\n          }\n        }\n      }, 0);\n    };\n\n    document.addEventListener('mousemove', onMouseMove);\n\n    return () => {\n      document.removeEventListener('mousemove', onMouseMove);\n    };\n  }, [activeCell, draggingDirection, editor, resetState]);\n\n  const isHeightChanging = (direction: MouseDraggingDirection) => {\n    if (direction === 'bottom') return true;\n    return false;\n  };\n\n  const updateRowHeight = useCallback(\n    (newHeight: number) => {\n      if (!activeCell) {\n        throw new Error('TableCellResizer: Expected active cell.');\n      }\n\n      editor.update(() => {\n        const tableCellNode = $getNearestNodeFromDOMNode(activeCell.elem);\n        if (!$isTableCellNode(tableCellNode)) {\n          throw new Error('TableCellResizer: Table cell node not found.');\n        }\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        const tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n\n        const tableRows = tableNode.getChildren();\n\n        if (tableRowIndex >= tableRows.length || tableRowIndex < 0) {\n          throw new Error('Expected table cell to be inside of table row.');\n        }\n\n        const tableRow = tableRows[tableRowIndex];\n\n        if (!$isTableRowNode(tableRow)) {\n          throw new Error('Expected table row');\n        }\n\n        tableRow.setHeight(newHeight);\n      });\n    },\n    [activeCell, editor],\n  );\n\n  const updateColumnWidth = useCallback(\n    (newWidth: number) => {\n      if (!activeCell) {\n        throw new Error('TableCellResizer: Expected active cell.');\n      }\n      editor.update(() => {\n        const tableCellNode = $getNearestNodeFromDOMNode(activeCell.elem);\n        if (!$isTableCellNode(tableCellNode)) {\n          throw new Error('TableCellResizer: Table cell node not found.');\n        }\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        const tableColumnIndex =\n          $getTableColumnIndexFromTableCellNode(tableCellNode);\n\n        const tableRows = tableNode.getChildren();\n\n        for (let r = 0; r < tableRows.length; r++) {\n          const tableRow = tableRows[r];\n\n          if (!$isTableRowNode(tableRow)) {\n            throw new Error('Expected table row');\n          }\n\n          const tableCells = tableRow.getChildren();\n\n          if (tableColumnIndex >= tableCells.length || tableColumnIndex < 0) {\n            throw new Error('Expected table cell to be inside of table row.');\n          }\n\n          const tableCell = tableCells[tableColumnIndex];\n\n          if (!$isTableCellNode(tableCell)) {\n            throw new Error('Expected table cell');\n          }\n\n          tableCell.setWidth(newWidth);\n        }\n      });\n    },\n    [activeCell, editor],\n  );\n\n  const toggleResize = useCallback(\n    (direction: MouseDraggingDirection): MouseEventHandler<HTMLDivElement> =>\n      (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if (!activeCell) {\n          throw new Error('TableCellResizer: Expected active cell.');\n        }\n\n        if (draggingDirection === direction && mouseStartPosRef.current) {\n          const {x, y} = mouseStartPosRef.current;\n\n          if (activeCell === null) {\n            return;\n          }\n\n          const {height, width} = activeCell.elem.getBoundingClientRect();\n\n          if (isHeightChanging(direction)) {\n            const heightChange = Math.abs(event.clientY - y);\n\n            const isShrinking = direction === 'bottom' && y > event.clientY;\n\n            updateRowHeight(\n              Math.max(\n                isShrinking ? height - heightChange : heightChange + height,\n                MIN_ROW_HEIGHT,\n              ),\n            );\n          } else {\n            const widthChange = Math.abs(event.clientX - x);\n\n            const isShrinking = direction === 'right' && x > event.clientX;\n\n            updateColumnWidth(\n              Math.max(\n                isShrinking ? width - widthChange : widthChange + width,\n                MIN_COLUMN_WIDTH,\n              ),\n            );\n          }\n\n          resetState();\n        } else {\n          mouseStartPosRef.current = {\n            x: event.clientX,\n            y: event.clientY,\n          };\n          updateMouseCurrentPos(mouseStartPosRef.current);\n          updateDraggingDirection(direction);\n        }\n      },\n    [\n      activeCell,\n      draggingDirection,\n      resetState,\n      updateColumnWidth,\n      updateRowHeight,\n    ],\n  );\n\n  const getResizers = useCallback(() => {\n    if (activeCell) {\n      const {height, width, top, left} =\n        activeCell.elem.getBoundingClientRect();\n\n      const styles = {\n        bottom: {\n          backgroundColor: 'none',\n          cursor: 'row-resize',\n          height: '10px',\n          left: `${window.pageXOffset + left}px`,\n          top: `${window.pageYOffset + top + height}px`,\n          width: `${width}px`,\n        },\n        right: {\n          backgroundColor: 'none',\n          cursor: 'col-resize',\n          height: `${height}px`,\n          left: `${window.pageXOffset + left + width}px`,\n          top: `${window.pageYOffset + top}px`,\n          width: '10px',\n        },\n      };\n\n      const tableRect = tableRectRef.current;\n\n      if (draggingDirection && mouseCurrentPos && tableRect) {\n        if (isHeightChanging(draggingDirection)) {\n          styles[draggingDirection].left = `${\n            window.pageXOffset + tableRect.left\n          }px`;\n          styles[draggingDirection].top = `${\n            window.pageYOffset + mouseCurrentPos.y\n          }px`;\n          styles[draggingDirection].height = '3px';\n          styles[draggingDirection].width = `${tableRect.width}px`;\n        } else {\n          styles[draggingDirection].top = `${\n            window.pageYOffset + tableRect.top\n          }px`;\n          styles[draggingDirection].left = `${\n            window.pageXOffset + mouseCurrentPos.x\n          }px`;\n          styles[draggingDirection].width = '3px';\n          styles[draggingDirection].height = `${tableRect.height}px`;\n        }\n\n        styles[draggingDirection].backgroundColor = '#adf';\n      }\n\n      return styles;\n    }\n\n    return {\n      bottom: null,\n      left: null,\n      right: null,\n      top: null,\n    };\n  }, [activeCell, draggingDirection, mouseCurrentPos]);\n\n  const resizerStyles = getResizers();\n\n  return (\n    <div ref={resizerRef}>\n      {activeCell != null && !isSelectingGrid && (\n        <>\n          <div\n            className=\"TableCellResizer__resizer TableCellResizer__ui\"\n            style={resizerStyles.right || undefined}\n            onMouseDown={toggleResize('right')}\n            onMouseUp={toggleResize('right')}\n          />\n          <div\n            className=\"TableCellResizer__resizer TableCellResizer__ui\"\n            style={resizerStyles.bottom || undefined}\n            onMouseDown={toggleResize('bottom')}\n            onMouseUp={toggleResize('bottom')}\n          />\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default function TableCellResizerPlugin(): ReactPortal {\n  const [editor] = useLexicalComposerContext();\n\n  return useMemo(\n    () => createPortal(<TableCellResizer editor={editor} />, document.body),\n    [editor],\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport const CAN_USE_DOM: boolean =\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined';\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useEffect, useLayoutEffect} from 'react';\nimport {CAN_USE_DOM} from './canUseDOM';\n\nconst useLayoutEffectImpl: typeof useLayoutEffect = CAN_USE_DOM\n  ? useLayoutEffect\n  : useEffect;\n\nexport default useLayoutEffectImpl;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {EditorThemeClasses} from 'lexical';\n\nimport './PlaygroundEditorTheme.css';\n\nconst theme: EditorThemeClasses = {\n  characterLimit: 'PlaygroundEditorTheme__characterLimit',\n  code: 'PlaygroundEditorTheme__code',\n  codeHighlight: {\n    atrule: 'PlaygroundEditorTheme__tokenAttr',\n    attr: 'PlaygroundEditorTheme__tokenAttr',\n    boolean: 'PlaygroundEditorTheme__tokenProperty',\n    builtin: 'PlaygroundEditorTheme__tokenSelector',\n    cdata: 'PlaygroundEditorTheme__tokenComment',\n    char: 'PlaygroundEditorTheme__tokenSelector',\n    class: 'PlaygroundEditorTheme__tokenFunction',\n    'class-name': 'PlaygroundEditorTheme__tokenFunction',\n    comment: 'PlaygroundEditorTheme__tokenComment',\n    constant: 'PlaygroundEditorTheme__tokenProperty',\n    deleted: 'PlaygroundEditorTheme__tokenProperty',\n    doctype: 'PlaygroundEditorTheme__tokenComment',\n    entity: 'PlaygroundEditorTheme__tokenOperator',\n    function: 'PlaygroundEditorTheme__tokenFunction',\n    important: 'PlaygroundEditorTheme__tokenVariable',\n    inserted: 'PlaygroundEditorTheme__tokenSelector',\n    keyword: 'PlaygroundEditorTheme__tokenAttr',\n    namespace: 'PlaygroundEditorTheme__tokenVariable',\n    number: 'PlaygroundEditorTheme__tokenProperty',\n    operator: 'PlaygroundEditorTheme__tokenOperator',\n    prolog: 'PlaygroundEditorTheme__tokenComment',\n    property: 'PlaygroundEditorTheme__tokenProperty',\n    punctuation: 'PlaygroundEditorTheme__tokenPunctuation',\n    regex: 'PlaygroundEditorTheme__tokenVariable',\n    selector: 'PlaygroundEditorTheme__tokenSelector',\n    string: 'PlaygroundEditorTheme__tokenSelector',\n    symbol: 'PlaygroundEditorTheme__tokenProperty',\n    tag: 'PlaygroundEditorTheme__tokenProperty',\n    url: 'PlaygroundEditorTheme__tokenOperator',\n    variable: 'PlaygroundEditorTheme__tokenVariable',\n  },\n  embedBlock: {\n    base: 'PlaygroundEditorTheme__embedBlock',\n    focus: 'PlaygroundEditorTheme__embedBlockFocus',\n  },\n  hashtag: 'PlaygroundEditorTheme__hashtag',\n  heading: {\n    h1: 'PlaygroundEditorTheme__h1',\n    h2: 'PlaygroundEditorTheme__h2',\n    h3: 'PlaygroundEditorTheme__h3',\n    h4: 'PlaygroundEditorTheme__h4',\n    h5: 'PlaygroundEditorTheme__h5',\n    h6: 'PlaygroundEditorTheme__h6',\n  },\n  image: 'editor-image',\n  link: 'PlaygroundEditorTheme__link',\n  list: {\n    listitem: 'PlaygroundEditorTheme__listItem',\n    listitemChecked: 'PlaygroundEditorTheme__listItemChecked',\n    listitemUnchecked: 'PlaygroundEditorTheme__listItemUnchecked',\n    nested: {\n      listitem: 'PlaygroundEditorTheme__nestedListItem',\n    },\n    olDepth: [\n      'PlaygroundEditorTheme__ol1',\n      'PlaygroundEditorTheme__ol2',\n      'PlaygroundEditorTheme__ol3',\n      'PlaygroundEditorTheme__ol4',\n      'PlaygroundEditorTheme__ol5',\n    ],\n    ul: 'PlaygroundEditorTheme__ul',\n  },\n  ltr: 'PlaygroundEditorTheme__ltr',\n  mark: 'PlaygroundEditorTheme__mark',\n  markOverlap: 'PlaygroundEditorTheme__markOverlap',\n  paragraph: 'PlaygroundEditorTheme__paragraph',\n  quote: 'PlaygroundEditorTheme__quote',\n  rtl: 'PlaygroundEditorTheme__rtl',\n  table: 'PlaygroundEditorTheme__table',\n  tableCell: 'PlaygroundEditorTheme__tableCell',\n  tableCellHeader: 'PlaygroundEditorTheme__tableCellHeader',\n  text: {\n    bold: 'PlaygroundEditorTheme__textBold',\n    code: 'PlaygroundEditorTheme__textCode',\n    italic: 'PlaygroundEditorTheme__textItalic',\n    strikethrough: 'PlaygroundEditorTheme__textStrikethrough',\n    subscript: 'PlaygroundEditorTheme__textSubscript',\n    superscript: 'PlaygroundEditorTheme__textSuperscript',\n    underline: 'PlaygroundEditorTheme__textUnderline',\n    underlineStrikethrough: 'PlaygroundEditorTheme__textUnderlineStrikethrough',\n  },\n};\n\nexport default theme;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorState,\n  LexicalCommand,\n  LexicalEditor,\n  NodeKey,\n} from 'lexical';\nimport type {Doc} from 'yjs';\n\nimport './index.css';\n\nimport {\n  $createMarkNode,\n  $getMarkIDs,\n  $isMarkNode,\n  $unwrapMarkNode,\n  $wrapSelectionInMarkNode,\n  MarkNode,\n} from '@lexical/mark';\nimport {AutoFocusPlugin} from '@lexical/react/LexicalAutoFocusPlugin';\nimport {ClearEditorPlugin} from '@lexical/react/LexicalClearEditorPlugin';\nimport {useCollaborationContext} from '@lexical/react/LexicalCollaborationPlugin';\nimport {LexicalComposer} from '@lexical/react/LexicalComposer';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {HistoryPlugin} from '@lexical/react/LexicalHistoryPlugin';\nimport {OnChangePlugin} from '@lexical/react/LexicalOnChangePlugin';\nimport {PlainTextPlugin} from '@lexical/react/LexicalPlainTextPlugin';\nimport {createDOMRange, createRectsFromDOMRange} from '@lexical/selection';\nimport {$isRootTextContentEmpty, $rootTextContent} from '@lexical/text';\nimport {mergeRegister, registerNestedElementResolver} from '@lexical/utils';\nimport {\n  $getNodeByKey,\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  CLEAR_EDITOR_COMMAND,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n  KEY_ESCAPE_COMMAND,\n} from 'lexical';\nimport {useCallback, useEffect, useMemo, useRef, useState} from 'react';\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\nimport useLayoutEffect from '../../nodes/shared/useLayoutEffect';\nimport {WebsocketProvider} from 'y-websocket';\n\nimport {\n  Comment,\n  Comments,\n  CommentStore,\n  createComment,\n  createThread,\n  Thread,\n  useCommentStore,\n} from '../../commenting';\nimport useModal from '../../hooks/useModal';\nimport CommentEditorTheme from '../../themes/CommentEditorTheme';\nimport Button from '../../ui/Button';\nimport ContentEditable from '../../ui/ContentEditable';\nimport Placeholder from '../../ui/Placeholder';\n\nexport const INSERT_INLINE_COMMAND: LexicalCommand<void> = createCommand();\n\nfunction AddCommentBox({\n  anchorKey,\n  editor,\n  onAddComment,\n}: {\n  anchorKey: NodeKey;\n  editor: LexicalEditor;\n  onAddComment: () => void;\n}): JSX.Element {\n  const boxRef = useRef<HTMLDivElement>(null);\n\n  const updatePosition = useCallback(() => {\n    const boxElem = boxRef.current;\n    const rootElement = editor.getRootElement();\n    const anchorElement = editor.getElementByKey(anchorKey);\n\n    if (boxElem !== null && rootElement !== null && anchorElement !== null) {\n      const {right} = rootElement.getBoundingClientRect();\n      const {top} = anchorElement.getBoundingClientRect();\n      boxElem.style.left = `${right - 20}px`;\n      boxElem.style.top = `${top - 30}px`;\n    }\n  }, [anchorKey, editor]);\n\n  useEffect(() => {\n    window.addEventListener('resize', updatePosition);\n\n    return () => {\n      window.removeEventListener('resize', updatePosition);\n    };\n  }, [editor, updatePosition]);\n\n  useLayoutEffect(() => {\n    updatePosition();\n  }, [anchorKey, editor, updatePosition]);\n\n  return (\n    <div className=\"CommentPlugin_AddCommentBox\" ref={boxRef}>\n      <button\n        className=\"CommentPlugin_AddCommentBox_button\"\n        onClick={onAddComment}>\n        <i className=\"icon add-comment\" />\n      </button>\n    </div>\n  );\n}\n\nfunction EditorRefPlugin({\n  editorRef,\n}: {\n  editorRef: {current: null | LexicalEditor};\n}): null {\n  const [editor] = useLexicalComposerContext();\n\n  useLayoutEffect(() => {\n    editorRef.current = editor;\n    return () => {\n      editorRef.current = null;\n    };\n  }, [editor, editorRef]);\n\n  return null;\n}\n\nfunction EscapeHandlerPlugin({\n  onEscape,\n}: {\n  onEscape: (e: KeyboardEvent) => boolean;\n}): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return editor.registerCommand(\n      KEY_ESCAPE_COMMAND,\n      (event: KeyboardEvent) => {\n        return onEscape(event);\n      },\n      2,\n    );\n  }, [editor, onEscape]);\n\n  return null;\n}\n\nfunction PlainTextEditor({\n  className,\n  autoFocus,\n  onEscape,\n  onChange,\n  editorRef,\n  placeholder = 'Type a comment...',\n}: {\n  autoFocus?: boolean;\n  className?: string;\n  editorRef?: {current: null | LexicalEditor};\n  onChange: (editorState: EditorState, editor: LexicalEditor) => void;\n  onEscape: (e: KeyboardEvent) => boolean;\n  placeholder?: string;\n}) {\n  const initialConfig = {\n    namespace: 'Commenting',\n    nodes: [],\n    onError: (error: Error) => {\n      throw error;\n    },\n    theme: CommentEditorTheme,\n  };\n\n  return (\n    <LexicalComposer initialConfig={initialConfig}>\n      <div className=\"CommentPlugin_CommentInputBox_EditorContainer\">\n        <PlainTextPlugin\n          contentEditable={<ContentEditable className={className} />}\n          placeholder={<Placeholder>{placeholder}</Placeholder>}\n        />\n        <OnChangePlugin onChange={onChange} />\n        <HistoryPlugin />\n        {autoFocus !== false && <AutoFocusPlugin />}\n        <EscapeHandlerPlugin onEscape={onEscape} />\n        <ClearEditorPlugin />\n        {editorRef !== undefined && <EditorRefPlugin editorRef={editorRef} />}\n      </div>\n    </LexicalComposer>\n  );\n}\n\nfunction useOnChange(\n  setContent: (text: string) => void,\n  setCanSubmit: (canSubmit: boolean) => void,\n) {\n  return useCallback(\n    (editorState: EditorState, _editor: LexicalEditor) => {\n      editorState.read(() => {\n        setContent($rootTextContent());\n        setCanSubmit(!$isRootTextContentEmpty(_editor.isComposing(), true));\n      });\n    },\n    [setCanSubmit, setContent],\n  );\n}\n\nfunction CommentInputBox({\n  editor,\n  cancelAddComment,\n  submitAddComment,\n}: {\n  cancelAddComment: () => void;\n  editor: LexicalEditor;\n  submitAddComment: (\n    commentOrThread: Comment | Thread,\n    isInlineComment: boolean,\n  ) => void;\n}) {\n  const [content, setContent] = useState('');\n  const [canSubmit, setCanSubmit] = useState(false);\n  const boxRef = useRef<HTMLDivElement>(null);\n  const selectionState = useMemo(\n    () => ({\n      container: document.createElement('div'),\n      elements: [],\n    }),\n    [],\n  );\n  const author = useCollabAuthorName();\n\n  const updateLocation = useCallback(() => {\n    editor.getEditorState().read(() => {\n      const selection = $getSelection();\n\n      if ($isRangeSelection(selection)) {\n        const anchor = selection.anchor;\n        const focus = selection.focus;\n        const range = createDOMRange(\n          editor,\n          anchor.getNode(),\n          anchor.offset,\n          focus.getNode(),\n          focus.offset,\n        );\n        const boxElem = boxRef.current;\n        if (range !== null && boxElem !== null) {\n          const {left, bottom, width} = range.getBoundingClientRect();\n          const selectionRects = createRectsFromDOMRange(editor, range);\n          let correctedLeft =\n            selectionRects.length === 1 ? left + width / 2 - 125 : left - 125;\n          if (correctedLeft < 10) {\n            correctedLeft = 10;\n          }\n          boxElem.style.left = `${correctedLeft}px`;\n          boxElem.style.top = `${bottom + 20}px`;\n          const selectionRectsLength = selectionRects.length;\n          const {container} = selectionState;\n          const elements: Array<HTMLSpanElement> = selectionState.elements;\n          const elementsLength = elements.length;\n\n          for (let i = 0; i < selectionRectsLength; i++) {\n            const selectionRect = selectionRects[i];\n            let elem: HTMLSpanElement = elements[i];\n            if (elem === undefined) {\n              elem = document.createElement('span');\n              elements[i] = elem;\n              container.appendChild(elem);\n            }\n            const color = '255, 212, 0';\n            const style = `position:absolute;top:${selectionRect.top}px;left:${selectionRect.left}px;height:${selectionRect.height}px;width:${selectionRect.width}px;background-color:rgba(${color}, 0.3);pointer-events:none;z-index:5;`;\n            elem.style.cssText = style;\n          }\n          for (let i = elementsLength - 1; i >= selectionRectsLength; i--) {\n            const elem = elements[i];\n            container.removeChild(elem);\n            elements.pop();\n          }\n        }\n      }\n    });\n  }, [editor, selectionState]);\n\n  useLayoutEffect(() => {\n    updateLocation();\n    const container = selectionState.container;\n    const body = document.body;\n    if (body !== null) {\n      body.appendChild(container);\n      return () => {\n        body.removeChild(container);\n      };\n    }\n  }, [selectionState.container, updateLocation]);\n\n  useEffect(() => {\n    window.addEventListener('resize', updateLocation);\n\n    return () => {\n      window.removeEventListener('resize', updateLocation);\n    };\n  }, [updateLocation]);\n\n  const onEscape = (event: KeyboardEvent): boolean => {\n    event.preventDefault();\n    cancelAddComment();\n    return true;\n  };\n\n  const submitComment = () => {\n    if (canSubmit) {\n      let quote = editor.getEditorState().read(() => {\n        const selection = $getSelection();\n        return selection !== null ? selection.getTextContent() : '';\n      });\n      if (quote.length > 100) {\n        quote = quote.slice(0, 99) + '…';\n      }\n      submitAddComment(\n        createThread(quote, [createComment(content, author)]),\n        true,\n      );\n    }\n  };\n\n  const onChange = useOnChange(setContent, setCanSubmit);\n\n  return (\n    <div className=\"CommentPlugin_CommentInputBox\" ref={boxRef}>\n      <PlainTextEditor\n        className=\"CommentPlugin_CommentInputBox_Editor\"\n        onEscape={onEscape}\n        onChange={onChange}\n      />\n      <div className=\"CommentPlugin_CommentInputBox_Buttons\">\n        <Button\n          onClick={cancelAddComment}\n          className=\"CommentPlugin_CommentInputBox_Button\">\n          Cancel\n        </Button>\n        <Button\n          onClick={submitComment}\n          disabled={!canSubmit}\n          className=\"CommentPlugin_CommentInputBox_Button primary\">\n          Comment\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nfunction CommentsComposer({\n  submitAddComment,\n  thread,\n  placeholder,\n}: {\n  placeholder?: string;\n  submitAddComment: (\n    commentOrThread: Comment,\n    isInlineComment: boolean,\n    // eslint-disable-next-line no-shadow\n    thread?: Thread,\n  ) => void;\n  thread?: Thread;\n}) {\n  const [content, setContent] = useState('');\n  const [canSubmit, setCanSubmit] = useState(false);\n  const editorRef = useRef<LexicalEditor>(null);\n  const author = useCollabAuthorName();\n\n  const onChange = useOnChange(setContent, setCanSubmit);\n\n  const submitComment = () => {\n    if (canSubmit) {\n      submitAddComment(createComment(content, author), false, thread);\n      const editor = editorRef.current;\n      if (editor !== null) {\n        editor.dispatchCommand(CLEAR_EDITOR_COMMAND, undefined);\n      }\n    }\n  };\n\n  return (\n    <>\n      <PlainTextEditor\n        className=\"CommentPlugin_CommentsPanel_Editor\"\n        autoFocus={false}\n        onEscape={() => {\n          return true;\n        }}\n        onChange={onChange}\n        editorRef={editorRef}\n        placeholder={placeholder}\n      />\n      <Button\n        className=\"CommentPlugin_CommentsPanel_SendButton\"\n        onClick={submitComment}\n        disabled={!canSubmit}>\n        <i className=\"send\" />\n      </Button>\n    </>\n  );\n}\n\nfunction ShowDeleteCommentOrThreadDialog({\n  commentOrThread,\n  deleteCommentOrThread,\n  onClose,\n  thread = undefined,\n}: {\n  commentOrThread: Comment | Thread;\n\n  deleteCommentOrThread: (\n    comment: Comment | Thread,\n    // eslint-disable-next-line no-shadow\n    thread?: Thread,\n  ) => void;\n  onClose: () => void;\n  thread?: Thread;\n}): JSX.Element {\n  return (\n    <>\n      Are you sure you want to delete this {commentOrThread.type}?\n      <div className=\"Modal__content\">\n        <Button\n          onClick={() => {\n            deleteCommentOrThread(commentOrThread, thread);\n            onClose();\n          }}>\n          Delete\n        </Button>{' '}\n        <Button\n          onClick={() => {\n            onClose();\n          }}>\n          Cancel\n        </Button>\n      </div>\n    </>\n  );\n}\n\nfunction CommentsPanelListComment({\n  comment,\n  deleteComment,\n  thread,\n  rtf,\n}: {\n  comment: Comment;\n  deleteComment: (\n    commentOrThread: Comment | Thread,\n    // eslint-disable-next-line no-shadow\n    thread?: Thread,\n  ) => void;\n  rtf: Intl.RelativeTimeFormat;\n  thread?: Thread;\n}): JSX.Element {\n  const seconds = Math.round((comment.timeStamp - performance.now()) / 1000);\n  const minutes = Math.round(seconds / 60);\n  const [modal, showModal] = useModal();\n\n  return (\n    <li className=\"CommentPlugin_CommentsPanel_List_Comment\">\n      <div className=\"CommentPlugin_CommentsPanel_List_Details\">\n        <span className=\"CommentPlugin_CommentsPanel_List_Comment_Author\">\n          {comment.author}\n        </span>\n        <span className=\"CommentPlugin_CommentsPanel_List_Comment_Time\">\n          · {seconds > -10 ? 'Just now' : rtf.format(minutes, 'minute')}\n        </span>\n      </div>\n      <p\n        className={\n          comment.deleted ? 'CommentPlugin_CommentsPanel_DeletedComment' : ''\n        }>\n        {comment.content}\n      </p>\n      {!comment.deleted && (\n        <>\n          <Button\n            onClick={() => {\n              showModal('Delete Comment', (onClose) => (\n                <ShowDeleteCommentOrThreadDialog\n                  commentOrThread={comment}\n                  deleteCommentOrThread={deleteComment}\n                  thread={thread}\n                  onClose={onClose}\n                />\n              ));\n            }}\n            className=\"CommentPlugin_CommentsPanel_List_DeleteButton\">\n            <i className=\"delete\" />\n          </Button>\n          {modal}\n        </>\n      )}\n    </li>\n  );\n}\n\nfunction CommentsPanelList({\n  activeIDs,\n  comments,\n  deleteCommentOrThread,\n  listRef,\n  submitAddComment,\n  markNodeMap,\n}: {\n  activeIDs: Array<string>;\n  comments: Comments;\n  deleteCommentOrThread: (\n    commentOrThread: Comment | Thread,\n    thread?: Thread,\n  ) => void;\n  listRef: {current: null | HTMLUListElement};\n  markNodeMap: Map<string, Set<NodeKey>>;\n  submitAddComment: (\n    commentOrThread: Comment | Thread,\n    isInlineComment: boolean,\n    thread?: Thread,\n  ) => void;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [counter, setCounter] = useState(0);\n  const [modal, showModal] = useModal();\n  const rtf = useMemo(\n    () =>\n      new Intl.RelativeTimeFormat('en', {\n        localeMatcher: 'best fit',\n        numeric: 'auto',\n        style: 'short',\n      }),\n    [],\n  );\n\n  useEffect(() => {\n    // Used to keep the time stamp up to date\n    const id = setTimeout(() => {\n      setCounter(counter + 1);\n    }, 10000);\n\n    return () => {\n      clearTimeout(id);\n    };\n  }, [counter]);\n\n  return (\n    <ul className=\"CommentPlugin_CommentsPanel_List\" ref={listRef}>\n      {comments.map((commentOrThread) => {\n        const id = commentOrThread.id;\n        if (commentOrThread.type === 'thread') {\n          const handleClickThread = () => {\n            const markNodeKeys = markNodeMap.get(id);\n            if (\n              markNodeKeys !== undefined &&\n              (activeIDs === null || activeIDs.indexOf(id) === -1)\n            ) {\n              const activeElement = document.activeElement;\n              // Move selection to the start of the mark, so that we\n              // update the UI with the selected thread.\n              editor.update(\n                () => {\n                  const markNodeKey = Array.from(markNodeKeys)[0];\n                  const markNode = $getNodeByKey<MarkNode>(markNodeKey);\n                  if ($isMarkNode(markNode)) {\n                    markNode.selectStart();\n                  }\n                },\n                {\n                  onUpdate() {\n                    // Restore selection to the previous element\n                    if (activeElement !== null) {\n                      (activeElement as HTMLElement).focus();\n                    }\n                  },\n                },\n              );\n            }\n          };\n\n          return (\n            // eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions\n            <li\n              key={id}\n              onClick={handleClickThread}\n              className={`CommentPlugin_CommentsPanel_List_Thread ${\n                markNodeMap.has(id) ? 'interactive' : ''\n              } ${activeIDs.indexOf(id) === -1 ? '' : 'active'}`}>\n              <div className=\"CommentPlugin_CommentsPanel_List_Thread_QuoteBox\">\n                <blockquote className=\"CommentPlugin_CommentsPanel_List_Thread_Quote\">\n                  {'> '}\n                  <span>{commentOrThread.quote}</span>\n                </blockquote>\n                {/* INTRODUCE DELETE THREAD HERE*/}\n                <Button\n                  onClick={() => {\n                    showModal('Delete Thread', (onClose) => (\n                      <ShowDeleteCommentOrThreadDialog\n                        commentOrThread={commentOrThread}\n                        deleteCommentOrThread={deleteCommentOrThread}\n                        onClose={onClose}\n                      />\n                    ));\n                  }}\n                  className=\"CommentPlugin_CommentsPanel_List_DeleteButton\">\n                  <i className=\"delete\" />\n                </Button>\n                {modal}\n              </div>\n              <ul className=\"CommentPlugin_CommentsPanel_List_Thread_Comments\">\n                {commentOrThread.comments.map((comment) => (\n                  <CommentsPanelListComment\n                    key={comment.id}\n                    comment={comment}\n                    deleteComment={deleteCommentOrThread}\n                    thread={commentOrThread}\n                    rtf={rtf}\n                  />\n                ))}\n              </ul>\n              <div className=\"CommentPlugin_CommentsPanel_List_Thread_Editor\">\n                <CommentsComposer\n                  submitAddComment={submitAddComment}\n                  thread={commentOrThread}\n                  placeholder=\"Reply to comment...\"\n                />\n              </div>\n            </li>\n          );\n        }\n        return (\n          <CommentsPanelListComment\n            key={id}\n            comment={commentOrThread}\n            deleteComment={deleteCommentOrThread}\n            rtf={rtf}\n          />\n        );\n      })}\n    </ul>\n  );\n}\n\nfunction CommentsPanel({\n  activeIDs,\n  deleteCommentOrThread,\n  comments,\n  submitAddComment,\n  markNodeMap,\n}: {\n  activeIDs: Array<string>;\n  comments: Comments;\n  deleteCommentOrThread: (\n    commentOrThread: Comment | Thread,\n    thread?: Thread,\n  ) => void;\n  markNodeMap: Map<string, Set<NodeKey>>;\n  submitAddComment: (\n    commentOrThread: Comment | Thread,\n    isInlineComment: boolean,\n    thread?: Thread,\n  ) => void;\n}): JSX.Element {\n  const listRef = useRef<HTMLUListElement>(null);\n  const isEmpty = comments.length === 0;\n\n  return (\n    <div className=\"CommentPlugin_CommentsPanel\">\n      <h2 className=\"CommentPlugin_CommentsPanel_Heading\">Comments</h2>\n      {isEmpty ? (\n        <div className=\"CommentPlugin_CommentsPanel_Empty\">No Comments</div>\n      ) : (\n        <CommentsPanelList\n          activeIDs={activeIDs}\n          comments={comments}\n          deleteCommentOrThread={deleteCommentOrThread}\n          listRef={listRef}\n          submitAddComment={submitAddComment}\n          markNodeMap={markNodeMap}\n        />\n      )}\n    </div>\n  );\n}\n\nfunction useCollabAuthorName(): string {\n  const collabContext = useCollaborationContext();\n  const {yjsDocMap, name} = collabContext;\n  return yjsDocMap.has('comments') ? name : 'Playground User';\n}\n\nexport default function CommentPlugin({\n  providerFactory,\n}: {\n  providerFactory?: (\n    id: string,\n    yjsDocMap: Map<string, Doc>,\n  ) => WebsocketProvider;\n}): JSX.Element {\n  const collabContext = useCollaborationContext();\n  const [editor] = useLexicalComposerContext();\n  const commentStore = useMemo(() => new CommentStore(editor), [editor]);\n  const comments = useCommentStore(commentStore);\n  const markNodeMap = useMemo<Map<string, Set<NodeKey>>>(() => {\n    return new Map();\n  }, []);\n  const [activeAnchorKey, setActiveAnchorKey] = useState<NodeKey | null>();\n  const [activeIDs, setActiveIDs] = useState<Array<string>>([]);\n  const [showCommentInput, setShowCommentInput] = useState(false);\n  const [showComments, setShowComments] = useState(false);\n  const {yjsDocMap} = collabContext;\n\n  useEffect(() => {\n    if (providerFactory) {\n      const provider = providerFactory('comments', yjsDocMap);\n      return commentStore.registerCollaboration(provider);\n    }\n  }, [commentStore, providerFactory, yjsDocMap]);\n\n  const cancelAddComment = useCallback(() => {\n    editor.update(() => {\n      const selection = $getSelection();\n      // Restore selection\n      if (selection !== null) {\n        selection.dirty = true;\n      }\n    });\n    setShowCommentInput(false);\n  }, [editor]);\n\n  const deleteCommentOrThread = useCallback(\n    (comment: Comment | Thread, thread?: Thread) => {\n      if (comment.type === 'comment') {\n        const deletionInfo = commentStore.deleteCommentOrThread(\n          comment,\n          thread,\n        );\n        if (!deletionInfo) return;\n        const {markedComment, index} = deletionInfo;\n        commentStore.addComment(markedComment, thread, index);\n      } else {\n        commentStore.deleteCommentOrThread(comment);\n        // Remove ids from associated marks\n        const id = thread !== undefined ? thread.id : comment.id;\n        const markNodeKeys = markNodeMap.get(id);\n        if (markNodeKeys !== undefined) {\n          // Do async to avoid causing a React infinite loop\n          setTimeout(() => {\n            editor.update(() => {\n              for (const key of markNodeKeys) {\n                const node: null | MarkNode = $getNodeByKey(key);\n                if ($isMarkNode(node)) {\n                  node.deleteID(id);\n                  if (node.getIDs().length === 0) {\n                    $unwrapMarkNode(node);\n                  }\n                }\n              }\n            });\n          });\n        }\n      }\n    },\n    [commentStore, editor, markNodeMap],\n  );\n\n  const submitAddComment = useCallback(\n    (\n      commentOrThread: Comment | Thread,\n      isInlineComment: boolean,\n      thread?: Thread,\n    ) => {\n      commentStore.addComment(commentOrThread, thread);\n      if (isInlineComment) {\n        editor.update(() => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            const focus = selection.focus;\n            const anchor = selection.anchor;\n            const isBackward = selection.isBackward();\n            const id = commentOrThread.id;\n\n            // Wrap content in a MarkNode\n            $wrapSelectionInMarkNode(selection, isBackward, id);\n\n            // Make selection collapsed at the end\n            if (isBackward) {\n              focus.set(anchor.key, anchor.offset, anchor.type);\n            } else {\n              anchor.set(focus.key, focus.offset, focus.type);\n            }\n          }\n        });\n        setShowCommentInput(false);\n      }\n    },\n    [commentStore, editor],\n  );\n\n  useEffect(() => {\n    const changedElems: Array<HTMLElement> = [];\n    for (let i = 0; i < activeIDs.length; i++) {\n      const id = activeIDs[i];\n      const keys = markNodeMap.get(id);\n      if (keys !== undefined) {\n        for (const key of keys) {\n          const elem = editor.getElementByKey(key);\n          if (elem !== null) {\n            elem.classList.add('selected');\n            changedElems.push(elem);\n            setShowComments(true);\n          }\n        }\n      }\n    }\n    return () => {\n      for (let i = 0; i < changedElems.length; i++) {\n        const changedElem = changedElems[i];\n        changedElem.classList.remove('selected');\n      }\n    };\n  }, [activeIDs, editor, markNodeMap]);\n\n  useEffect(() => {\n    const markNodeKeysToIDs: Map<NodeKey, Array<string>> = new Map();\n\n    return mergeRegister(\n      registerNestedElementResolver<MarkNode>(\n        editor,\n        MarkNode,\n        (from: MarkNode) => {\n          return $createMarkNode(from.getIDs());\n        },\n        (from: MarkNode, to: MarkNode) => {\n          // Merge the IDs\n          const ids = from.getIDs();\n          ids.forEach((id) => {\n            to.addID(id);\n          });\n        },\n      ),\n      editor.registerMutationListener(MarkNode, (mutations) => {\n        editor.getEditorState().read(() => {\n          for (const [key, mutation] of mutations) {\n            const node: null | MarkNode = $getNodeByKey(key);\n            let ids: NodeKey[] = [];\n\n            if (mutation === 'destroyed') {\n              ids = markNodeKeysToIDs.get(key) || [];\n            } else if ($isMarkNode(node)) {\n              ids = node.getIDs();\n            }\n\n            for (let i = 0; i < ids.length; i++) {\n              const id = ids[i];\n              let markNodeKeys = markNodeMap.get(id);\n              markNodeKeysToIDs.set(key, ids);\n\n              if (mutation === 'destroyed') {\n                if (markNodeKeys !== undefined) {\n                  markNodeKeys.delete(key);\n                  if (markNodeKeys.size === 0) {\n                    markNodeMap.delete(id);\n                  }\n                }\n              } else {\n                if (markNodeKeys === undefined) {\n                  markNodeKeys = new Set();\n                  markNodeMap.set(id, markNodeKeys);\n                }\n                if (!markNodeKeys.has(key)) {\n                  markNodeKeys.add(key);\n                }\n              }\n            }\n          }\n        });\n      }),\n      editor.registerUpdateListener(({editorState, tags}) => {\n        editorState.read(() => {\n          const selection = $getSelection();\n          let hasActiveIds = false;\n          let hasAnchorKey = false;\n\n          if ($isRangeSelection(selection)) {\n            const anchorNode = selection.anchor.getNode();\n\n            if ($isTextNode(anchorNode)) {\n              const commentIDs = $getMarkIDs(\n                anchorNode,\n                selection.anchor.offset,\n              );\n              if (commentIDs !== null) {\n                setActiveIDs(commentIDs);\n                hasActiveIds = true;\n              }\n              if (!selection.isCollapsed()) {\n                setActiveAnchorKey(anchorNode.getKey());\n                hasAnchorKey = true;\n              }\n            }\n          }\n          if (!hasActiveIds) {\n            setActiveIDs((_activeIds) =>\n              _activeIds.length === 0 ? _activeIds : [],\n            );\n          }\n          if (!hasAnchorKey) {\n            setActiveAnchorKey(null);\n          }\n        });\n        if (!tags.has('collaboration')) {\n          setShowCommentInput(false);\n        }\n      }),\n      editor.registerCommand(\n        INSERT_INLINE_COMMAND,\n        () => {\n          const domSelection = window.getSelection();\n          if (domSelection !== null) {\n            domSelection.removeAllRanges();\n          }\n          setShowCommentInput(true);\n          return true;\n        },\n        COMMAND_PRIORITY_EDITOR,\n      ),\n    );\n  }, [editor, markNodeMap]);\n\n  const onAddComment = () => {\n    editor.dispatchCommand(INSERT_INLINE_COMMAND, undefined);\n  };\n\n  return (\n    <>\n      {showCommentInput &&\n        createPortal(\n          <CommentInputBox\n            editor={editor}\n            cancelAddComment={cancelAddComment}\n            submitAddComment={submitAddComment}\n          />,\n          document.body,\n        )}\n      {activeAnchorKey !== null &&\n        activeAnchorKey !== undefined &&\n        !showCommentInput &&\n        createPortal(\n          <AddCommentBox\n            anchorKey={activeAnchorKey}\n            editor={editor}\n            onAddComment={onAddComment}\n          />,\n          document.body,\n        )}\n      {createPortal(\n        <Button\n          className={`CommentPlugin_ShowCommentsButton ${\n            showComments ? 'active' : ''\n          }`}\n          onClick={() => setShowComments(!showComments)}\n          title={showComments ? 'Hide Comments' : 'Show Comments'}>\n          <i className=\"comments\" />\n        </Button>,\n        document.body,\n      )}\n      {showComments &&\n        createPortal(\n          <CommentsPanel\n            comments={comments}\n            submitAddComment={submitAddComment}\n            deleteCommentOrThread={deleteCommentOrThread}\n            activeIDs={activeIDs}\n            markNodeMap={markNodeMap}\n          />,\n          document.body,\n        )}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {EditorThemeClasses} from 'lexical';\n\nimport './CommentEditorTheme.css';\n\nimport baseTheme from './PlaygroundEditorTheme';\n\nconst theme: EditorThemeClasses = {\n  ...baseTheme,\n  paragraph: 'CommentEditorTheme__paragraph',\n};\n\nexport default theme;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {$isCodeHighlightNode} from '@lexical/code';\nimport {$isLinkNode, TOGGLE_LINK_COMMAND} from '@lexical/link';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {$isAtNodeEnd} from '@lexical/selection';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  COMMAND_PRIORITY_LOW,\n  ElementNode,\n  FORMAT_TEXT_COMMAND,\n  LexicalEditor,\n  RangeSelection,\n  SELECTION_CHANGE_COMMAND,\n  TextNode,\n} from 'lexical';\nimport {useCallback, useEffect, useRef, useState} from 'react';\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\n\nimport {INSERT_INLINE_COMMAND} from '../CommentPlugin';\n\nfunction setPopupPosition(\n  editor: HTMLElement,\n  rect: ClientRect,\n  rootElementRect: ClientRect,\n): void {\n  let top = rect.top - 8 + window.pageYOffset;\n  let left =\n    rect.left + 340 + window.pageXOffset - editor.offsetWidth + rect.width;\n  if (left + editor.offsetWidth > rootElementRect.right) {\n    left = rect.right - editor.offsetWidth;\n    top = rect.top - 50 + window.pageYOffset;\n  }\n  if (left < 0) {\n    left = rect.left;\n    top = rect.bottom + 20;\n  }\n  if (rect.width >= rootElementRect.width - 25) {\n    left = rect.left;\n    top = rect.top - 50 + window.pageYOffset;\n  }\n  if (top < rootElementRect.top) {\n    top = rect.bottom + 20;\n  }\n  editor.style.opacity = '1';\n  editor.style.top = `${top}px`;\n  editor.style.left = `${left}px`;\n}\n\nfunction TextFormatFloatingToolbar({\n  editor,\n  isLink,\n  isBold,\n  isItalic,\n  isUnderline,\n  isCode,\n  isStrikethrough,\n  isSubscript,\n  isSuperscript,\n}: {\n  editor: LexicalEditor;\n  isBold: boolean;\n  isCode: boolean;\n  isItalic: boolean;\n  isLink: boolean;\n  isStrikethrough: boolean;\n  isSubscript: boolean;\n  isSuperscript: boolean;\n  isUnderline: boolean;\n}): JSX.Element {\n  const popupCharStylesEditorRef = useRef<HTMLDivElement | null>(null);\n\n  const insertLink = useCallback(() => {\n    if (!isLink) {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, 'https://');\n    } else {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, null);\n    }\n  }, [editor, isLink]);\n\n  const insertComment = () => {\n    editor.dispatchCommand(INSERT_INLINE_COMMAND, undefined);\n  };\n\n  const updateTextFormatFloatingToolbar = useCallback(() => {\n    const selection = $getSelection();\n\n    const popupCharStylesEditorElem = popupCharStylesEditorRef.current;\n    const nativeSelection = window.getSelection();\n\n    if (popupCharStylesEditorElem === null) {\n      return;\n    }\n\n    const rootElement = editor.getRootElement();\n    if (\n      selection !== null &&\n      nativeSelection !== null &&\n      !nativeSelection.isCollapsed &&\n      rootElement !== null &&\n      rootElement.contains(nativeSelection.anchorNode)\n    ) {\n      const domRange = nativeSelection.getRangeAt(0);\n      const rootElementRect = rootElement.getBoundingClientRect();\n      let rect;\n\n      if (nativeSelection.anchorNode === rootElement) {\n        let inner = rootElement;\n        while (inner.firstElementChild != null) {\n          inner = inner.firstElementChild as HTMLElement;\n        }\n        rect = inner.getBoundingClientRect();\n      } else {\n        rect = domRange.getBoundingClientRect();\n      }\n\n      setPopupPosition(popupCharStylesEditorElem, rect, rootElementRect);\n    }\n  }, [editor]);\n\n  useEffect(() => {\n    const onResize = () => {\n      editor.getEditorState().read(() => {\n        updateTextFormatFloatingToolbar();\n      });\n    };\n    window.addEventListener('resize', onResize);\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, [editor, updateTextFormatFloatingToolbar]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      updateTextFormatFloatingToolbar();\n    });\n    return mergeRegister(\n      editor.registerUpdateListener(({editorState}) => {\n        editorState.read(() => {\n          updateTextFormatFloatingToolbar();\n        });\n      }),\n\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        () => {\n          updateTextFormatFloatingToolbar();\n          return false;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [editor, updateTextFormatFloatingToolbar]);\n\n  return (\n    <div ref={popupCharStylesEditorRef} className=\"floating-text-format-popup\">\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'bold');\n        }}\n        className={'popup-item spaced ' + (isBold ? 'active' : '')}\n        aria-label=\"Format text as bold\">\n        <i className=\"format bold\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'italic');\n        }}\n        className={'popup-item spaced ' + (isItalic ? 'active' : '')}\n        aria-label=\"Format text as italics\">\n        <i className=\"format italic\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'underline');\n        }}\n        className={'popup-item spaced ' + (isUnderline ? 'active' : '')}\n        aria-label=\"Format text to underlined\">\n        <i className=\"format underline\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'strikethrough');\n        }}\n        className={'popup-item spaced ' + (isStrikethrough ? 'active' : '')}\n        aria-label=\"Format text with a strikethrough\">\n        <i className=\"format strikethrough\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'subscript');\n        }}\n        className={'popup-item spaced ' + (isSubscript ? 'active' : '')}\n        title=\"Subscript\"\n        aria-label=\"Format Subscript\">\n        <i className=\"format subscript\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'superscript');\n        }}\n        className={'popup-item spaced ' + (isSuperscript ? 'active' : '')}\n        title=\"Superscript\"\n        aria-label=\"Format Superscript\">\n        <i className=\"format superscript\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'code');\n        }}\n        className={'popup-item spaced ' + (isCode ? 'active' : '')}\n        aria-label=\"Insert code block\">\n        <i className=\"format code\" />\n      </button>\n      <button\n        onClick={insertLink}\n        className={'popup-item spaced ' + (isLink ? 'active' : '')}\n        aria-label=\"Insert link\">\n        <i className=\"format link\" />\n      </button>\n      <button\n        onClick={insertComment}\n        className={'popup-item spaced ' + (isLink ? 'active' : '')}\n        aria-label=\"Insert link\">\n        <i className=\"format add-comment\" />\n      </button>\n    </div>\n  );\n}\n\nfunction getSelectedNode(selection: RangeSelection): TextNode | ElementNode {\n  const anchor = selection.anchor;\n  const focus = selection.focus;\n  const anchorNode = selection.anchor.getNode();\n  const focusNode = selection.focus.getNode();\n  if (anchorNode === focusNode) {\n    return anchorNode;\n  }\n  const isBackward = selection.isBackward();\n  if (isBackward) {\n    return $isAtNodeEnd(focus) ? anchorNode : focusNode;\n  } else {\n    return $isAtNodeEnd(anchor) ? focusNode : anchorNode;\n  }\n}\n\nfunction useTextFormatFloatingToolbar(\n  editor: LexicalEditor,\n): JSX.Element | null {\n  const [isText, setIsText] = useState(false);\n  const [isLink, setIsLink] = useState(false);\n  const [isBold, setIsBold] = useState(false);\n  const [isItalic, setIsItalic] = useState(false);\n  const [isUnderline, setIsUnderline] = useState(false);\n  const [isStrikethrough, setIsStrikethrough] = useState(false);\n  const [isSubscript, setIsSubscript] = useState(false);\n  const [isSuperscript, setIsSuperscript] = useState(false);\n  const [isCode, setIsCode] = useState(false);\n\n  const updatePopup = useCallback(() => {\n    editor.getEditorState().read(() => {\n      // Should not to pop up the floating toolbar when using IME input\n      if (editor.isComposing()) {\n        return;\n      }\n      const selection = $getSelection();\n      const nativeSelection = window.getSelection();\n      const rootElement = editor.getRootElement();\n\n      if (\n        nativeSelection !== null &&\n        (!$isRangeSelection(selection) ||\n          rootElement === null ||\n          !rootElement.contains(nativeSelection.anchorNode))\n      ) {\n        setIsText(false);\n        return;\n      }\n\n      if (!$isRangeSelection(selection)) {\n        return;\n      }\n\n      const node = getSelectedNode(selection);\n\n      // Update text format\n      setIsBold(selection.hasFormat('bold'));\n      setIsItalic(selection.hasFormat('italic'));\n      setIsUnderline(selection.hasFormat('underline'));\n      setIsStrikethrough(selection.hasFormat('strikethrough'));\n      setIsSubscript(selection.hasFormat('subscript'));\n      setIsSuperscript(selection.hasFormat('superscript'));\n      setIsCode(selection.hasFormat('code'));\n\n      // Update links\n      const parent = node.getParent();\n      if ($isLinkNode(parent) || $isLinkNode(node)) {\n        setIsLink(true);\n      } else {\n        setIsLink(false);\n      }\n\n      if (\n        !$isCodeHighlightNode(selection.anchor.getNode()) &&\n        selection.getTextContent() !== ''\n      ) {\n        setIsText($isTextNode(node));\n      } else {\n        setIsText(false);\n      }\n    });\n  }, [editor]);\n\n  useEffect(() => {\n    document.addEventListener('selectionchange', updatePopup);\n    return () => {\n      document.removeEventListener('selectionchange', updatePopup);\n    };\n  }, [updatePopup]);\n\n  useEffect(() => {\n    return editor.registerUpdateListener(() => {\n      updatePopup();\n    });\n  }, [editor, updatePopup]);\n\n  if (!isText || isLink) {\n    return null;\n  }\n\n  return createPortal(\n    <TextFormatFloatingToolbar\n      editor={editor}\n      isLink={isLink}\n      isBold={isBold}\n      isItalic={isItalic}\n      isStrikethrough={isStrikethrough}\n      isSubscript={isSubscript}\n      isSuperscript={isSuperscript}\n      isUnderline={isUnderline}\n      isCode={isCode}\n    />,\n    document.body,\n  );\n}\n\nexport default function TextFormatFloatingToolbarPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  return useTextFormatFloatingToolbar(editor);\n}\n","import { CLEAR_HISTORY_COMMAND } from 'lexical';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\n\nconst { useEffect } = require(\"react\");\n\nconst LoadContentPlugin = ({ data }) => {\n\n  const jsonString = JSON.parse(data);\n  const [editor] = useLexicalComposerContext();\n\n  const editorState = editor.parseEditorState(\n    JSON.stringify(jsonString.editorState),\n  );\n  editor.setEditorState(editorState);\n  editor.dispatchCommand(CLEAR_HISTORY_COMMAND, undefined);\n\n  return null;\n};\n\n\nexport default LoadContentPlugin;","import { $getRoot } from \"lexical\";\nimport katex from \"katex\";\n\nexport function serializeToHTML(editorState) {\n    const renderText = node => {\n        let format = node.getFormat();\n        console.log(node.getStyle());\n        let html = node.getStyle() ? `<span style=\"${node.getStyle()}\">${node.getTextContent()}</span>` : node.getTextContent();\n        if (format % 2 === 1) html = `<strong>${html}</strong>`;\n        format >>= 1;\n        if (format % 2 === 1) html = `<em>${html}</em>`;\n        format >>= 1;\n        if (format % 2 === 1) html = `<s>${html}</s>`;\n        format >>= 1;\n        if (format % 2 === 1) html = `<u>${html}</u>`;\n        format >>= 1;\n        if (format % 2 === 1) html = `<code>${html}</code>`;\n        format >>= 1;\n        if (format % 2 === 1) html = `<sub>${html}</sub>`;\n        format >>= 1;\n        if (format % 2 === 1) html = `<sup>${html}</sup>`;\n        return html;\n    };\n\n    const renderStyle = (format) => {\n        switch (format) {\n            case 1: // left\n                return `text-align: left;`;\n            case 2: // center\n                return `text-align: center;`;\n            case 3: // right\n                return `text-align: right;`;\n            case 4: // justify\n                return `text-align: justify;`;\n            default: // justify\n                return ``;\n        }\n    };\n\n    const\n        renderNode = node => {\n            switch (node.getType()) {\n                case \"root\":\n                    return node.getChildren().map((k) => renderNode(k)).join(\"\");\n                case \"heading\":\n                    const headingNode = node;\n                    return `<${headingNode.getTag()}>${headingNode.getChildren()\n                        .map((k) => renderNode(k))\n                        .join(\"\")}</${headingNode.getTag()}>`;\n                case \"list\":\n                    const listNode = node\n                    return `<${listNode.getTag()}>${listNode.getChildren()\n                        .map((k) => renderNode(k))\n                        .join(\"\")}</${listNode.getTag()}>`;\n                case \"text\":\n                    return renderText(node);\n                case \"quote\":\n                    const quoteNode = node;\n                    return `<blockquote class=\"dark:border-slate-700 bg-gray-100 dark:bg-gray-800 text-[#666] pl-[3em] border-l-[0.5em] border-[#eee]\"><em>${quoteNode.getChildren()\n                        .map((k) => renderNode(k))\n                        .join(\"\")}</em></blockquote>`;\n                case \"paragraph\":\n                    const paragraphNode = node;\n                    return `<p class=\"p-1\" ${paragraphNode.getFormat() ? ` style=\"${renderStyle(paragraphNode.getFormat())}\"` : ``\n                        }>${paragraphNode.getChildren().map((k) => renderNode(k)).join(\"\")}</p>`;\n                case \"listitem\":\n                    const listItemNode = node\n                    return `<li>${listItemNode.getChildren()\n                        .map((k) => renderNode(k))\n                        .join(\"\")}</li>`;\n                case \"link\":\n                    const linkNode = node\n                    return `<a href=\"${linkNode.getURL()}\" class=\"text-blue-500 hover:underline visited:text-blue-800\" target=\"_blank\">${linkNode.getChildren()\n                        .map((k) => renderNode(k))\n                        .join(\"\")}</a>`;\n                case \"image\":\n                    const imageNode = node\n                    return `<img src=\"${imageNode.getSrc()}\" class=\"inline-block w-full\" style=\"max-width: ${imageNode.__maxWidth.toString()}px\"></img>`;\n                case \"table\":\n                    const tableNode = node\n                    let html = \"\"\n                    tableNode.getChildren().map((child, i) => {\n                        console.log(child);\n                        child.getChildren().map((ch, j) => {\n                            console.log(ch.getChildren())\n                            html += `<td>${ch.getChildren().map(single => renderNode(single)).join(\"\")}</td>`\n                        })\n                        html = `<tr>${html}</tr>`\n                    })\n                    return `<table>${html}</table>`\n                case \"equation\":\n                    const equationNode = node\n                    const katexElement = katex.renderToString(equationNode.getEquation(), {\n                        displayMode: !equationNode.__inline, // true === block display //\n                        output: 'html',\n                    });\n\n                    return `<span class=\"katex\">${katexElement}</span>`;\n\n                default:\n                    // console.log(\"unknown type\", node.getType());\n                    return \"\";\n            }\n        };\n\n    return new Promise(resolve => {\n        editorState.read(() => {\n            resolve(renderNode($getRoot()));\n        });\n    });\n}","import { AutoScrollPlugin } from '@lexical/react/LexicalAutoScrollPlugin';\nimport { CheckListPlugin } from '@lexical/react/LexicalCheckListPlugin';\nimport { ClearEditorPlugin } from '@lexical/react/LexicalClearEditorPlugin';\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\nimport { LinkPlugin } from '@lexical/react/LexicalLinkPlugin';\nimport { ListPlugin } from '@lexical/react/LexicalListPlugin';\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\nimport { TablePlugin } from '@lexical/react/LexicalTablePlugin';\nimport * as React from 'react';\nimport { useRef } from 'react';\nimport { useSettings } from './context/SettingsContext';\nimport { useSharedHistoryContext } from './context/SharedHistoryContext';\nimport ActionsPlugin from './plugins/ActionsPlugin';\nimport AutoLinkPlugin from './plugins/AutoLinkPlugin';\nimport ClickableLinkPlugin from './plugins/ClickableLinkPlugin';\nimport CodeActionMenuPlugin from './plugins/CodeActionMenuPlugin';\nimport CodeHighlightPlugin from './plugins/CodeHighlightPlugin';\nimport ComponentPickerPlugin from './plugins/ComponentPickerPlugin';\nimport EquationsPlugin from './plugins/EquationsPlugin';\nimport HorizontalRulePlugin from './plugins/HorizontalRulePlugin';\nimport ImagesPlugin from './plugins/ImagesPlugin';\nimport ListMaxIndentLevelPlugin from './plugins/ListMaxIndentLevelPlugin';\nimport MarkdownShortcutPlugin from './plugins/MarkdownShortcutPlugin';\nimport TabFocusPlugin from './plugins/TabFocusPlugin';\nimport TableCellActionMenuPlugin from './plugins/TableActionMenuPlugin';\nimport TableCellResizer from './plugins/TableCellResizer';\nimport TextFormatFloatingToolbarPlugin from './plugins/TextFormatFloatingToolbarPlugin';\nimport ToolbarPlugin, { InsertEquationDialog } from './plugins/ToolbarPlugin';\nimport TreeViewPlugin from './plugins/TreeViewPlugin';\nimport YouTubePlugin from './plugins/YouTubePlugin';\nimport LoadContentPlugin from './plugins/LoadContentPlugin';\nimport ContentEditable from './ui/ContentEditable';\nimport Placeholder from './ui/Placeholder';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { getTopic, editTopic } from '../../../api/Courses'\nimport { useParams } from \"react-router-dom\";\nimport { serializeToHTML } from './EditorToHtml'\nimport useModal from './hooks/useModal';\n\nexport default function Editor({ data: topicData }): JSX.Element {\n  const params = useParams()\n  const { errorMessage, setErrorMessage } = React.useState(\"\")\n  const { isShowing, setIsShowing } = React.useState(false)\n  const { historyState } = useSharedHistoryContext();\n  const {\n    settings: {\n      isCollab,\n      isRichText,\n      showTreeView,\n    },\n  } = useSettings();\n  const text = 'Enter some rich text...'\n  const placeholder = <Placeholder>{text}</Placeholder>;\n  const scrollRef = useRef(null);\n\n  const [editor] = useLexicalComposerContext();\n  const [modal, showModal] = useModal();\n\n  const execute = (e: KeyboardEvent) => {\n    if (e.ctrlKey && e.key === 's') {\n      e.preventDefault();\n\n      editor.update(async () => {\n\n        const editorState = editor.getEditorState();\n        const raw = await serializeToHTML(editorState)\n        console.log(raw)\n        const documentJSON = {\n          editorState: editorState\n        };\n\n        const topicEdit = await editTopic(process.env.REACT_APP_BACKEND + \"/topic/edit\", {\n          courseId: params.courseId,\n          subjectId: params.subjectId,\n          chapterId: params.chapterId,\n          topicId: params.topicId,\n          topicTitle: topicData?.data?.title,\n          topicContent: raw,\n          topicEditor: JSON.stringify(documentJSON),\n          published: topicData?.data?.published\n        });\n        alert(\"Your content is saved successfully.\")\n        // setErrorMessage(topicEdit?.message)\n        // setIsShowing(true)\n        // setTimeout(() => {\n        //   setIsShowing(false)\n        //   setErrorMessage(\"\")\n        // }, 4000); \n      })\n\n    }\n    if (e.ctrlKey && e.code === 'KeyM') {\n      showModal('Insert Equation', (onClose) => (\n        <InsertEquationDialog\n          activeEditor={editor}\n          onClose={onClose}\n        />\n      ));\n    }\n\n  }\n  React.useEffect(() => {\n    window.addEventListener('keydown', execute)\n    return () => {\n      window.removeEventListener('keydown', execute)\n    }\n  }, [])\n\n  return (\n    <>\n      {isRichText && <ToolbarPlugin />}\n      <div\n        className={`editor-container ${showTreeView ? 'tree-view' : ''} ${!isRichText ? 'plain-text' : ''\n          }`}\n        ref={scrollRef}>\n        <ClearEditorPlugin />\n        <ComponentPickerPlugin />\n        <AutoLinkPlugin />\n        <AutoScrollPlugin scrollRef={scrollRef} />\n        <HistoryPlugin externalHistoryState={historyState} />\n        <RichTextPlugin\n          contentEditable={<ContentEditable />}\n          placeholder={placeholder}\n          initialEditorState={isCollab ? null : undefined}\n        />\n        {typeof (topicData?.data?.editor) === \"undefined\" || !topicData?.data?.editor ? <></> : <LoadContentPlugin data={topicData?.data?.editor} />}\n        <MarkdownShortcutPlugin />\n        <CodeActionMenuPlugin />\n        <CodeHighlightPlugin />\n        <ListPlugin />\n        <CheckListPlugin />\n        <ListMaxIndentLevelPlugin maxDepth={7} />\n        <TablePlugin />\n        <TableCellActionMenuPlugin />\n        <TableCellResizer />\n        <ImagesPlugin />\n        <LinkPlugin />\n        <YouTubePlugin />\n        <ClickableLinkPlugin />\n        <HorizontalRulePlugin />\n        <TextFormatFloatingToolbarPlugin />\n        <EquationsPlugin />\n        <TabFocusPlugin />\n        {modal}\n        <div className={`${isShowing ? \"animate-fade\" : \"\"} fixed bottom-10 right-10 text-warningText border-2 bg-slate-300 rounded-md px-2`}>\n          {errorMessage}\n        </div>\n        <ActionsPlugin isRichText={isRichText} />\n      </div>\n      {showTreeView && <TreeViewPlugin />}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {Spread} from 'lexical';\n\nimport {EditorConfig, SerializedTextNode, TextNode} from 'lexical';\n\nexport type SerializedTypeaheadNode = Spread<\n  {\n    type: 'typeahead';\n    version: 1;\n  },\n  SerializedTextNode\n>;\n\nexport class TypeaheadNode extends TextNode {\n  static clone(node: TypeaheadNode): TypeaheadNode {\n    return new TypeaheadNode(node.__text, node.__key);\n  }\n\n  static getType(): 'typeahead' {\n    return 'typeahead';\n  }\n\n  static importJSON(serializedNode: SerializedTypeaheadNode): TypeaheadNode {\n    const node = $createTypeaheadNode(serializedNode.text);\n    node.setFormat(serializedNode.format);\n    node.setDetail(serializedNode.detail);\n    node.setMode(serializedNode.mode);\n    node.setStyle(serializedNode.style);\n    return node;\n  }\n\n  exportJSON(): SerializedTypeaheadNode {\n    return {\n      ...super.exportJSON(),\n      type: 'typeahead',\n      version: 1,\n    };\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const dom = super.createDOM(config);\n    dom.style.cssText = 'color: #ccc;';\n    return dom;\n  }\n}\n\nexport function $createTypeaheadNode(text: string): TypeaheadNode {\n  return new TypeaheadNode(text).setMode('inert');\n}\n","import type {Klass, LexicalNode} from 'lexical';\n\nimport {CodeHighlightNode, CodeNode} from '@lexical/code';\nimport {AutoLinkNode, LinkNode} from '@lexical/link';\nimport {ListItemNode, ListNode} from '@lexical/list';\nimport {OverflowNode} from '@lexical/overflow';\nimport {HorizontalRuleNode} from '@lexical/react/LexicalHorizontalRuleNode';\nimport {HeadingNode, QuoteNode} from '@lexical/rich-text';\nimport {TableCellNode, TableNode, TableRowNode} from '@lexical/table';\n\nimport {EquationNode} from './EquationNode';\nimport {ImageNode} from './ImageNode';\nimport {TypeaheadNode} from './TypeaheadNode';\nimport {YouTubeNode} from './YouTubeNode';\n\nconst PlaygroundNodes: Array<Klass<LexicalNode>> = [\n  HeadingNode,\n  ListNode,\n  ListItemNode,\n  QuoteNode,\n  CodeNode,\n  TableNode,\n  TableCellNode,\n  TableRowNode,\n  CodeHighlightNode,\n  AutoLinkNode,\n  LinkNode,\n  OverflowNode,\n  ImageNode,\n  EquationNode,\n  TypeaheadNode,\n  HorizontalRuleNode,\n  YouTubeNode,\n];\n\nexport default PlaygroundNodes;\n","import { LexicalComposer } from '@lexical/react/LexicalComposer';\nimport * as React from 'react';\n\nimport { SettingsContext, useSettings } from './context/SettingsContext';\nimport { SharedHistoryContext } from './context/SharedHistoryContext';\nimport Editor from './Editor';\nimport PlaygroundNodes from './nodes/PlaygroundNodes';\nimport PlaygroundEditorTheme from './themes/PlaygroundEditorTheme';\n\nimport \"./index.css\";\n\nconsole.warn(\n  'If you are profiling the playground app, please ensure you turn off the debug view. You can disable it by pressing on the settings control in the bottom-left of your screen and toggling the debug view setting.',\n);\n\nfunction prepopulatedRichText() {\n}\n\nfunction App({ data }): JSX.Element {\n  const {\n    settings: { isCollab, emptyEditor },\n  } = useSettings();\n\n  const initialConfig = {\n    editorState: prepopulatedRichText,\n    namespace: 'Playground',\n    nodes: [...PlaygroundNodes],\n    onError: (error: Error) => {\n      throw error;\n    },\n    theme: PlaygroundEditorTheme,\n  };\n\n  return (\n    <LexicalComposer initialConfig={initialConfig}>\n      <SharedHistoryContext>\n        <div className=\"editor-shell\">\n          <Editor data={data} />\n        </div>\n      </SharedHistoryContext>\n    </LexicalComposer>\n  );\n}\n\nexport default function TextEditor({ topic }): JSX.Element {\n  return (\n    <SettingsContext>\n      <App data={topic} />\n    </SettingsContext>\n  );\n}","import React from \"react\";\nimport TextEditor from \"../Editor/TextEditor\"\nimport { getTopic } from '../../../api/Courses'\nimport useSWR, { mutate } from \"swr\";\nimport { useParams } from \"react-router-dom\";\n\nfunction Topic() {\n  const params = useParams()\n  const { data: topicData } = useSWR(process.env.REACT_APP_BACKEND + `/topic/${params.courseId}/${params.subjectId}/${params.chapterId}/${params.topicId}`, async url => await getTopic(url))\n  return (\n    <div className=\"col-span-4 flex flex-col w-full px-2 mt-2\">\n      <TextEditor topic={topicData} />\n    </div>\n  )\n}\n\nexport default Topic;","import React from 'react'\n\nexport default function Index() {\n    return (\n        <div className=\"col-span-4 flex flex-col h-[70vh] md:h-full w-full\">\n            <div className=\"text-3xl text-center font-bold border-b-2 border-green-200 pt-6 pb-2 px-6\">\n                Dashboard\n            </div>\n            <div className=\"p-10 flex-1 my-6 mx-6 border-2 border-gray-200 rounded-xl text-center\">\n                The admin is requested to add media files like images and videos by adding url of the file located in the server. You just have to go to 'Media' tab and copy the url of the file. Also be used to content writing. Thank You!\n            </div>\n        </div>\n    )\n}\n","import axios from 'axios'\n\nexport const getFiles = (url) => axios.get(url, { withCredentials: true }).then(res => res.data)","import axios from 'axios'\nimport useSWR, { mutate } from 'swr';\nimport React, { useState, useEffect } from 'react'\nimport { getFiles } from '../../api/Media';\nimport { IoCopyOutline } from 'react-icons/io5'\n\nexport default function Mcq() {\n    const [currentPage, setCurrentPage] = useState(0)\n    const [message, setMessage] = useState(\"\")\n    const [isShowing, setIsShowing] = useState(false)\n    const [selectedFile, setSelectedFile] = useState(null);\n    const [files, setFiles] = useState(null);\n\n    const { data: filesList } = useSWR(process.env.REACT_APP_BACKEND + \"/file/list\", async (url) => await getFiles(url));\n\n    const uploadFile = (e) => {\n        e.preventDefault();\n        if (selectedFile) {\n            const formData = new FormData();\n            formData.append(\"file\", selectedFile);\n            const upload = async () => {\n                await axios.post(process.env.REACT_APP_BACKEND + \"/file/upload\", formData)\n            }\n            upload()\n            mutate(process.env.REACT_APP_BACKEND + \"/file/list\")\n        }\n    }\n\n    const handleFileChage = (e) => {\n        setSelectedFile(e.target.files[0]);\n    }\n\n    useEffect(() => {\n        if (typeof filesList !== typeof undefined) {\n            setFiles(filesList)\n        }\n    }, [filesList])\n\n    const filesPerPage = 10\n    const pagesVisited = currentPage * filesPerPage\n    const pageCount = Math.ceil(filesList?.length / filesPerPage)\n\n\n    const handleChangePage = ({ selected }) => {\n        setCurrentPage(selected - 1)\n    }\n\n\n    const displayFiles = filesList?.slice(pagesVisited, pagesVisited + filesPerPage).map((file, i) => {\n        return (\n            <div key={i} className='hover:cursor-pointer duration-500 flex flex-col gap-3 max-w-[400px] max-h-[400px] min-w-[200px]'>\n                <img className='hover:scale-105 transition-all max-h-[400px] max-w-[300px] object-cover' src={process.env.REACT_APP_BACKEND + file.fileURL} />\n                <div className='flex justify-center'>\n                    <div onClick={() => {\n                        navigator.clipboard.writeText(process.env.REACT_APP_BACKEND + file.fileURL)\n                        setMessage(\"Copied to Clipboard\")\n                        setIsShowing(true)\n                        setTimeout(() => {\n                            setIsShowing(false)\n                            setMessage(\"\")\n                        }, 4000);\n                        mutate(process.env.REACT_APP_BACKEND + \"/courses/list\")\n                    }} className='hover:cursor-pointer'>\n                        <IoCopyOutline size={30} />\n                    </div>\n                </div>\n            </div>\n\n        )\n    })\n\n\n    return (\n        <div className={`col-span-4 relative font-sans dark:bg-background dark:text-mainText w-full h-full flex flex-col `}>\n            <div className={`${isShowing ? \"animate-fade\" : \"\"} fixed bottom-10 right-10 text-blue-900 border-2 bg-slate-300 rounded-md px-2`}>\n                {message}\n            </div>\n            <div className=\"flex flex-col h-full w-full\">\n                <div className=\"text-3xl text-center font-bold border-b-2 border-green-200 pt-6 pb-2 px-6\">\n                    Media\n                </div>\n                <div className=\"p-10 my-6 mx-6 border-2 border-gray-200 rounded-xl text-center h-full\">\n                    <span className='text-xl text-blue-900 font-semibold'>Add new Media from here</span>\n                    <form className='flex justify-center mt-4 gap-3 items-center'>\n                        <input type=\"file\" name=\"media\" onChange={handleFileChage} />\n                        <button className=\"font-sans text-lg hover:-translate-y-0.5 transition-all bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline\" type=\"submit\" onClick={uploadFile}>Submit</button>\n                    </form>\n                    <div className='gap-14 grid md:grid-cols-2 items-center justify-center p-10 px-20 mb-5'>\n                        {displayFiles}\n                    </div>\n                </div>\n            </div>\n            <div className='flex justify-center mb-14 absolute bottom-0 left-0 right-0'>\n                <Paginate\n                    previousLabel={\"Prev\"}\n                    nextLabel={\"Next\"}\n                    pageCount={pageCount}\n                    onPageChange={handleChangePage}\n                    containerClassName={\"flex gap-3 items-center select-none\"}\n                    previousLinkClassName={\"text-lg text-blue-900 dark:text-blue-100 hover:cursor-pointer\"}\n                    nextLinkClassName={\"text-lg text-blue-900 dark:text-blue-100 hover:cursor-pointer\"}\n                    activeClassName={\"bg-blue-600 text-white dark:bg-black hover:bg-blue-400\"}\n                    pageClassName={\"border-2 px-3 py-1 rounded-md hover:bg-blue-600 hover:cursor-pointer hover:text-white dark:hover:bg-black\"}\n                />\n            </div>\n        </div >\n    )\n}\n\n\nexport function Paginate({ nextLabel, previousLabel, pageCount, onPageChange, containerClassName, previousLinkClassName, nextLinkClassName, pageClassName, activeClassName, disabledClassName }) {\n    const [activePage, setActivePage] = useState(1)\n    return (\n        <>\n            {pageCount > 1 ?\n                <div className={containerClassName}>\n                    <div onClick={() => {\n                        if (activePage - 1 !== 0) {\n                            onPageChange({ selected: activePage - 1 })\n                            setActivePage(activePage - 1)\n                        }\n                    }} className={previousLinkClassName}>{previousLabel}</div>\n                    {\n                        [...Array(pageCount)].map((e, i) => {\n                            return (\n                                <div onClick={() => {\n                                    onPageChange({ selected: i + 1 })\n                                    if (activePage !== i + 1) {\n                                        setActivePage(i + 1)\n                                    }\n                                }} key={i + 1} className={`${activePage === i + 1 ? activeClassName : disabledClassName} ${pageClassName}`}>{i + 1}</div>\n                            )\n                        })\n                    }\n                    <div onClick={() => {\n                        if (activePage + 1 <= pageCount) {\n                            onPageChange({ selected: activePage + 1 })\n                            setActivePage(activePage + 1)\n                        }\n                    }} className={nextLinkClassName}>{nextLabel}</div>\n                </div>\n                :\n                <></>\n            }\n        </>\n    )\n}","import axios from 'axios'\nimport useSWR, { mutate } from 'swr';\nimport React, { useState, useEffect } from 'react'\nimport { getFiles } from '../../api/Media';\nimport { IoCopyOutline } from 'react-icons/io5'\n\nexport default function Mcq() {\n    const [currentPage, setCurrentPage] = useState(0)\n    const [message, setMessage] = useState(\"\")\n    const [isShowing, setIsShowing] = useState(false)\n    const [selectedFile, setSelectedFile] = useState(null);\n    const [files, setFiles] = useState(null);\n\n    const { data: filesList } = useSWR(process.env.REACT_APP_BACKEND + \"/user/payments\", async (url) => await getFiles(url));\n\n    useEffect(() => {\n        if (typeof filesList !== typeof undefined) {\n            setFiles(filesList)\n        }\n    }, [filesList])\n\n    const filesPerPage = 10\n    const pagesVisited = currentPage * filesPerPage\n    const pageCount = Math.ceil(filesList?.length / filesPerPage)\n\n\n    const handleChangePage = ({ selected }) => {\n        setCurrentPage(selected - 1)\n    }\n\n\n    const displayFiles = filesList?.slice(pagesVisited, pagesVisited + filesPerPage).map((file, i) => {\n        return (\n            <div key={i} className='hover:cursor-pointer duration-500 flex flex-col gap-3 max-w-[400px] max-h-[400px] min-w-[200px]'>\n                <a href={process.env.REACT_APP_BACKEND + file.fileURL} target=\"_blank\"><img className='hover:scale-105 transition-all max-h-[400px] max-w-[300px] object-cover' src={process.env.REACT_APP_BACKEND + file.fileURL} /></a>\n                <div className='flex justify-center flex-col text-left'>\n                    <div>{file.user.name}</div>\n                    <div>{file.user.email}</div>\n                    <div>{file.user.phone}</div>\n                </div>\n            </div>\n\n        )\n    })\n\n\n    return (\n        <div className={`col-span-4 relative font-sans dark:bg-background dark:text-mainText w-full h-full flex flex-col `}>\n            <div className={`${isShowing ? \"animate-fade\" : \"\"} fixed bottom-10 right-10 text-blue-900 border-2 bg-slate-300 rounded-md px-2`}>\n                {message}\n            </div>\n            <div className=\"flex flex-col h-full w-full\">\n                <div className=\"text-3xl text-center font-bold border-b-2 border-green-200 pt-6 pb-2 px-6\">\n                    Payment\n                </div>\n                <div className=\"p-10 my-6 mx-6 border-2 border-gray-200 rounded-xl text-center h-full\">\n                    <div className='gap-14 grid md:grid-cols-2 items-center justify-center p-10 px-20 mb-5'>\n                        {displayFiles}\n                    </div>\n                </div>\n            </div>\n            <div className='flex justify-center mb-14 absolute bottom-0 left-0 right-0'>\n                <Paginate\n                    previousLabel={\"Prev\"}\n                    nextLabel={\"Next\"}\n                    pageCount={pageCount}\n                    onPageChange={handleChangePage}\n                    containerClassName={\"flex gap-3 items-center select-none\"}\n                    previousLinkClassName={\"text-lg text-blue-900 dark:text-blue-100 hover:cursor-pointer\"}\n                    nextLinkClassName={\"text-lg text-blue-900 dark:text-blue-100 hover:cursor-pointer\"}\n                    activeClassName={\"bg-blue-600 text-white dark:bg-black hover:bg-blue-400\"}\n                    pageClassName={\"border-2 px-3 py-1 rounded-md hover:bg-blue-600 hover:cursor-pointer hover:text-white dark:hover:bg-black\"}\n                />\n            </div>\n        </div >\n    )\n}\n\n\nexport function Paginate({ nextLabel, previousLabel, pageCount, onPageChange, containerClassName, previousLinkClassName, nextLinkClassName, pageClassName, activeClassName, disabledClassName }) {\n    const [activePage, setActivePage] = useState(1)\n    return (\n        <>\n            {pageCount > 1 ?\n                <div className={containerClassName}>\n                    <div onClick={() => {\n                        if (activePage - 1 !== 0) {\n                            onPageChange({ selected: activePage - 1 })\n                            setActivePage(activePage - 1)\n                        }\n                    }} className={previousLinkClassName}>{previousLabel}</div>\n                    {\n                        [...Array(pageCount)].map((e, i) => {\n                            return (\n                                <div onClick={() => {\n                                    onPageChange({ selected: i + 1 })\n                                    if (activePage !== i + 1) {\n                                        setActivePage(i + 1)\n                                    }\n                                }} key={i + 1} className={`${activePage === i + 1 ? activeClassName : disabledClassName} ${pageClassName}`}>{i + 1}</div>\n                            )\n                        })\n                    }\n                    <div onClick={() => {\n                        if (activePage + 1 <= pageCount) {\n                            onPageChange({ selected: activePage + 1 })\n                            setActivePage(activePage + 1)\n                        }\n                    }} className={nextLinkClassName}>{nextLabel}</div>\n                </div>\n                :\n                <></>\n            }\n        </>\n    )\n}","import React, { useEffect, useState } from \"react\";\nimport { Link, Routes, Route, useLocation } from \"react-router-dom\";\nimport { AdminProvider } from \"../context/AdminProvider\";\n// import Mcqs from \"../components/Admin/Mcqs\";\nimport Courses from \"../components/Admin/Courses/Courses\";\nimport Chapters from \"../components/Admin/Courses/Chapters\";\nimport Topic from \"../components/Admin/Courses/Topic\";\nimport Index from \"../components/Admin/Index\";\nimport Media from \"../components/Admin/Media\";\nimport Payment from \"../components/Admin/Payment\";\nimport InvalidPage from \"./InvalidPage\";\nimport Helmet from \"react-helmet\";\n\nconst Admin = () => {\n  const location = useLocation()\n  const [activePage, setActivePage] = useState(\"\");\n  let loc = location.pathname.split('/')\n  loc = loc[2]\n\n  return (\n    <div className=\"font-sans text-lg h-full w-full grid grid-cols-1 md:grid-cols-5 \">\n      <Helmet>\n        <title>Admin | Aakhyaan Academy</title>\n      </Helmet>\n      <Sidenav activePage={activePage} location={loc} setActivePage={setActivePage} />\n      <AdminProvider>\n        <Routes>\n          <Route path=\"/\" element={<Index />} />\n          <Route path=\"/courses\" element={<Courses />} />\n          <Route path=\"/media\" element={<Media />} />\n          <Route path=\"/Payment\" element={<Payment />} />\n          <Route path=\"/courses/:courseId/:subjectId\" element={<Chapters />} />\n          <Route path=\"/courses/:courseId/:subjectId/:chapterId/:topicId\" element={<Topic />} />\n          <Route path=\"*\" element={<InvalidPage />} />\n        </Routes>\n      </AdminProvider>\n    </div>\n  );\n};\n\nconst Sidenav = ({ activePage, setActivePage, location }) => (\n  <div className=\"flex flex-col bg-blue-50 px-6 pt-1 relative\">\n    <SidenavHeader />\n    <SidenavMenu activePage={activePage} location={location} setActivePage={setActivePage} />\n    <SidenavFooter />\n  </div>\n);\n\nconst SidenavHeader = () => (\n  <div className=\"flex items-center ml-1\">\n    <div className=\"select-none md:flex min-w-[100px] max-w-[120px] mb-3 \">\n      <img src=\"/aakhyaanText.png\"></img>\n    </div>\n  </div>\n);\n\nconst SidenavMenu = ({ activePage, setActivePage, location }) => {\n  useEffect(() => {\n    if (location) setActivePage(location)\n    else setActivePage(\"dashboard\")\n  }, [location, setActivePage])\n  return (\n    <nav className=\"space-y-2\">\n      <Link to=\"/admin/\"\n        onClick={() => setActivePage('dashboard')}\n        className={`flex items-center no-underline p-3 rounded-md ${activePage === \"dashboard\"\n          ? \"bg-green-500\"\n          : \"transition-all hover:cursor-pointer hover:text-blue-800 hover:translate-x-0.5 hover:translate-y-0.5\"\n          }`}>\n        <div className=\"font-bold pl-3\">Dashboard</div>\n      </Link>\n      <Link to=\"/admin/courses\"\n        onClick={() => setActivePage('courses')}\n        className={`flex items-center no-underline p-3 rounded-md ${activePage === \"courses\"\n          ? \"bg-green-500\"\n          : \"transition-all hover:cursor-pointer hover:text-blue-800 hover:translate-x-0.5 hover:translate-y-0.5\"\n          }`}>\n        <div className=\"font-bold pl-3\">Courses</div>\n      </Link>\n      {/* <Link to=\"/admin/mcqs\"\n        onClick={() => setActivePage('mcqs')}\n        className={`flex items-center no-underline p-3 rounded-md ${activePage === \"mcqs\"\n          ? \"bg-green-500\"\n          : \"transition-all hover:cursor-pointer hover:text-blue-800 hover:translate-x-0.5 hover:translate-y-0.5\"\n          }`}>\n        <div className=\"font-bold pl-3\">Mcqs</div>\n      </Link> */}\n      <Link to=\"/admin/media\"\n        onClick={() => setActivePage('media')}\n        className={`flex items-center no-underline p-3 rounded-md ${activePage === \"media\"\n          ? \"bg-green-500\"\n          : \"transition-all hover:cursor-pointer hover:text-blue-800 hover:translate-x-0.5 hover:translate-y-0.5\"\n          }`}>\n        <div className=\"font-bold pl-3\">Media</div>\n      </Link>\n      <Link to=\"/admin/payment\"\n        onClick={() => setActivePage('media')}\n        className={`flex items-center no-underline p-3 rounded-md ${activePage === \"payment\"\n          ? \"bg-green-500\"\n          : \"transition-all hover:cursor-pointer hover:text-blue-800 hover:translate-x-0.5 hover:translate-y-0.5\"\n          }`}>\n        <div className=\"font-bold pl-3\">Payment</div>\n      </Link>\n    </nav>\n  )\n}\n\nconst SidenavFooter = () => (\n  <div className=\"\">\n    <Link\n      className=\"p-3 pl-6 font-bold flex items-center hover:text-blue-800 \"\n      to=\"/\">\n      Go Home\n    </Link>\n    <p className=\"md:absolute md:bottom-0 text-center text-gray-500 text-xs mt-2 md:mb-5\">\n      Aakhyaan © 2022 aakhyaan.org. All Rights Reserved\n    </p>\n  </div>\n);\n\nexport default Admin;\n","import React from \"react\";\nimport { Link, useParams } from \"react-router-dom\";\nimport Helmet from \"react-helmet\";\n\nexport default function () {\n  return (\n    <div className=\"bg-back w-full h-full flex col-span-4\">\n      <Helmet>\n        <title>Page Not Found | Aakhyaan Academy</title>\n      </Helmet>\n      <div className=\"m-auto flex flex-col p-10\">\n        <div className=\"mx-auto dark:hidden max-w-[250px]\">\n          <img alt=\"\" src=\"aakhyaanText.png\"></img>\n        </div>\n        <div className=\"invisible dark:visible max-w-[250px]\">\n          <img alt=\"\" src=\"aakhyaanTextWhite.png\"></img>\n        </div>\n        <span className=\"font-sans\">\n          <span className=\"font-bold\">404</span>. That's an error\n        </span>\n        <span className=\"mt-5 font-sans\">\n          The requested URL{\" \"}\n          <strong>\n            {window.location.href.replace(process.env.REACT_APP_FRONTEND, \"\")}&nbsp;\n          </strong>\n          was not found on this server.\n          <span className=\"font-thin\">That’s all we know.</span>\n        </span>\n        <Link\n          to=\"/\"\n          className=\"mt-5 font-sans text-xl hover:underline transition-all text-blue-600\"\n        >\n          Goto Home\n        </Link>\n      </div>\n    </div>\n  );\n}\n"],"names":["getCourses","url","axios","withCredentials","then","res","data","getSubjects","getChapters","getTopics","getTopic","editCourse","courseId","courseTitle","published","thumbnail","editSubject","subjectId","subjectTitle","editChapter","chapterId","chapterTitle","order","sn","editTopic","topicId","topicTitle","topicContent","topicEditor","deleteSomething","AdminContext","React","useAdminData","useContext","AdminProvider","children","useState","course","subject","status","chapter","topic","createForm","setCreateForm","editForm","setEditForm","errorMessage","setErrorMessage","isShowing","setIsShowing","Provider","value","text","element","setExpanded","expanded","expandIndex","className","onClick","e","preventDefault","prev","temp","type","apiUrl","process","deleteCourse","prompt","deleteData","mutate","message","setTimeout","catch","err","console","log","CreateCourse","title","tag","setCourse","onSubmit","postCourse","posted","placeholder","onChange","target","required","CreateSubject","setSubject","postSubject","CreateChapter","setChapter","postChapter","CreateTopic","content","setTopic","postTopic","setCourseErrorMessage","setCourseIsShowing","_id","navigate","useNavigate","subjects","setSubjects","subjectRef","useRef","subjectThumbnailRef","useSWR","subjectData","postEditSubject","subjectEdit","useEffect","map","subjectObj","i","ref","current","push","onInput","currentTarget","textContent","onBlur","contentEditable","size","color","focus","courses","courseRef","courseThumbnailRef","postEditCourse","courseEdit","indx","setCourses","courseData","setSubjectErrorMessage","setSubjectIsShowing","params","useParams","topics","setTopics","topicRef","topicOrderRef","topicData","postEditTopic","topicEdit","topicObj","chapters","chaptersList","setChaptersList","chapterRef","chapterOrderRef","postEditChapter","chapterEdit","chapterObj","setChapters","chapterData","hostName","window","location","hostname","DEFAULT_SETTINGS","disableBeforeInput","emptyEditor","isAutocomplete","isCharLimit","isCharLimitUtf8","isCollab","isMaxLength","isRichText","measureTypingPerf","showNestedEditorTreeView","showTableOfContents","showTreeView","Context","createContext","setOption","name","settings","SettingsContext","setSettings","useCallback","setting","options","setURLParam","contextValue","useMemo","useSettings","param","URL","href","URLSearchParams","search","has","set","String","append","delete","toString","history","pushState","SharedHistoryContext","historyContext","historyState","createEmptyHistoryState","useSharedHistoryContext","PortalImpl","onClose","closeOnClickOutside","modalRef","modalOverlayElement","handler","event","keyCode","clickOutsideHandler","contains","parentElement","addEventListener","removeEventListener","role","tabIndex","Modal","createPortal","document","body","useModal","modalContent","setModalContent","modal","showModal","getContent","joinClasses","args","filter","Boolean","join","Button","dataTestId","disabled","small","EquationEditor","equation","setEquation","inline","inputRef","props","InlineEquationEditor","BlockEquationEditor","autoFocus","KatexRenderer","katexElementRef","katexElement","katex","displayMode","errorColor","output","strict","throwOnError","trust","EquationComponent","nodeKey","useLexicalComposerContext","editor","equationValue","setEquationValue","showEquationEditor","setShowEquationEditor","onHide","restoreSelection","update","node","$getNodeByKey","$isEquationNode","selectNext","mergeRegister","registerCommand","SELECTION_CHANGE_COMMAND","payload","activeElement","COMMAND_PRIORITY_HIGH","KEY_ESCAPE_COMMAND","EquationNode","key","__equation","__inline","this","getEquation","version","_config","createElement","prevNode","getWritable","__key","serializedNode","$createEquationNode","DecoratorNode","equationNode","getSelection","INSERT_IMAGE_COMMAND","createCommand","ImagesPlugin","hasNodes","ImageNode","Error","selection","$getSelection","$isRangeSelection","$isRootNode","anchor","getNode","insertParagraph","imageNode","$createImageNode","insertNodes","COMMAND_PRIORITY_EDITOR","DRAGSTART_COMMAND","getImageNodeInSelection","dataTransfer","setData","setDragImage","img","JSON","stringify","altText","__altText","caption","__caption","height","__height","getKey","maxWidth","__maxWidth","showCaption","__showCaption","src","__src","width","__width","onDragStart","DRAGOVER_COMMAND","canDropImage","onDragover","COMMAND_PRIORITY_LOW","DROP_COMMAND","dragData","getData","parse","getDragImageData","range","domSelection","caretRangeFromPoint","clientX","clientY","rangeParent","collapse","rangeOffset","getRangeAt","getDragSelection","remove","rangeSelection","$createRangeSelection","undefined","applyDOMRange","$setSelection","dispatchCommand","onDrop","$isNodeSelection","getNodes","$isImageNode","HTMLElement","closest","TableActionMenu","_tableCellNode","tableCellNode","setIsMenuOpen","contextRef","dropDownRef","updateTableCellNode","columns","rows","selectionCounts","updateSelectionCounts","registerMutationListener","TableCellNode","nodeMutations","get","getEditorState","read","getLatest","$isGridSelection","selectionShape","getShape","toX","fromX","toY","fromY","menuButtonElement","dropDownElement","menuButtonRect","getBoundingClientRect","style","opacity","left","pageXOffset","top","pageYOffset","handleClickOutside","clearTableSelection","isAttached","tableNode","$getTableNodeFromLexicalNodeOrThrow","tableElement","getElementByKey","tableSelection","getTableSelectionFromTableElement","clearHighlight","markDirty","insertTableRowAtSelection","shouldInsertAfter","tableRowIndex","$getTableRowIndexFromTableCellNode","grid","$getElementGridForTableNode","$insertTableRow","insertTableColumnAtSelection","tableColumnIndex","$getTableColumnIndexFromTableCellNode","$insertTableColumn","deleteTableRowAtSelection","$removeTableRowAtIndex","deleteTableAtSelection","deleteTableColumnAtSelection","$deleteTableColumn","toggleTableRowIsHeader","tableRows","getChildren","length","tableRow","$isTableRowNode","forEach","tableCell","$isTableCellNode","toggleHeaderStyle","TableCellHeaderStates","toggleTableColumnIsHeader","r","tableCells","stopPropagation","__headerState","TableCellActionMenuContainer","menuButtonRef","menuRootRef","isMenuOpen","setTableMenuCellNode","moveMenu","menu","nativeSelection","rootElement","getRootElement","anchorNode","tableCellNodeFromSelection","$getTableCellNodeFromLexicalNode","registerUpdateListener","menuButtonDOM","tableCellNodeDOM","tableCellRect","menuRect","prevTableCellDOM","TableActionMenuPlugin","TreeViewPlugin","TreeView","viewClassName","timeTravelPanelClassName","timeTravelButtonClassName","timeTravelPanelSliderClassName","timeTravelPanelButtonClassName","LexicalContentEditable","ContentEditable","clamp","min","max","Math","Direction","ImageResizer","onResizeStart","onResizeEnd","imageRef","setShowCaption","buttonRef","controlWrapperRef","userSelect","priority","positioningRef","currentHeight","currentWidth","direction","isResizing","ratio","startHeight","startWidth","startX","startY","editorRootElement","maxWidthContainer","maxHeightContainer","handlePointerDown","image","controlWrapper","positioning","cursorDir","setProperty","getPropertyValue","getPropertyPriority","setStartCursor","classList","add","handlePointerMove","handlePointerUp","isHorizontal","isVertical","diff","floor","onPointerDown","Placeholder","imageCache","Set","convertImageElement","domNode","HTMLImageElement","alt","LazyImage","Promise","resolve","Image","onload","useSuspenseImage","draggable","ImageComponent","resizable","useLexicalNodeSelection","isSelected","setSelected","clearSelection","setIsResizing","yjsDocMap","useCollaborationContext","setSelection","onDelete","editorState","CLICK_COMMAND","shiftKey","KEY_DELETE_COMMAND","KEY_BACKSPACE_COMMAND","isFocused","Suspense","fallback","LexicalNestedComposer","initialEditor","TablePlugin","LinkPlugin","HistoryPlugin","externalHistoryState","RichTextPlugin","initialEditorState","nextWidth","nextHeight","setWidthAndHeight","createEditor","setAttribute","getAltText","toJSON","getSrc","writable","config","span","theme","nestedEditor","parseEditorState","isEmpty","setEditorState","conversion","TABLE_ROW_REG_EXP","TABLE","export","exportChildren","$isTableNode","row","rowOutput","cell","$isElementNode","regExp","replace","parentNode","_1","match","matchCells","mapToTableCells","sibling","getPreviousSibling","maxCells","$isParagraphNode","getChildrenSize","firstChild","getFirstChild","$isTextNode","cells","getTextContent","unshift","previousSibling","table","$createTableNode","$createTableRowNode","createTableCell","getTableColumnsSize","selectEnd","$createTableCellNode","paragraph","$createParagraphNode","$createTextNode","trim","split","PLAYGROUND_TRANSFORMERS","$isHorizontalRuleNode","_2","isImport","line","$createHorizontalRuleNode","getNextSibling","insertBefore","exportFormat","importRegExp","textNode","trigger","CHECK_LIST","ELEMENT_TRANSFORMERS","TEXT_FORMAT_TRANSFORMERS","TEXT_MATCH_TRANSFORMERS","ActionsPlugin","isReadOnly","setIsReadOnly","setConnected","isEditorEmpty","setIsEditorEmpty","registerReadOnlyListener","readOnly","CONNECTED_COMMAND","$getRoot","paragraphChildren","root","$isCodeNode","getLanguage","$convertFromMarkdownString","markdown","$convertToMarkdownString","clear","$createCodeNode","importFile","exportFile","fileName","Date","toISOString","source","ShowClearDialog","setReadOnly","CLEAR_EDITOR_COMMAND","URL_MATCHER","EMAIL_MATCHER","MATCHERS","exec","fullMatch","index","startsWith","LexicalAutoLinkPlugin","AutoLinkPlugin","matchers","ClickableLinkPlugin","newTab","linkDomNode","isLinkDomNode","getLinkDomNode","getAttribute","isCollapsed","linkNode","maybeLinkNode","$getNearestNodeFromDOMNode","$isLinkNode","open","metaKey","ctrlKey","registerRootListener","prevRootElement","nodeName","toLowerCase","useDebounce","fn","ms","maxWait","funcRef","debounce","CopyButton","getCodeDOMNode","isCopyCompleted","setCopyCompleted","removeSuccessIcon","codeDOMNode","codeNode","navigator","clipboard","writeText","error","CodeActionMenuContainer","lang","setLang","isShown","setShown","shouldListenMouseMove","setShouldListenMouseMove","right","position","setPosition","codeSetRef","codeDOMNodeRef","debouncedOnMouseMove","isOutside","getMouseInfo","_lang","maybeCodeNode","y","innerWidth","cancel","CodeNode","mutations","codeFriendlyName","getLanguageFriendlyName","CodeActionMenuPlugin","CodeHighlightPlugin","registerCodeHighlighting","CAN_USE_DOM","documentMode","IS_APPLE","test","platform","userAgent","InputEvent","MSStream","YouTubeComponent","format","videoID","BlockWithAlignableContents","frameBorder","allow","allowFullScreen","YouTubeNode","id","__id","_editor","embedBlockTheme","embedBlock","base","__format","$createYouTubeNode","setFormat","DecoratorBlockNode","DropDownContext","DropDownItem","dropDownContext","registerItem","DropDownItems","items","setItems","highlightedItem","setHighlightedItem","itemRef","onKeyDown","includes","indexOf","DropDown","buttonLabel","buttonAriaLabel","buttonClassName","buttonIconClassName","stopCloseOnClickSelf","showDropDown","setShowDropDown","button","dropDown","offsetWidth","handle","TextInput","label","basicColors","WIDTH","ColorPicker","rest","transformColor","selfColor","setSelfColor","inputColor","setInputColor","innerDivRef","saturationPosition","x","hsv","s","v","huePosition","h","hex","newColor","basicColor","backgroundColor","MoveWrapper","divRef","move","onMouseDown","onMouseMove","_e","onMouseUp","toHex","ctx","getContext","fillStyle","hex2rgb","rbgArr","m","g","b","substring","parseInt","rgb2hsv","d","rgb2hex","padStart","rgb","f","p","q","t","round","hsv2rgb","FileInput","accept","files","KatexEquationAlterer","onConfirm","initialEquation","setInline","onCheckboxChange","checked","PREVIEW_CACHE","LinkPreviewContent","cached","preview","fetch","encodeURI","response","json","useSuspenseRequest","domain","description","Glimmer","animationDelay","LinkPreview","INSERT_EQUATION_COMMAND","EquationsPlugin","INSERT_YOUTUBE_COMMAND","YouTubePlugin","youTubeNode","$insertBlockNode","blockTypeToBlockName","bullet","check","code","h1","h2","h3","h4","h5","h6","number","quote","CODE_LANGUAGE_OPTIONS","Object","entries","CODE_LANGUAGE_FRIENDLY_NAME_MAP","friendlyName","getCodeLanguageOptions","FONT_SIZE_OPTIONS","getSelectedNode","focusNode","isBackward","$isAtNodeEnd","positionEditorElement","rect","rootElementRect","FloatingLinkEditor","editorRef","linkUrl","setLinkUrl","isEditMode","setEditMode","lastSelection","setLastSelection","updateLinkEditor","parent","getParent","getURL","editorElem","domRange","inner","firstElementChild","onResize","TOGGLE_LINK_COMMAND","rel","InsertImageUriDialogBody","setSrc","setAltText","isDisabled","InsertImageUploadedDialogBody","reader","FileReader","result","readAsDataURL","InsertImageDialog","activeEditor","mode","setMode","yellowFlowerImage","InsertTableDialog","setRows","setColumns","INSERT_TABLE_COMMAND","YOUTUBE_ID_PARSER","parseYouTubeVideoID","urlMatches","InsertYouTubeDialog","setText","InsertEquationDialog","onEquationConfirm","dropDownActiveClass","active","BlockFormatDropDown","blockType","formatHeading","headingSize","$wrapLeafNodesInElements","$createHeadingNode","INSERT_UNORDERED_LIST_COMMAND","REMOVE_LIST_COMMAND","INSERT_ORDERED_LIST_COMMAND","INSERT_CHECK_LIST_COMMAND","$createQuoteNode","$isYouTubeNode","getId","insertRawText","Divider","FontDropDown","handleClick","option","$patchStyleText","FONT_FAMILY_OPTIONS","ToolbarPlugin","setActiveEditor","setBlockType","selectedElementKey","setSelectedElementKey","fontSize","setFontSize","fontColor","setFontColor","bgColor","setBgColor","setFontFamily","isLink","setIsLink","isBold","setIsBold","isItalic","setIsItalic","isUnderline","setIsUnderline","isStrikethrough","setIsStrikethrough","isSubscript","setIsSubscript","isSuperscript","setIsSuperscript","isCode","setIsCode","canUndo","setCanUndo","canRedo","setCanRedo","isRTL","setIsRTL","codeLanguage","setCodeLanguage","updateToolbar","getTopLevelElementOrThrow","elementKey","elementDOM","hasFormat","$isParentElementRTL","$isListNode","parentList","$getNearestNodeOfType","ListNode","getListType","$isHeadingNode","getTag","getType","language","CODE_LANGUAGE_MAP","$getSelectionStyleValueForProperty","_payload","newEditor","COMMAND_PRIORITY_CRITICAL","CAN_UNDO_COMMAND","CAN_REDO_COMMAND","applyStyleText","styles","clearFormatting","$selectAll","setStyle","$getNearestBlockElementAncestorOrThrow","$isDecoratorBlockNode","onFontColorSelect","onBgColorSelect","insertLink","onCodeLanguageSelect","setLanguage","UNDO_COMMAND","REDO_COMMAND","FORMAT_TEXT_COMMAND","INSERT_HORIZONTAL_RULE_COMMAND","catTypingGif","FORMAT_ELEMENT_COMMAND","OUTDENT_CONTENT_COMMAND","INDENT_CONTENT_COMMAND","ComponentPickerOption","icon","keywords","keyboardShortcut","onSelect","bind","TypeaheadOption","ComponentPickerMenuItem","onMouseEnter","setRefElement","ComponentPickerMenuPlugin","queryString","setQueryString","checkForTriggerMatch","useBasicTypeaheadTriggerMatch","minLength","getDynamicOptions","fullTableRegex","RegExp","partialTableRegex","fullTableMatch","partialTableMatch","n","Array","from","_","baseOptions","alignment","dynamicOptions","queryRegex","some","keyword","lastIndex","onSelectOption","selectedOption","nodeToRemove","closeMenu","matchingString","LexicalTypeaheadMenuPlugin","onQueryChange","triggerFn","menuRenderFn","anchorElement","selectedIndex","selectOptionAndCleanUp","setHighlightedIndex","ReactDOM","HorizontalRulePlugin","horizontalRuleNode","isIndentPermitted","maxDepth","elementNodesInSelection","nodesInSelection","getParentOrThrow","getElementNodesInSelection","totalDepth","elementNode","$getListDepth","$isListItemNode","ListMaxIndentLevelPlugin","MarkdownPlugin","MarkdownShortcutPlugin","transformers","lastTabKeyDownTimestamp","hasRegisteredKeyDownListener","TabFocusPlugin","timeStamp","FOCUS_COMMAND","clone","TableCellResizer","targetRef","resizerRef","tableRectRef","mouseStartPosRef","mouseCurrentPos","updateMouseCurrentPos","activeCell","updateActiveCell","isSelectingGrid","updateIsSelectingGrid","draggingDirection","updateDraggingDirection","isGridSelection","resetState","getCellFromTarget","elem","isHeightChanging","updateRowHeight","newHeight","setHeight","updateColumnWidth","newWidth","setWidth","toggleResize","heightChange","abs","isShrinking","widthChange","resizerStyles","bottom","cursor","tableRect","getResizers","TableCellResizerPlugin","useLayoutEffect","characterLimit","codeHighlight","atrule","attr","boolean","builtin","cdata","char","class","comment","constant","deleted","doctype","entity","function","important","inserted","namespace","operator","prolog","property","punctuation","regex","selector","string","symbol","variable","hashtag","heading","link","list","listitem","listitemChecked","listitemUnchecked","nested","olDepth","ul","ltr","mark","markOverlap","rtl","tableCellHeader","bold","italic","strikethrough","subscript","superscript","underline","underlineStrikethrough","INSERT_INLINE_COMMAND","baseTheme","TextFormatFloatingToolbar","popupCharStylesEditorRef","updateTextFormatFloatingToolbar","popupCharStylesEditorElem","setPopupPosition","useTextFormatFloatingToolbar","isText","setIsText","updatePopup","isComposing","$isCodeHighlightNode","TextFormatFloatingToolbarPlugin","require","jsonString","CLEAR_HISTORY_COMMAND","serializeToHTML","renderNode","k","headingNode","listNode","getFormat","getStyle","html","renderText","paragraphNode","renderStyle","child","ch","j","single","Editor","scrollRef","execute","raw","documentJSON","alert","ClearEditorPlugin","AutoScrollPlugin","ListPlugin","CheckListPlugin","TypeaheadNode","dom","cssText","__text","$createTypeaheadNode","setDetail","detail","TextNode","HeadingNode","ListItemNode","QuoteNode","TableNode","TableRowNode","CodeHighlightNode","AutoLinkNode","LinkNode","OverflowNode","HorizontalRuleNode","prepopulatedRichText","App","initialConfig","nodes","PlaygroundNodes","onError","PlaygroundEditorTheme","LexicalComposer","TextEditor","warn","Index","getFiles","Mcq","currentPage","setCurrentPage","setMessage","selectedFile","setSelectedFile","setFiles","filesList","pagesVisited","pageCount","ceil","displayFiles","slice","file","fileURL","formData","FormData","upload","Paginate","previousLabel","nextLabel","onPageChange","selected","containerClassName","previousLinkClassName","nextLinkClassName","activeClassName","pageClassName","disabledClassName","activePage","setActivePage","user","email","phone","Sidenav","SidenavHeader","SidenavMenu","SidenavFooter","to","useLocation","loc","pathname","Helmet","path","InvalidPage"],"sourceRoot":""}